<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<title></title>
	<meta name="generator" content="LibreOffice 6.0.7.3 (Linux)"/>
	<meta name="created" content="00:00:00"/>
	<meta name="changed" content="2019-03-05T21:16:32.607742738"/>
	<style type="text/css">
		@page { margin: 0.79in }
		p { margin-bottom: 0.08in }
		p.list-western { page-break-before: auto }
		p.list-cjk { page-break-before: auto }
		p.list-ctl { font-family: "Tahoma"; page-break-before: auto }
		pre { text-align: left }
		pre.western { font-family: "DejaVu Sans", sans-serif; font-size: 12pt }
		pre.cjk { font-family: "Courier New", monospace; font-size: 12pt }
		pre.ctl { font-family: "Courier New", monospace; font-size: 26pt }
		td p { margin-bottom: 0in }
		h3 { margin-top: 0.17in }
		h3.western { font-family: "Arial", sans-serif }
		h3.cjk { font-family: "MS Mincho" }
		h3.ctl { font-family: "Tahoma" }
		h1 { margin-bottom: 0.08in }
		h1.western { font-family: "Arial", sans-serif; font-size: 16pt }
		h1.cjk { font-family: "MS Mincho"; font-size: 16pt }
		h1.ctl { font-family: "Tahoma"; font-size: 16pt }
		h5 { margin-top: 0.17in; margin-bottom: 0.08in }
		h5.western { font-family: "Arial", sans-serif; font-size: 11pt }
		h5.cjk { font-family: "MS Mincho"; font-size: 11pt }
		h5.ctl { font-family: "Tahoma"; font-size: 11pt }
		h2 { margin-top: 0.17in }
		h2.western { font-family: "Arial", sans-serif; font-size: 14pt; font-style: italic }
		h2.cjk { font-family: "MS Mincho"; font-size: 14pt; font-style: italic }
		h2.ctl { font-family: "Tahoma"; font-size: 14pt; font-style: italic }
		pre.code2-western { font-family: "DejaVu Sans", sans-serif; font-size: 12pt }
		pre.code2-cjk { font-family: "Courier New", monospace; font-size: 12pt }
		pre.code2-ctl { font-family: "Courier New", monospace; font-size: 26pt }
		a:link { so-language: zxx }
		a.sdfootnoteanc { font-size: 57% }
	</style>
</head>
<body lang="en-US" dir="ltr" style="border-top: 1.00pt solid #000000; border-bottom: none; border-left: none; border-right: none; padding: 0in">
<div title="header">
	<p style="margin-bottom: 0.2in"><br/>

	</p>
</div>
<pre class="western">






<font face="DejaVu Sans, sans-serif"><font size="6" style="font-size: 26pt"><b>A Beginner’s Guide to FreeBasic</b> </font></font>





</pre><p style="page-break-before: always">
<br/>
<br/>

</p>
<p> <font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt">Copyright
(c) Ebben Feagan and Richard Clark.</font></font></p>
<p> Permission is granted to copy, distribute and/or modify this
document  under the terms of the GNU Free Documentation License,
Version 1.2 or any later version published by the Free Software
Foundation; with no Invariant Sections, no Front-Cover Texts, and no
Back-Cover Texts. A copy of the license is included in the section
entitled &quot;GNU Free Documentation License&quot;. 
</p>
<p><br/>
<br/>

</p>
<p>The source code was compiled under version .17b of the FreeBasic
compiler and tested under Windows 2000 Professional and Ubuntu Linux
6.06. Later compiler versions may require changes to the source code
to compile successfully and results may differ under different
operating systems. All source code is released under version 2 of the
Gnu Public License (HTTP://www.gnu.org/copyleft/gpl.html). The source
code is provided AS IS,WITHOUT ANY WARRANTY; without even the implied
warranty of MERCHANTABILITY or Fitness FOR A PARTICULAR PURPOSE. 
</p>
<p><br/>
<br/>

</p>
<p>Microsoft Windows®, Visual Basic® and QuickBasic® are
registered trademarks and are copyright © Microsoft Corporation.
Ubuntu is a registered trademark of Canonical Limited. 
</p>
<p><br/>
<br/>

</p>
<p><br/>
<br/>

</p>
<pre class="western" style="page-break-before: always">
<font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt">To all the members of the FreeBasic community, especially the developers. </font></font>



</pre><h3 class="western">
<font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt"><b>Acknowledgments</b>
</font></font>
</h3>
<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt">Writing a book is difficult business, especially a book on programming. It is impossible to know how to do everything in a particular language, and everyone learns something from the programming community. I have learned a multitude of things from the FreeBasic community and I want to send my thanks to all of those who have taken the time to post answers and examples to questions. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt">I would also like to say a big thanks to the developers of FreeBasic. Without your continual hard work in development, we wouldn’t have what I consider the premier OpenSource BASIC language for today. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt">The PDF version of this book was created Using Open Office 2.0.2,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt">HTTP://www.openoffice.org/. </font></font>


</pre>
<div id="About the Book" dir="ltr" href="../fbeginnerm1.odt">
	<h1 class="western"><font face="Arial, sans-serif"><font size="3" style="font-size: 12pt">About
	the Book </font></font>
	</h1>
	<pre class="western">
<font face="Arial, sans-serif"><font size="3" style="font-size: 12pt">FBeginner is a concise, hands-on beginner’s guide to FreeBasic and is aimed at the novice programmer. The book assumes no prior programming knowledge. The goal of the book is to create a solid foundation in the basics of programming in FreeBasic that the programmer can build and expand upon. </font></font>

<font face="Arial, sans-serif"><font size="3" style="font-size: 12pt">FreeBasic is a cross-platform compiler, however this book concentrates on using FreeBasic under the 32-bit Microsoft Windows™ and GNU/Linux operating systems.</font></font>
<font face="Arial, sans-serif"><font size="3" style="font-size: 12pt">However, other than the installation and setup portions of this book, most of the code should run under any of the supported platforms. </font></font>

<font face="Arial, sans-serif"><font size="3" style="font-size: 12pt">All of the source code presented in this book is original code, and can be downloaded from the Clark Productions website located at HTTP://rdc.ascii-world.com/ or http://freebasic.hmcsoft.org/. </font></font>







<font face="Arial, sans-serif"><font size="3" style="font-size: 12pt">Note: </font></font>
<font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt"><font face="Arial, sans-serif">- the website </font><font face="Arial, sans-serif"><a href="http://ascii-world.wikidot.com/">http://rdc.ascii-world.com/</a> no longer works</font></font></font>
<font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt"><font face="Arial, sans-serif">- the website </font><font face="Arial, sans-serif"><a href="http://ascii-world.wikidot.com/">http://ascii-world.wikidot.com/</a> <a href="http://ascii-world.wikidot.com/">h</a>owever has an interview with Richard D Clark (aka the author) at http://ascii-world.wikidot.com/interview-with-richard-d-clark</font></font></font>
<font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt"><font face="Arial, sans-serif">- <a href="http://freebasic.hmcsoft.org/">http://freebasic.hmcsoft.org/</a> </font><font face="Arial, sans-serif">no longer works &amp; only shows a “sorry” message.</font></font></font>
<font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt"><font face="Arial, sans-serif">- </font><font face="Arial, sans-serif">Clark Productions host some material on <a href="http://users.freebasic-portal.de/rdc/index.html">http://users.freebasic-portal.de/rdc/index.html</a></font></font></font>

</pre>
</div>
<div id="Conventions Used in the Book *" dir="ltr" href="../fbeginnerm2.odt">
	<h1 class="western" style="page-break-before: always">Conventions
	Used in the Book 
	</h1>
	<pre class="western">The various styles used in the book along with their meaning, are listed below. The basic paragraph format is the font you see here with each paragraph indented. 

Information that is supplemental to the topic being discussed will be presented in the format below. 
</pre><p style="margin-bottom: 0in; border: 1.00pt solid #000000; padding: 0.02in; background: #c0c0c0">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">These
	colored boxes have additional, supplemental or historical
	information associated with the current topic being discussed. </font></font>
	</p>
	<pre class="western">
<font face="Arial, sans-serif"><font size="3" style="font-size: 12pt">Source code is listed in a fixed font with borders to delimit the code segment. You should always type in the programs. Most are small and can be entered into the editor in just a couple of minutes. The physical act of typing in the programs will help you learn the vocabulary and structure of FreeBasic. You do not type in the line numbers; they are only for referencing the code in the text. The file name for the program is located after the code segment. </font></font>
</pre>
	<table width="100%" cellpadding="0" cellspacing="0" style="page-break-after: avoid">
		<col width="256*">
		<tr>
			<td width="100%" valign="top" style="border: none; padding: 0in">
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">Cls </font>
				</p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">Print &quot;Hello World From
				FreeBasic!&quot; </font>
				</p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">Sleep </font>
				</p>
				<p style="border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">End </font>
				</p>
			</td>
		</tr>
	</table>
	<p style="margin-top: 0.08in"><font size="3" style="font-size: 12pt"><i>Listing
	1:  helloworld.bas </i></font>
	</p>
	<p style="margin-top: 0.08in"><br/>
<br/>

	</p>
	<pre class="western"><font face="Arial, sans-serif"><font size="3" style="font-size: 12pt">Following each listing is an analysis paragraph which explains how the program works It is marked by the word Analysis: in bold with a fixed font. Even though many of the keywords you will see may have not be discussed in detail in the text, seeing these keywords in action will help you become familiar with the vocabulary of FreeBasic. </font></font>
</pre><p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in">
	<font face="Arial, sans-serif"><font size="3" style="font-size: 12pt">	<b>Analysis:
	</b>This will mark the beginning of an analysis section. The code
	will be discussed in this section.  Since there will be no line
	numbers you will need to read the code carefully.</font></font></p>
	<pre class="western">
<font face="Arial, sans-serif"><font size="3" style="font-size: 12pt">The output of a program is listed in a fixed font and enclosed in a gray box as shown below. This output is given so you can compare the results to see if you have entered the program correctly. </font></font>
</pre>
	<table width="100%" cellpadding="4" cellspacing="0" style="page-break-after: avoid">
		<col width="256*">
		<tr>
			<td width="100%" valign="top" style="border: none; padding: 0in">
				<p style="border: none; padding: 0in; background: #c0c0c0"><font face="Courier New, monospace">Hello
				World from FreeBasic!</font></p>
			</td>
		</tr>
	</table>
	<p style="margin-top: 0.08in"><font size="3" style="font-size: 12pt"><i>Output
	1.1: HelloWorld.bas</i></font></p>
	<pre class="western"><font face="Arial, sans-serif"><font size="3" style="font-size: 12pt">A potential problem is shown with a Caution paragraph. It is formatted similarly to the Analysis paragraph. </font></font>
</pre><p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in; background: #c0c0c0">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Caution:
	This style will alert you to potential problems and offer some
	remedies or tips to avoid them. </font></font>
	</p>
	<pre class="western" style="page-break-before: always">
<font face="Arial, sans-serif"><font size="3" style="font-size: 12pt">If we look at the fact, we shall find that the great inventions of the age are not, with us at least, always produced in universities. </font></font>

<font face="Arial, sans-serif"><font size="3" style="font-size: 12pt">Charles Babbage </font></font>

</pre>
</div>
<div id="Table of Contents*" dir="ltr" href="../fbeginnerm3.odt">
	<h1 class="western"></h1>
	<div id="Table of Contents1" dir="ltr">
		<div id="Table of Contents1_Head" dir="ltr">
			<p style="margin-top: 0.17in; page-break-before: always; page-break-after: avoid">
			<font face="Arial, sans-serif"><font size="4" style="font-size: 16pt"><b>Table
			of Contents</b></font></font></p>
		</div>
		<p style="margin-left: 0.39in; margin-bottom: 0in">Acknowledgments
			4</p>
		<p style="margin-bottom: 0in">About the Book 	5</p>
		<p style="margin-bottom: 0in">Conventions Used in the Book 	6</p>
		<p style="margin-bottom: 0in">Chapter 1 A Brief Introduction to
		FreeBASIC 	11</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Differences from
		QuickBASIC 	11</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Key Features of
		FreeBASIC 	11</p>
		<p style="margin-bottom: 0in">Chapter 2 Numeric Data Types 	14</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Signed Versus
		Unsigned Data Types 	14</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">The Floating
		Point Data Type 	15</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Pointer Data
		Types 	15</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Numeric Variables
			15</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">The Dim Statement
			16</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Shared Variables
			16</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Static Variables
			17</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Common Variables
			18</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Extern and Import
		Variables 	18</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Data Type
		Suffixes 	18</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Changing The
		Default Data Type 	19</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Using Different
		Number Formats 	20</p>
		<p style="margin-left: 0.39in; margin-bottom: 0in">Hexadecimal
		Numbers 	20</p>
		<p style="margin-left: 0.39in; margin-bottom: 0in">Binary Numbers
			20</p>
		<p style="margin-left: 0.39in; margin-bottom: 0in">Octal Numbers
			20</p>
		<p style="margin-left: 0.39in; margin-bottom: 0in">Exponential
		Numbers 	21</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Which Data Type
		To Use? 	21</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Option Explicit
			21</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">A Note about
		Option Explicit 	23</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">A Look Ahead 	23</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Excercises 	24</p>
		<p style="margin-bottom: 0in">Chapter 3 Converting Numeric Data
		Types 	25</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Implicit Data
		Conversion 	25</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Explicit Data
		Conversion 	28</p>
		<p style="margin-left: 0.39in; margin-bottom: 0in">Numeric Data
		Conversion Functions 	28</p>
		<p style="margin-left: 0.39in; margin-bottom: 0in">Using Conversion
		Functions in Macros 	31</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">A Look Ahead 	36</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Exercises 	36</p>
		<p style="margin-bottom: 0in">Chapter 4 Introduction to the C
		Runtime Library 	37</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">The #Include
		Directive 	37</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">The Declaration
		Statement 	39</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Runtime
		Conversion Functions 	41</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">The AddressOf
		Operator @ 	41</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Testing the
		Runtime Conversion Functions 	44</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">A Look Ahead 	46</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Exercises 	46</p>
		<p style="margin-bottom: 0in">Chapter 5 Arithmetic Operators 	47</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Arithmetic
		Operators 	47</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Shortcut
		Arithmetic Operators 	52</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Binary Number
		System 	52</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">The Sign Bit 	53</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">A Look Ahead 	55</p>
		<p style="margin-bottom: 0in">Chapter 6 Bitwise Operators 	56</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">The AND Operator
			58</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">The OR Operator
			60</p>
		<p style="margin-bottom: 0in">Chapter 7 Mathematical Functions 	71</p>
		<p style="margin-bottom: 0in">Chapter 8 Pointer Data Type 	82</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Pointers and
		Memory 	82</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Typed and Untyped
		Pointers 	84</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Pointer Operators
			85</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Memory Functions
			85</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Pointer
		Arithmetic and Pointer Indexing 	87</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Pointer Functions
			90</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Subroutine and
		Function Pointers 	91</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Creating a
		Callback Function 	92</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Pointer to
		Pointer 	98</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">A Look Ahead 	101</p>
		<p style="margin-bottom: 0in">Chapter 9 String Data Types 	102</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Dynamic Strings
			103</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Fixed Length
		Strings 	105</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Zstrings 	106</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Wstrings 	110</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">String Functions
			110</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Len Versus Sizeof
			112</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Using String
		Functions with Zstring Pointers 	114</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">The MK* and CV*
		String Functions 	116</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Numeric String
		Conversion Functions 	120</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">Wide String
		Functions 	121</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">String Operators
			122</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">CRT Character and
		String Functions 	122</p>
		<p style="margin-left: 0.39in; margin-bottom: 0in">Character
		Functions 	122</p>
		<p style="margin-left: 0.39in; margin-bottom: 0in">Strtok Function
			127</p>
		<p style="margin-left: 0.2in; margin-bottom: 0in">A Look Ahead 	130</p>
		<p style="margin-bottom: 0in">Chapter 10 Composite Data Types 	131</p>
		<p style="margin-bottom: 0in">Chapter 11 Symbolic Constants 	172</p>
		<p style="margin-bottom: 0in">Chapter 12 Arrays 	176</p>
		<p style="margin-bottom: 0in">Chapter 13 Date and Time Functions
			208</p>
		<p style="margin-bottom: 0in">Chapter 14 The Format Function 	229</p>
		<p style="margin-bottom: 0in">Chapter 15 Console Programming 	236</p>
		<p style="margin-bottom: 0in">Chapter 16 Control Structures 	259</p>
		<p style="margin-bottom: 0in">Appendix A: GNU Free Documentation
		License	274</p>
	</div>
</div>
<div id="A Brief Introduction to FreeBASIC *" dir="ltr" href="../fbeginnerm4.odt">
	<h1 class="western" style="page-break-before: always">Chapter 1 A
	Brief Introduction to FreeBASIC 
	</h1>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt">FreeBASIC is a 32/64-bit BASIC compiler that outputs native code for Microsoft Windows, Linux and a 32-bit BASIC compiler for DOS via DJGPP. FreeBASIC is also Open Source, which means anyone may freely view and edit the source to suit their needs. </font></font></pre><h2 class="western">
	Key Features of FreeBASIC 
	</h2>
	<ul>
		<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt"><b>Built-in Graphics library</b> </font></font></pre>
	</ul>
	<ul>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt">Completely compatible with old QB Graphics commands, but it builds on this to offer much more. </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt">Support for high resolutions and any color depth, and any number of off screen pages. </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt">All drawing functions can operate on screen as well as on off screen surfaces(GET/PUT buffers) of any size. </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt">Advanced sprites handling, with clipping, transparency, alpha and custom blending. </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt">Direct access to screen memory. </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt">BMP loading/saving capabilities. </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt">OpenGL support: init an OpenGL mode with a single command, then use GL instructions directly. </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt">Keyboard, mouse and joystick handling functions. </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt">The Graphics library is fast: MMX optimized routines are used if MMX is available. </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt">Small footprint: when using Graphics commands, your EXEs will grow in size by a minimum of 30/40K only. </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt">Stand-aloness: generated EXEs will depend only upon system libs, no external libraries required. </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt">As all of FB, also gfxlib is completely multi platform: underneath it uses DirectX or GDI (if DX is not available) under Win32, direct VGA/ModeX/VESA access under DOS, or raw Xlib under Linux. </font></font></pre>
	</ul>
	<ul>
		<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt"><b>Create OBJ's, LIB's, DLL's, and console or GUI EXE's </b></font></font></pre>
	</ul>
	<ul>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt">You are in no way locked to an IDE or editor of any kind. </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt">You can create static and dynamic libraries adding just one command-line option (-lib or -dll). </font></font></pre>
	</ul>
	<ul>
		<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt"><b>Debugging support</b> </font></font></pre>
	</ul>
	<ul>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt">Full debugging support with GDB (the GNU debugger) or Insight (the GDB GUI front end) </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt">Array bounds checking (only enabled by the -exx command-line option) </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt">Null pointers checking (same as above) </font></font></pre>
	</ul>
	<ul>
		<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt"><b>Function overloading</b> </font></font></pre>
	</ul>
	<ul>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt">DECLARE SUB Test OVERLOAD (a AS DOUBLE) </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt">DECLARE SUB Test (a AS SINGLE) </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt">DECLARE SUB Test (a AS INTEGER, b AS INTEGER = 1234) </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt">DECLARE SUB Test (a AS BYTE, b AS SHORT) </font></font></pre>
	</ul>
	<ul>
		<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt"><b>Inline Assembly</b> </font></font></pre>
	</ul>
	<ul>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Intel syntax. </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Reference variables directly by name with no &quot;trick code&quot; needed. </font></font></pre>
	</ul>
	<ul>
		<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt"><b>Most of the known C libraries can be used directly, without wrappers</b> </font></font></pre>
	</ul>
	<ul>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">GTK+ 2.0: cross-platform GUI Toolkit (over 1MB of headers, including support for Glade, libart and glGtk) </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">libxml and libxslt: defacto standard XML and XSL libraries </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">GSL - GNU Scientific library: complex numbers, vectors and matrices, FFT linear algebra, statistics, sorting, differential equations, and a dozen other sub-libraries with mathematical routines </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">GMP - GNU Multiple Precision Arithmetic Library: known as the fastest bignum library </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">SDL - Simple Direct Media Layer: multimedia library for audio, user input, 3Dand 2D gfx (including the sub-libraries such as SDL_Net, SDL_TTF, etc) </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">OpenGL: portable library for developing interactive 2D and 3D graphics games and applications (including support for frameworks such as GLUT and GLFW) </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Allegro: game programming library (graphics, sounds, player input, etc) </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">GD, DevIL, FreeImage, GRX and other graphic-related libraries </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">OpenAL, Fmod, BASS: 2D and 3D sound systems, including support for mod,</font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">mp3, ogg, etc </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ODE and Newton - dynamics engines: libraries for simulating rigid body dynamics </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">cgi-util and Fast CGI: web development </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">DirectX and the Windows API - the most complete headers set between the Basic compilers available, including support for the Unicode functions </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">DispHelper - COM IDispatch interfaces made easy </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">And many more! </font></font></pre>
	</ul>
	<ul>
		<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt"><b>Support for numeric (integer or floating-point) and strings types </b></font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">DECLARE SUB Test(a AS DOUBLE = 12.345, BYVAL b AS BYTE = 255, BYVAL sAS STRING = &quot;abc&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt"><b>Unicode support</b> </font></font></pre>
	</ul>
	<ul>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Besides ASCII files with Unicode escape sequences (\u), FreeBASIC can parse UTF-8, UTF-16LE, UTF-16BE, UTF-32LE and UTF-32BE source (.bas) or header(.bi) files, they can freely mixed with other sources/headers in the same project (also with other ASCII files). </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Literal strings can be typed in the original non-latin alphabet, just use an text-editor that supports some of the Unicode formats listed above. </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The WSTRING type holds wide-characters, all string functions (like LEFT,TRIM, etc) will work with wide-strings too. </font></font></pre>
	</ul>
	<ul>
		<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt"><b>Unlimited number of symbols</b> </font></font></pre>
	</ul>
	<ul>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Being a 32/64-bit application, FreeBASIC can compile source code files up to 2GB or loarger. </font></font></pre>
		<li/>
<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The number of symbols (variables, constants, et cetera) is only limited by the total memory available during compile time. You can, for example, include OpenGL, SDL, BASS, and GTK simultaneously in your source code. </font></font></pre>
	</ul>
	<ul>
		<pre class="western"></pre>
	</ul>
</div>
<div id="Numeric Data Types*" dir="ltr" href="../fbeginnerm5.odt">
	<h1 class="western" align="left" style="page-break-before: always">Chapter
	2 Numeric Data Types 
	</h1>
	<pre class="western" style="text-align: left">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When starting out with a new programming language, one of the first things you should learn is the language’s data types. Virtually every program manipulates data, and to correctly manipulate that data you must thoroughly understand the available data types Data type errors rank second to syntax errors but they are a lot more troublesome. The compiler can catch syntax errors and some data type errors, but most data type errors occur when the program is running, and often only when using certain types of data These kind of intermittent errors are difficult to find and difficult to fix. Knowing the kind, size and limits of the data types will help keep these kinds of errors to a minimum. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="3" style="font-size: 12pt"><font size="2" style="font-size: 11pt">FreeBasic has all the standard numeric data types that you would expect for a Basic compiler, as well as pointers which you usually only find in lower-level languages such as C. Table 3.1 lists all the numeric data types that FreeBasic supports. In the list below, you will notice that Integer and Long are grouped together. This is because a Long is just an alias for Integer. They are exactly the same data type.</font> </font></font>
</pre>
	<table width="665" cellpadding="4" cellspacing="0" style="page-break-after: avoid">
		<col width="213">
		<col width="204">
		<col width="222">
		<tr valign="top">
			<td width="213" bgcolor="#c0c0c0" style="background: #c0c0c0" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Numeric Data </font></font></pre>
			</td>
			<td width="204" bgcolor="#c0c0c0" style="background: #c0c0c0" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Types Size</font></font></pre>
			</td>
			<td width="222" bgcolor="#c0c0c0" style="background: #c0c0c0" style="border: 1px solid #000000; padding: 0.04in">
				<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Limits </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="213" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font size="2" style="font-size: 11pt">Byte </font></pre>
			</td>
			<td width="204" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font size="2" style="font-size: 11pt">8-bit, signed, 1 byte</font></pre>
			</td>
			<td width="222" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"><font size="2" style="font-size: 11pt">-128 to 127</font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="213" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font size="2" style="font-size: 11pt">Double </font>
</pre>
			</td>
			<td width="204" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font size="2" style="font-size: 11pt">64-bit, floating point, 8 bytes </font></pre>
			</td>
			<td width="222" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"><font size="2" style="font-size: 11pt">-2.2E-308 to +1.7E+308 </font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="213" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font size="2" style="font-size: 11pt">Integer  </font></pre>
			</td>
			<td width="204" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font size="2" style="font-size: 11pt">(Long) 32-bit, signed, 4 bytes</font></pre>
			</td>
			<td width="222" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"><font size="2" style="font-size: 11pt">-2,147,483,648 to </font>
<font size="2" style="font-size: 11pt">2,147,483,647 </font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="213" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font size="2" style="font-size: 11pt">LongInt</font></pre>
			</td>
			<td width="204" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"> <font size="2" style="font-size: 11pt">64-bit, signed, 8 bytes </font></pre>
			</td>
			<td width="222" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"><font size="2" style="font-size: 11pt">-9,223,372,036,854,775,808</font>
<font size="2" style="font-size: 11pt">to </font>
<font size="2" style="font-size: 11pt">9,223,372,036,854,775,807 </font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="213" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font size="2" style="font-size: 11pt">Short </font></pre>
			</td>
			<td width="204" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font size="2" style="font-size: 11pt">16-bit, signed, 2 bytes </font></pre>
			</td>
			<td width="222" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"><font size="2" style="font-size: 11pt">-32,768 to 32,767 </font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="213" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font size="2" style="font-size: 11pt">Single </font></pre>
			</td>
			<td width="204" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font size="2" style="font-size: 11pt">32-bit, floating point, 4 bytes </font></pre>
			</td>
			<td width="222" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"><font size="2" style="font-size: 11pt">1.1 E-38 to 3.43 E+38 </font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="213" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font size="2" style="font-size: 11pt">UByte  </font></pre>
			</td>
			<td width="204" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font size="2" style="font-size: 11pt">8-bit, unsigned, 1 byte</font></pre>
			</td>
			<td width="222" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"><font size="2" style="font-size: 11pt">0 to 255 </font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="213" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font size="2" style="font-size: 11pt">UInteger </font></pre>
			</td>
			<td width="204" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font size="2" style="font-size: 11pt">32-bit, unsigned, 4 bytes </font></pre>
			</td>
			<td width="222" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"><font size="2" style="font-size: 11pt">0 to 4,294,967,295</font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="213" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font size="2" style="font-size: 11pt">ULongInt </font></pre>
			</td>
			<td width="204" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font size="2" style="font-size: 11pt">64-bit, unsigned, 8 bytes </font></pre>
			</td>
			<td width="222" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"><font size="2" style="font-size: 11pt">0 to 18,446,744,073,709,551,61 5 </font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="213" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font size="2" style="font-size: 11pt">Ushort </font></pre>
			</td>
			<td width="204" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font size="2" style="font-size: 11pt">16-bit, unsigned, 2 bytes</font></pre>
			</td>
			<td width="222" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"><font size="2" style="font-size: 11pt">0 to 65365 </font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="213" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font size="2" style="font-size: 11pt">Pointer </font></pre>
			</td>
			<td width="204" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font size="2" style="font-size: 11pt">32-bit, memory address, 4 bytes </font></pre>
			</td>
			<td width="222" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"><font size="2" style="font-size: 11pt">Must be initialized at run time</font></pre>
			</td>
		</tr>
	</table>
	<p align="left" style="margin-top: 0.08in"><font size="3" style="font-size: 12pt"><i>Table
	2.2: FreeBasic Numeric Data Types </i></font>
	</p>
	<pre class="western" style="text-align: left"></pre><h2 class="western" align="left">
	Signed Versus Unsigned Data Types 
	</h2>
	<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Signed data types, as the name implies, can be negative, zero or positive.  Unsigned types can only be zero or positive, which give them a greater positive range <font size="3" style="font-size: 12pt">than their </font>signed counterparts. If your data will never be negative, using the unsigned data types will allow you to store larger numbers in the same size variable. </font></font>
</pre><h2 class="western" align="left">
	The Floating Point Data Type 
	</h2>
	<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The floating point data types, Single and Double are able to store numbers with decimal digits. Keep in mind that floating-point numbers are subject to rounding errors, which can accumulate over long calculations. You should carry more than the number of decimal digits than you need to ensure the greatest accuracy. </font></font></pre><h2 class="western" align="left">
	Pointer Data Types 
	</h2>
	<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Pointer data types are unlike the other data types in that they store a memory address and not data. Since pointers are handled differently than regular data types, a separate chapter has been devoted to the subject and will not be examined in this chapter </font></font></pre><h2 class="western" align="left">
	Numeric Variables 
	</h2>
	<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The numeric data types define what numbers you can work with in your program, but you must create variables to actually hold the numbers. A variable is a name composed of letters, numbers or the underscore character such as MyInteger, or MyInteger2. There are rules for variable naming though, that you must keep in mind. </font></font>
</pre>
	<ul>
		<li/>
<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Variable names must start with a letter or the underscore character. It is not recommended however, to use the underscore character, as this is generally used to indicate a system variable, and it is best to avoid it in case there may be a conflict with existing system variable names. </font></font>
</pre>
		<li/>
<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Most punctuation marks have a special meaning in FreeBasic and cannot be used in a variable name. While the period can be used, it is also used as a deference operator in Types, and so should not be used to avoid confusion or potential problems with future versions of the compiler. </font></font>
</pre>
		<li/>
<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Numbers can be used in a variable name, but cannot be the first character. MyVar1 is legal, but 1MyVar will generate a compiler error. </font></font>
</pre>
	</ul>
	<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The compiler creates variables in two ways. The first method, which isn't recommended and has been moved to the QB compatibility mode, is to let the compiler create variables on their first use. When the compiler first encounters a name in a program that is not a reserved word or keyword, it creates a variable using that name with the default data type. In most cases, the default data type is an integer. You can change the default variable type by using the DEF### directive, which will be covered later in this chapter. To enable these features, you must compile your program with either“-lang qb” or “-lang deprecated”. The problem with the first-use method is that it is very easy to introduce hard-to-find bugs in your program. </font></font>
</pre><p align="left" style="margin-bottom: 0in; border: 1.00pt solid #000000; padding: 0.02in; background: #c0c0c0">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The
	term “bug” for a software error has a long, and somewhat
	disputed history. The term predates modern computers and was used to
	describe industrial or electrical defects. Its use in relation to
	software errors is credited to Grace Hopper, a pioneer in the field
	of software design. According to the story, a moth was discovered
	between two electrical relays in a Mark II computer. Hopper made a
	note of it in her journal, along with the moth, and the term became
	associated with software errors after the incident. </font></font>
	</p>
	<p align="left" style="margin-bottom: 0in; border: 1.00pt solid #000000; padding: 0.02in; background: #c0c0c0">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The
	moth is now on display at the Smithsonian. <a class="sdfootnoteanc" name="sdfootnote1anc" href="#sdfootnote1sym"><sup>1</sup></a></font></font></p>
	<h2 class="western" align="left">The Dim Statement 
	</h2>
	<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The second, and preferred method is to explicitly declare variables in your program using the Dim statement. The Dim statement instructs the compiler to set aside some memory for a variable of a particular data type. For example, the statement Dim </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myInteger as Integer instructs the compiler to set aside 4 byes of storage for the variable myInteger. Whenever you manipulate myInteger in a program, the compiler will manipulate the data at the memory location set aside for myInteger. Just as with variable names, there are some rules for the use of Dim as well. </font></font>
</pre>
	<table width="100%" cellpadding="4" cellspacing="0">
		<col width="128*">
		<col width="128*">
		<tr valign="top">
			<td width="50%" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="text-align: left; background: transparent"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myVar As Integer</font></font></pre>
			</td>
			<td width="50%" style="border: 1px solid #000000; padding: 0.04in">
				<pre class="western" style="text-align: left; background: transparent"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">This will create a single integer-type variable. </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="text-align: left; background: transparent"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer myVar, myVar2</font></font></pre>
			</td>
			<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western" style="text-align: left; background: transparent"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">This will create two integer-type variables.</font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="text-align: left; background: transparent"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myVar As Double, myVar2 As Integer</font></font></pre>
			</td>
			<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western" style="text-align: left; background: transparent"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myVar As Double, myVar2 As Integer. This will create a double-type variable and an integer-type variable. </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="text-align: left; background: transparent"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myVar as Integer = 5</font></font></pre>
			</td>
			<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western" style="text-align: left; background: transparent"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">This will create an integer-type variable and set the value of the variable to 5. </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="text-align: left; background: transparent"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myVar As Double = 5.5, myVar2 As Integer = 5</font></font></pre>
			</td>
			<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western" style="text-align: left; background: transparent"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">This will create a double-type variable and set the value to 5.5, and an integer-type variable and set the value to 5. </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="text-align: left; background: transparent"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim Shared as Integer myInt</font></font></pre>
			</td>
			<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western" style="text-align: left; background: transparent"> <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">This will create a shared (global)variable myInt accessible anywhere within your program. </font></font></pre>
				<ol>
					<pre class="western" style="text-align: left; background: transparent"></pre>
				</ol>
			</td>
		</tr>
	</table>
	<ol>
		<pre class="western" style="text-align: left"></pre>
	</ol>
	<p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in; background: #c0c0c0">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt"><span style="background: #c0c0c0">Caution:</span>
	Dim myVar, myVar2 As Double. This may look like it creates two
	double-type variables, however myVar will not be defined and will
	result in compilation errors. Use rule 2 if you want to create
	multiple variables of the same type. </font></font>
	</p>
	<h2 class="western" align="left">Shared Variables 
	</h2>
	<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As you can see in rule 6 above, using the Dim Shared version of Dim creates a shared variable. This means that any variable you create as Shared can be accessed anywhere within the program’s current module. To put it another way, the scope of a shared variable is module level scope. Scope refers to the visibility of a variable, where you can access a particular variable within a program. There are different levels of scope and each are discussed in detail later in this book. </font></font>
</pre><p align="left" style="margin-bottom: 0in; border: 1.00pt solid #000000; padding: 0.02in; background: #c0c0c0">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The
	number of variables in your program (as well as the program itself)
	is limited only by your available memory, up to 2 gigabytes. </font></font>
	</p>
	<h2 class="western" align="left">Static Variables 
	</h2>
	<pre class="western" style="text-align: left">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Static variables are used within subroutines and functions and retain their values between calls to the subroutine or functions. The following program demonstrates using a static variable as a counter within a subroutine. </font></font>
</pre>
	<table width="100%" cellpadding="0" cellspacing="0" style="page-break-after: avoid">
		<col width="256*">
		<tr>
			<td width="100%" valign="top" style="border: none; padding: 0in">
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">sub StaticSub()</font></p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				   ‘<font face="Courier New, monospace">Dimension a static
				variable</font></p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">	Static cnt As Integer4</font></p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">	'Increment the count6</font></p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">	cnt += 17</font></p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">	Print &quot;In
				StaticSub&quot;;cnt;&quot; time(s).&quot;</font></p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">END Sub</font></p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<br/>

				</p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">'Dimension working variable</font></p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">DIM i As Integer</font></p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<br/>

				</p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">'Call sub 10 times</font></p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">FOR i = 1 To 1015</font></p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">	StaticSub</font></p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">NEXT</font></p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<br/>

				</p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">SLEEP</font></p>
				<p style="border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">END</font></p>
			</td>
		</tr>
	</table>
	<p style="margin-top: 0.08in"><font size="3" style="font-size: 12pt"><i>Listing
	1: static.bas</i></font></p>
	<pre class="western" style="text-align: left"></pre><p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Analysis:
	The subroutine StaticSub is defined. A subroutine is code that is
	executed only when called by the subroutine name which, in this
	case, is StaticSub. The static variable cnt,is dimensions, which is
	incremented when the subroutine is called. The last line prints out
	the current value of cnt to the console screen. </font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In
	line 10 a working variable that will be used in the For-Next is
	declared. Lines 14through 16 define the For-Next loop which will
	call StaticSub 10 times. Line 18 waits for a key press and line 19
	ends the program. </font></font>
	</p>
	<pre class="western" style="text-align: left">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Running the program in FBIde, you should get the following output. </font></font></pre><p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">In StaticSub 1 time(s). </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">In StaticSub 2 time(s). </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">In StaticSub 3 time(s). </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">In StaticSub 4 time(s). </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">In StaticSub 5 time(s). </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">In StaticSub 6 time(s). </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">In StaticSub 7 time(s). </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">In StaticSub 8 time(s). </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">In StaticSub 9 time(s). </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">In StaticSub 10 time(s). </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<pre class="western" style="text-align: left">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 2.1: Output of static.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As you can see from the output, the value of cnt is preserved between calls to the subroutine. Static variables can only be defined within a subroutine or function. Variables declared outside of a subroutine or function, that is at the module level, will maintain </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">their values and are static by default. </font></font>
</pre><h2 class="western" align="left">
	Common Variables 
	</h2>
	<pre class="western" style="text-align: left">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Variables declared as Common can be shared between multiple code modules, that is between multiple bas files in the same program. Common variables will be discussed in detail later in this book. </font></font>
</pre><h2 class="western" align="left">
	Extern and Import Variables 
	</h2>
	<pre class="western" style="text-align: left">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Extern and Import are used when creating DLL's and like Common, are designed to share variables in different modules. Extern and Import will be discussed in detail in the chapter on creating DLLs with FreeBasic. </font></font>
</pre><h2 class="western" align="left">
	Changing The Default Data Type 
	</h2>
	<pre class="western" style="text-align: left">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As already mentioned, the default data type for an undeclared variable is an integer. The default data type can be changed for a range of variables by using one of the DEF statements. Table 3.3 lists all the DEF statements available in FreeBasic. </font></font>


</pre>
	<table width="100%" cellpadding="4" cellspacing="0">
		<col width="128*">
		<col width="128*">
		<thead>
			<tr valign="top">
				<td width="50%" bgcolor="#cccccc" style="background: #cccccc" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Statement </font></font></pre>
				</td>
				<td width="50%" bgcolor="#cccccc" style="background: #cccccc" style="border: 1px solid #000000; padding: 0.04in">
					<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Comment </font></font></pre>
				</td>
			</tr>
		</thead>
		<tbody>
			<tr valign="top">
				<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western"><font size="2" style="font-size: 11pt">DEF BYTE a-b </font></pre>
				</td>
				<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
					<pre class="western"><font size="2" style="font-size: 11pt">Sets the default data type to byte for undeclared variables starting with letter range. </font></pre>
				</td>
			</tr>
			<tr valign="top">
				<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western"><font size="2" style="font-size: 11pt">DEF DBL a-b </font></pre>
				</td>
				<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
					<pre class="western"><font size="2" style="font-size: 11pt">Sets the default data type to double for undeclared variables starting with letter range. </font></pre>
				</td>
			</tr>
			<tr valign="top">
				<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western"><font size="2" style="font-size: 11pt">DEF INT a-b </font></pre>
				</td>
				<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
					<pre class="western"><font size="2" style="font-size: 11pt">Sets the default data type to integer for undeclared variables starting with letter range. </font></pre>
				</td>
			</tr>
			<tr valign="top">
				<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western"><font size="2" style="font-size: 11pt">DEF LNG a-b </font></pre>
				</td>
				<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
					<pre class="western"><font size="2" style="font-size: 11pt">Sets the default data type to long for undeclared variables starting with letter range. </font></pre>
				</td>
			</tr>
			<tr valign="top">
				<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western"><font size="2" style="font-size: 11pt">DEF LNGINT a-b </font></pre>
				</td>
				<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
					<pre class="western"><font size="2" style="font-size: 11pt">Sets the default data type to longint for undeclared variables starting with letter range. </font></pre>
				</td>
			</tr>
			<tr valign="top">
				<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western"><font size="2" style="font-size: 11pt">DEF SHORT a-b </font></pre>
				</td>
				<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
					<pre class="western"><font size="2" style="font-size: 11pt">Sets the default data type to short for undeclared variables starting with letter range. </font></pre>
				</td>
			</tr>
			<tr valign="top">
				<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western"><font size="2" style="font-size: 11pt">DEF SNG a-b </font></pre>
				</td>
				<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
					<pre class="western"><font size="2" style="font-size: 11pt">Sets the default data type to single for undeclared variables starting with letter range. </font></pre>
				</td>
			</tr>
			<tr valign="top">
				<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western"><font size="2" style="font-size: 11pt">DEF STR a-b </font></pre>
				</td>
				<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
					<pre class="western"><font size="2" style="font-size: 11pt">Sets the default data type to string for undeclared variables starting with letter range. </font></pre>
				</td>
			</tr>
			<tr valign="top">
				<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western"><font size="2" style="font-size: 11pt">DEF UBYTE a-b </font></pre>
				</td>
				<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
					<pre class="western"><font size="2" style="font-size: 11pt">Sets the default data type to ubyte for undeclared variables starting with letter range. </font></pre>
				</td>
			</tr>
			<tr valign="top">
				<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western"><font size="2" style="font-size: 11pt">DEF UINT a-b </font></pre>
				</td>
				<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
					<pre class="western"><font size="2" style="font-size: 11pt">Sets the default data type to uinteger for undeclared variables starting with letter range. </font></pre>
				</td>
			</tr>
			<tr valign="top">
				<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western"><font size="2" style="font-size: 11pt">DEF ULNGINT a-b </font></pre>
				</td>
				<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
					<pre class="western"><font size="2" style="font-size: 11pt">Sets the default data type to ulongint for undeclared variables starting with letter range. </font></pre>
				</td>
			</tr>
			<tr valign="top">
				<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western"><font size="2" style="font-size: 11pt">DEF USHORT a-b </font></pre>
				</td>
				<td width="50%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
					<pre class="western"><font size="2" style="font-size: 11pt">Sets the default data type to ushort for undeclared variables starting with letter range. </font></pre>
				</td>
			</tr>
		</tbody>
	</table>
	<pre class="western" style="text-align: left">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 2.3: FreeBasic DEF Statements </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The DEF statement will affect all variables that start with a letter in the given range. So if you add DEF DBL m-n to your program, any variable starting with m or n, will default to a double-type. All other variables that start with different numbers will default to an integer-type. A Dim statement will override any DEF statement, so if you declare an integer variable starting with m, it will be an integer, even though the DEF DBL is in effect. </font></font>
</pre><h2 class="western" align="left">
	Using Different Number Formats 
	</h2>
	<pre class="western" style="text-align: left">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Besides decimal numbers, FreeBasic is able to recognize numbers in hexadecimal,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">binary and octal formats. Table 3.4 lists the number base and format to use. </font></font>
</pre>
	<table width="100%" cellpadding="4" cellspacing="0">
		<col width="85*">
		<col width="85*">
		<col width="85*">
		<thead>
			<tr valign="top">
				<td width="33%" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western" style="text-align: center"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Number</font></font></pre>
				</td>
				<td width="33%" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western" style="text-align: center"> <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Base</font></font></pre>
				</td>
				<td width="33%" style="border: 1px solid #000000; padding: 0.04in">
					<pre class="western" style="text-align: center"> <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Format </font></font></pre>
				</td>
			</tr>
		</thead>
		<tbody>
			<tr valign="top">
				<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Decimal </font></font></pre>
				</td>
				<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myVar =</font></font></pre>
				</td>
				<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
					<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">254 </font></font></pre>
				</td>
			</tr>
			<tr valign="top">
				<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Hexadecimal</font></font></pre>
				</td>
				<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myVar =</font></font></pre>
				</td>
				<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
					<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">&amp;HFE </font></font></pre>
				</td>
			</tr>
			<tr valign="top">
				<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Binary</font></font></pre>
				</td>
				<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myVar =</font></font></pre>
				</td>
				<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
					<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">&amp;B11111110 </font></font></pre>
				</td>
			</tr>
			<tr valign="top">
				<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Octal</font></font></pre>
				</td>
				<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myVar =</font></font></pre>
				</td>
				<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
					<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">&amp;O376 </font></font></pre>
				</td>
			</tr>
			<tr valign="top">
				<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Exponential Numbers</font></font></pre>
				</td>
				<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myVar =</font></font></pre>
				</td>
				<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
					<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">243E10 </font></font></pre>
				</td>
			</tr>
		</tbody>
	</table>
	<pre class="western" style="text-align: left">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 2.4: Format of Number Bases </font></font>
</pre><h3 class="western" align="left">
	Hexadecimal Numbers 
	</h3>
	<pre class="western" style="text-align: left">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Hexadecimal is a base 16 numbering scheme and have digits in the range of 0 to F. Hexadecimal numbers are commonly used as constant values in the Windows API and  many third party libraries as it is a compact way to represent a large value. To indicate a hexadecimal number, use the &amp;H prefix. </font></font>
</pre><h3 class="western" align="left">
	Binary Numbers 
	</h3>
	<pre class="western" style="text-align: left">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Binary is a base 2 numbering scheme and have digits in the range of 0 and 1. Binary is the language of the computer. Although we can enter numbers and letters into the computer, it all must be translated into binary before the computer can understand it. To indicate a binary number, use the &amp;B prefix. </font></font>
</pre><h3 class="western" align="left">
	Octal Numbers 
	</h3>
	<pre class="western" style="text-align: left">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Octal is a base eight numbering scheme and have digits in the range of 0 to 7. Octal numbers were very popular in early computer systems, but aren’t used much today except in some specialized applications. To indicate an octal number, use the &amp;O prefix. </font></font>
</pre><h3 class="western" align="left">
	Exponential Numbers 
	</h3>
	<pre class="western" style="text-align: left">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You can use exponential numbers in your program by adding the E suffix followed by the power. To use the number 105, you would write the number as 10E05. You can directly set a double or single type variable using the exponent format. You can also use negative exponents such as 10E-5, which when printed to the screen would like 1.e004. </font></font></pre><h2 class="western" align="left">
	Which Data Type To Use? 
	</h2>
	<pre class="western" style="text-align: left">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">There are a number of different data types available, so how do you choose the right data type for any given application? The rule of thumb is to use the largest data type you need to hold the expected range of values. This may seem like stating the obvious, but many programs fail because the programmer did not fully understand the range of data in their program. When you crate a program, you should map out not only the logic of the program, but the data associated with each block of logic. When you map out the data ahead of time, you are less likely to run into data-type errors. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For example, if you were working with ASCII codes, which range from 0 to 255, an ubyte would be a good choice since the range of an ubyte is the same as the range of ASCII codes, and you are only using 1 byte of memory. There is another consideration though, the “natural” data size of the computer. On a 32-bit system, the natural data size is 4 bytes, or an integer. This means that the computer is optimized to handle an integer,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">and does so more efficiently, even though you are “wasting” 3 bytes of memory by using an integer for an ASCII code. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In most cases an integer is a good general-purpose choice for integer data. The range is quite large, it handles both negative and positive numbers and you benefit from using the computer’s natural data type. For floating point data, a double is a good choice since, like the integer, it has a good range of values and better precision than a single.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For large integer data you should use a uinteger for positive data or a longint for large negative and positive numbers. These are only suggestions; what data type you end up using will be dictated by the needs of your program. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">These “rules of thumb” apply to single variable declarations where a few wasted bytes are not critical. However, as you will see in the chapter on arrays, choosing the rightsized data type is critical in large arrays where a few wasted bytes can add up to large amount of wasted memory. </font></font>
</pre><h2 class="western" align="left">
	Option Explicit 
	</h2>
	<pre class="western" style="text-align: left">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You may notice when looking at other people's source code, the compiler directive Option Explicit has been used at the top of each program. A compiler directive is code that instructs the compiler to do something. In the case of Option Explicit, it instructs the compiler to make sure that any variable being used has been properly Dim’ed. Although you can write a program without using Option Explicit and explicitly Dim’ing each variable, you run the risk of introducing nasty, hard-to-find bugs as the following short program illustrates. </font></font></pre>
	<table width="100%" cellpadding="0" cellspacing="0">
		<col width="256*">
		<tr>
			<td width="100%" valign="top" style="border: none; padding: 0in">
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">Dim myInteger as Integer </font>
				</p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<br/>

				</p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">'set myInteger to a value</font></p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">myInteger = 5 </font>
				</p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">'Oops we mispelled the
				variable name </font>
				</p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">Print &quot;The output of
				myInteger is&quot;;myIntger </font>
				</p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">'wait for a key press </font>
				</p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<br/>

				</p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">Sleep </font>
				</p>
				<p style="border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">End </font>
				</p>
			</td>
		</tr>
	</table>
	<pre class="western" style="text-align: left">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 2.2: nooptionexplicit.bas </font></font>
</pre><p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis:
	In line 1 myInteger is being declared to the compiler. The compiler
	will use this declaration to allocate space for the variable. In
	line 3 the variable is being initialized to a value, in this case 3.
	The Print statement in line 5 will print out the result to the
	console screen. Sleep, listed in line 7, will wait for a key press
	and the End keyword in line 8 will end the program. The End
	statement isn't mandatory at the end of a program but should be used
	especially if you want to return an exit code to the operating
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">system.
	</font></font></font></font>
	</p>
	<pre class="western" style="text-align: left">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">After typing this program into FBIde and running the program, you should see the following output. </font></font>
</pre><p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">The output of myInteger is 0 </font>
	</p>
	<pre class="western" style="text-align: left">
</pre><h5 class="western" align="left">
	Output 2.2: nooptionexplicit.bas 
	</h5>
	<pre class="western" style="text-align: left">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The output should be 5, but as you can see, the result isn’t what was expected or wanted. Since Option Explicit wasn’t used in the program, the compiler created a new variable when it encountered the misspelled variable name, myIntger, in the print statement. If this was large and complicated program, you can see how difficult it would be to track this error down and fix it. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Now, add Option Explicit at the top of the program and run it again. You should seethe following error message in the results pane of FBIde. </font></font>
</pre><p align="left" style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">Variable not declared, found:
	'myIntger' </font>
	</p>
	<p align="left" style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<p align="left" style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<p align="left" style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">Print &quot;The output of
	myInteger is&quot;;myIntger</font></p>
	<p align="left" style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<p align="left" style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<p align="left" style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	 <font face="Courier New, monospace">^ </font>
	</p>
	<p align="left" style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<pre class="western" style="text-align: left">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 2.3: Modified nooptionexplicit.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Here the compiler detected the misspelled variable name and informed us of the problem. You should always use Option Explicit in your programs. A few seconds of extra typing will save you hours of frustration. </font></font>
</pre><h2 class="western" align="left">
	A Note about Option Explicit 
	</h2>
	<pre class="western" style="text-align: left">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Recent versions of the FreeBASIC compiler do not allow OPTION commands including OPTION EXPLICIT. From now on OPTION EXPLICIT is implied and your programs will behave as if you used OPTION EXPLICIT. It is a good rule of thumb to always implicitly declare your variables, so get in the habit now. To compile a source file that uses OPTION EXPLICIT, either use “-lang deprecated” or remove the OPTION EXPLICIT line from the source file. </font></font>
</pre><h2 class="western" align="left">
	</h2>
	<pre class="western" style="text-align: left; page-break-before: always"></pre><h2 class="western" align="left">
	Exercises 
	</h2>
	<pre class="western" style="text-align: left">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1) What data type would be the best to store the number 196? </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2) What data type would be the best to store the number 2.134? </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3) What data type is the best for general usage on 32-bit systems? </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4) What is the difference between signed and unsigned data types? </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5) What prefix would you use to designate a binary number? </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6) What prefix would you use to designate a hexadecimal number? </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7) What Alphabetic letters are allowed in a hexadecimal number? </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8) What would the hexadecimal number 1AF be in decimal form? </font></font>

</pre>
</div>
<div id="Converting Numeric Data Types " dir="ltr" href="../fbeginnerm6.odt">
	<h1 class="western" style="page-break-before: always">Chapter 3
	Converting Numeric Data Types 
	</h1>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you work with numbers there will come a time when you will need to converta variable from one data type to another data type. In FreeBasic there are two types ofdata conversion. Implicit, where the compiler will automatically convert the data typesduring an assignment or calculation, and explicit using one of the predefined conversion functions. </font></font>
</pre><h2 class="western">
	Implicit Data Conversion 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Implicit data conversion occurs either through an assignment statement, or as the result of a calculation. Where implicit data conversion can cause a problem is in the loss of precision that can result when converting a large data type to a smaller data type.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">While implicit data conversion eases the programming process somewhat, you want to make sure that the results you are getting are what you expect. You should always check the result of an implicit conversion to make sure the range of values being converted is in the expected range. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following short program illustrates the conversion that takes place during an assignment statement. </font></font>

</pre><p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Dim As Double myDbl </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Dim As Integer myInt </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">'Set myDbl to a float value </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">myDbl = 5.56 </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">'Assign myInt the float, will be
	converted to int </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">myInt = myDbl </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Print &quot;myInt =&quot;; myInt
	</font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Sleep </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">End</font></p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">Listing 3.1: assignconv.bas </font>
	</p>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: In lines 1 and 2 two variable are being declared, myDbl, a double-type variable and myInt, an integer-type variable. Line 3 is a comment which, as you can see,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">starts with the ' (single quote) character. In line 4 the double-type variable is being initialized to the floating-point value 5.56. In line 6 the double is being assigned to an integer variable, invoking the implicit conversion. In line 7 the Print displays the result on the console window. In line 8 the program waits for a key press with the Sleep statement and in line 9 the End statement is used to end the program. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Running the program will result in the following output. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myInt = 6 </font></font>

</pre>
	<ul>
		<li/>
<pre class="code2-western">Output 3.1: assignconv.bas </pre>
	</ul>
	<pre class="western">

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In the program, the value of myDbl which is a double-type variable, was set to</font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5.56. When myInt was assigned this float value, the compiler converted the value to an integer, and then rounded it up to 6. Maybe you were just looking for the whole number portion of 5? In this case, your result would be incorrect, although you may not know until later in the program. This type of subtle bug is another one of those problems that are hard to track down and fix. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Caution Even if the compiler is producing the correct result, there is no guarantee that future versions of the compiler will. It may be necessary to change the behavior of the compiler to add features or fix a bug, and you may find yourself with a program that suddenly quits working. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The next little program illustrates the implicit conversion that takes place during a calculation. In this example, the two integer operands are converted to double-types during the division calculation. </font></font>

</pre><p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Dim As Double myDbl </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Dim As Integer myInt1, myInt2 </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">'Assign values to myInt1, myInt2
	</font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">myInt1 = 5 </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">myInt2 = 3 </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">myDbl = myInt1 / myInt2 </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Print &quot;myDbl =&quot;; myDbl
	</font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Sleep </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">End </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<pre class="western">

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 3.2: calcconv.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 1 and 2 in the program are the alternate Dim statement formats. You can use this format to declare multiple variables of the same type. In line 4 and 5, the variables are initialized. In line 6 the / character is the division operator. The result of the division operation will be implicitly converted to a double-type in the assignment statement. Line 7 prints the newly converted value to the screen and in lines 8 and 9, the program will wait for a key press and then end. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Running the program produces the following output. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myDbl = 1.66666666666667 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 3.2: calconv.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The result is as expected since the double-type has a greater precision than the integer-type. However, consider this program and its output, which demonstrates the implicit rounding during calculations. </font></font>

</pre><p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Dim As Double myDbl1, myDbl2 </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Dim As Integer myInt </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">'Assign values to myInt1, myInt2
	</font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">myDbl1 = 5.6 </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">myDbl2 = 3.1 </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">myInt = myDbl1 / myDbl2 </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Print &quot;myInt =&quot;; myInt
	</font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Sleep </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">End </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 3.3: calcconv2.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: This program is similar to the program in Listing 4.2 except the conversion process is from two double-type variables to an integer. Lines 1 and 2 declare the working variables. Lines 4 and 5 set the values of the two double-type variables. Inline 6 the double-type division result is implicitly converted to an integer, resulting in precision loss. Line 7 prints the result to the console window and lines 8 and 9 wait for a key press and end the program. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The output of the program: </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myInt = 2 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 3.3: calconv2.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In this example, the two double-type variables were converted to integers andthen the division operation was performed. Since 5.6 was rounded up to 6 during theconversion, the result is 2 rather than 1. This may not be a problem, but you should beaware that these types of conversions occur when working with mixed precision types. </font></font>
</pre><h2 class="western">
	Explicit Data Conversion 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">There is an alternative to implicit data conversion, explicit data conversion where you use one of FreeBasic’s built-in conversion functions. Since these functions are designed for conversion, they return consistent results and are unlikely to change even if the implicit rules of the compiler change. Even though it is more work, it is always safer to explicitly convert data to the needed data type before carrying out operations on that data. </font></font>
</pre><h3 class="western">
	Numeric Data Conversion Functions 
	</h3>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 4.1 lists all the conversion functions. Keep in mind that these functions donot check for overflow, so be sure that the value passed to these functions is in theexpected range. </font></font>

</pre>
	<table width="665" cellpadding="4" cellspacing="0" style="page-break-before: auto; page-break-after: auto; page-break-inside: auto">
		<col width="165">
		<col width="150">
		<col width="158">
		<col width="157">
		<tr valign="top">
			<td width="165" style="background: transparent" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in" sdval="0" sdnum="1033;0;@">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Function</span></font></font></font></pre>
			</td>
			<td width="150" style="background: transparent" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in" sdval="0" sdnum="1033;0;@">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><span style="text-decoration: none"> <font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt">Syntax </span></font></font></font></pre>
			</td>
			<td width="158" style="background: transparent" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in" sdval="0" sdnum="1033;0;@">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Purpose</span></font></font></font></pre>
			</td>
			<td width="157" style="background: transparent" style="border: 1px solid #000000; padding: 0.04in" sdval="0" sdnum="1033;0;@">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><span style="text-decoration: none"> <font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt">Comment </span></font></font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="165" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in" sdval="0" sdnum="1033;0;@">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Cast</span></font></font></font></pre>
			</td>
			<td width="150" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">B = Cast(datatype,expression)</span></font></font></font></pre>
			</td>
			<td width="158" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Convert expression to data-type listed. </span></font></font></font></pre>
			</td>
			<td width="157" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Datatype is any of the available FreeBasic data-types. Expression is a numeric value, variable or expression. </span></font></font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="165" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in" sdval="0" sdnum="1033;0;@">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Cbyte</span></font></font></font></pre>
			</td>
			<td width="150" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><span style="text-decoration: none"> <font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt">B = CByte(expression) </span></font></font></font></pre>
			</td>
			<td width="158" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Convert expression to byte. </span></font></font></font></pre>
			</td>
			<td width="157" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Expression must be in the range –128 to 127. </span></font></font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="165" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in" sdval="0" sdnum="1033;0;@">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">CDbl </span></font></font></font></pre>
			</td>
			<td width="150" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">B = CDbl(expression) </span></font></font></font></pre>
			</td>
			<td width="158" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Convert expression to double. </span></font></font></font></pre>
			</td>
			<td width="157" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Expression must be in the range of -2.2E-308 to+1.7E+308. </span></font></font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="165" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in" sdval="0" sdnum="1033;0;@">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Cint </span></font></font></font></pre>
			</td>
			<td width="150" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">B = Cint(expression) </span></font></font></font></pre>
			</td>
			<td width="158" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><span style="text-decoration: none"> <font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt">Convert expression to integer. </span></font></font></font></pre>
			</td>
			<td width="157" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Expression must be in the range of –2,147,483,648 to2,147,483,647.</span></font></font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="165" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in" sdval="0" sdnum="1033;0;@">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Clng</span></font></font></font></pre>
			</td>
			<td width="150" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><span style="text-decoration: none"> <font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt">B = CLng(expression) </span></font></font></font></pre>
			</td>
			<td width="158" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Convert expression tolong. Long is analias for integer. </span></font></font></font></pre>
			</td>
			<td width="157" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Expression must be in the range of –2,147,483,648 to2,147,483,647. </span></font></font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="165" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in" sdval="0" sdnum="1033;0;@">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">ClngInt </span></font></font></font></pre>
			</td>
			<td width="150" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">B = ClngInt(expression) </span></font></font></font></pre>
			</td>
			<td width="158" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Convert expression to long int.</span></font></font></font></pre>
			</td>
			<td width="157" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><span style="text-decoration: none"> <font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt">Expression must be in the range of –9,223,372,036,854,775,808 to 9,223,372,036,854,775,807 </span></font></font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="165" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in" sdval="0" sdnum="1033;0;@">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Cshort</span></font></font></font></pre>
			</td>
			<td width="150" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><span style="text-decoration: none"> <font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt">B = CShort(expression) </span></font></font></font></pre>
			</td>
			<td width="158" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Convert expression to short. </span></font></font></font></pre>
			</td>
			<td width="157" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Expression must be in the range of -32768 to 32767. </span></font></font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="165" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in" sdval="0" sdnum="1033;0;@">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">CUByte</span></font></font></font></pre>
			</td>
			<td width="150" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><span style="text-decoration: none"> <font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt">B = CUByte(expression) </span></font></font></font></pre>
			</td>
			<td width="158" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Convert expression to unsigned byte.  </span></font></font></font></pre>
			</td>
			<td width="157" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Expression must be in the range of 0 to255.</span></font></font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="165" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in" sdval="0" sdnum="1033;0;@">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">CUInt</span></font></font></font></pre>
			</td>
			<td width="150" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><span style="text-decoration: none"> <font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt">B = CUInt(expression) </span></font></font></font></pre>
			</td>
			<td width="158" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Convert expression to unsigned integer. </span></font></font></font></pre>
			</td>
			<td width="157" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Expression must be in the range of 0 to 4,294,967,296. </span></font></font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="165" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in" sdval="0" sdnum="1033;0;@">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">CULngInt </span></font></font></font></pre>
			</td>
			<td width="150" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">B = CULngInt(expression) </span></font></font></font></pre>
			</td>
			<td width="158" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Convert expression to long unsigned integer. </span></font></font></font></pre>
			</td>
			<td width="157" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Expression must be in the range of 0 to18,446,744,073,709,551,615 .</span></font></font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="165" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in" sdval="0" sdnum="1033;0;@">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">CUShort  </span></font></font></font></pre>
			</td>
			<td width="150" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">B = CUShort(expression)</span></font></font></font></pre>
			</td>
			<td width="158" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Convert expression to unsigned short. </span></font></font></font></pre>
			</td>
			<td width="157" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Expression must be in the range of 0 to 65535. </span></font></font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="165" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in" sdval="0" sdnum="1033;0;@">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">CSng</span></font></font></font></pre>
			</td>
			<td width="150" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><span style="text-decoration: none"> <font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt">B = SCng(expression) </span></font></font></font></pre>
			</td>
			<td width="158" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Convert expression to single. </span></font></font></font></pre>
			</td>
			<td width="157" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Expression must be in the range of 1.1 E-38 to 3.43E+38. </span></font></font></font></pre>
			</td>
		</tr>
	</table>
	<p style="margin-top: 0.08in"><font size="3" style="font-size: 12pt"><i>Table
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3.1:
	FreeBasic Conversion Functions</font></font>: </i></font>
	</p>
	<pre class="western">



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When examining conversion functions it is important to understand how the function rounds with both negative and positive numbers. The FreeBasic conversion functions round numbers up, making positive number more positive and negative numbers more negative. The following program illustrates the rounding with Cast and Cint, as well as demonstrating that the conversion functions will work with expressions as well as numbers. </font></font></pre><p style="margin-left: 0.15in; margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Dim as Double myDouble1,
	myDouble2, myDouble3 </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Dim as Integer myInt </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	‘<font face="Courier New, monospace">Set variable ranges </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">myDouble1 = 143.5 </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">myDouble3 = 143.4 </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">myDouble2 = 143.5 </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">myInt = 12 </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">'Show cast in action </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Print &quot;** Cast **&quot; </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Print &quot;Double1
	&quot;;myDouble1;&quot; cast to integer &quot;;Cast(Integer,
	myDouble1) </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Print &quot;Double2
	&quot;;myDouble2;&quot; cast to integer &quot;;Cast(Integer,
	myDouble2) </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Print &quot;Double3
	&quot;;myDouble3;&quot; cast to integer &quot;;Cast(Integer,
	myDouble3) </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Print &quot;Expression
	&quot;;myDouble1;&quot; + &quot;;myInt;&quot; cast to double &quot;;
	</font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Print Cast(Double, myDouble1 +
	myInt) </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Print </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	 
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	‘<font face="Courier New, monospace">Show cint in action </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Print &quot;** CInt **&quot; </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Print &quot;Double1
	&quot;;myDouble1;&quot; cint to integer &quot;;CInt(myDouble1) </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Print &quot;Double2
	&quot;;myDouble2;&quot; cast to integer &quot;;CInt(myDouble2) </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Print &quot;Double3
	&quot;;myDouble3;&quot; cast to integer &quot;;CInt(myDouble3) </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Print &quot;Expression
	&quot;;myDouble1;&quot; + &quot;;myInt;&quot; cast to integer
	&quot;;CInt(myDouble1 + myInt) </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Print &quot;Expression
	&quot;;myDouble2;&quot; + &quot;;myInt;&quot; cast to integer
	&quot;;CInt(myDouble2 + myInt) </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Print </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Sleep </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	 <font face="Courier New, monospace">End </font>
	</p>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 3.4: convert.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: This program demonstrates the built-in FreeBasic conversion functions.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Lines 1 and 2 declare the working variables using the alternate format of the Dim. Two tables of information are printed to the console in line 12 to 18 and lines 21 to 27. In lines13 to 16, the result of the Cast function is printed directly to the screen, as is the Cint function in lines 22 to 26. Normally the values would be saved in another variable to be used in the program. Line 16 ends with a semi-colon. This instructs the compiler not to </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">print a carriage return after the print statement, so that when the value of Cast is printed in line 17, the value will appear on the same line as the data printed in line 16. The program is closed in the usual way using Sleep and End. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Running the program will produce the output shown below. </font></font>

</pre><p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">** Cast ** </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">Double1 143.5 cast to integer
	144 </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">Double2 143.5 </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">cast to integer 144 </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">Double3 143.4 cast to integer
	143 </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">Expression 143.5 + 12 cast to
	double 155.5 </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">** CInt ** </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">Double1 143.5 cint to integer
	144 </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">Double2 143.5 </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">cast to integer 144 </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">Double3 143.4 cast to integer
	143 </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">Expression 143.5 + 12 cast to
	integer 156 </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">Expression 143.5 </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">+ 12 cast to integer –132 </font>
	</p>
	<pre class="western">

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 3.4: convert.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As you can see from the program, you can use both numbers and expressions in the conversion functions. Keep in mind that if you pass an expression to a conversion function, the evaluated expression must not exceed the limit of the target data type, or an overflow will occur. Looking at the output you can see that the rounding for middle values is up or greater in magnitude. 143.5 rounds up, making the resulting number more positive and –143.5, more negative. </font></font>
</pre><h3 class="western">
	Using Conversion Functions in Macros 
	</h3>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">One area where the conversion functions listed in Table 4.1 are useful is in the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">creation of macros. A macro is a small piece of executable code that the compiler inserts into the program at designated areas. Macros are defined using the #Define compiler directive. #Define has the format #Define name symbol. When the compiler encounters name within the program code, it is replaced with symbol. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following program creates a macro that packs a screen row and column number into the high and low bytes of a uinteger. The conversion function Cint is used since you will not always know the data type being passed to the macro, and you want to be sure that you are working with known quantities. </font></font>
</pre>
	<table width="100%" cellpadding="4" cellspacing="0">
		<col width="256*">
		<tr>
			<td width="100%" valign="top" style="border: 1px solid #000000; padding: 0.04in">
				<p align="left"><br/>

				</p>
			</td>
		</tr>
	</table>
	<pre class="western">
</pre><p style="margin-left: 0.15in; margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">'Macro created by v1ctor </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">#define MAKDWORD(x,y) (cint(x)
	shl 16 or cint(y)) </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Dim myInt As Uinteger </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Dim As Integer i, cnt </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">'Store row 5 column 5 in a
	single uinteger </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">myInt = MAKDWORD(5, 5) </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">'Set the width and height of the
	console window </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Width 80, 25 </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">'Print column headers </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">cnt = 1 </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">For i = 1 To 80</font></p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	 <font face="Courier New, monospace">'Print columns as
	12345678901... </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">If cnt = 10 Then</font></p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	 <font face="Courier New, monospace">cnt = 0 </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">End If </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Locate 1, i </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">'Convert to string so we don't
	get leading space </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Print Str(cnt) </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">'Increment our counter </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">cnt += 1 </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Next </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">'Print row headers </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">cnt = 2 </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">For i = 2 To 25</font></p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	 <font face="Courier New, monospace">'Row numbers will be like col
	numbers </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">If cnt = 10 Then</font></p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	 <font face="Courier New, monospace">cnt = 0 </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">End If </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Locate i, 1 </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">'Convert to string so we don't
	get leading space </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">'We need the semicolon </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">so a line feed isn't printed </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">'on line 25 which would scroll
	screen. </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Print Str(cnt); </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">'Increment our counter </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">cnt += 1 </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Next </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">'Print out string on saved
	location </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Locate Hiword(myInt),
	Loword(myInt) </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Print &quot;We stored the screen
	location in a single uinteger!&quot; </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">45 </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Sleep </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">End </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 3.5: makdword.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: In line 2 the #define compiler directive is used to create a macro. A macro is an snippet of executable code that the compiler will insert into the code when it finds the macro name, MAKDWORD. In lines 4 and 5 the working variables are declared.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In line 8, the variable myInt is initialized with the macro previously defined. The macro stores the screen locations, row 5 and column 5 in the high and low word of the integer variable. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In line 11 the Width statement is used to set the console screen to 80 columns and </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">25 rows. The variable cnt, which will be used to print out the column and row headers, is set to 1. Lines 14 through 24 prints out the column headers using a For-Next loop. Line 19 uses the Locate statement to set the cursor position and line 36 prints out the value. The numbers will range from 1 to 0 and then repeat. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In line 36 the Str function is used to convert the numeric value of cnt to a string so that the Print statement will not insert a leading space. Print inserts a leading space when printing numeric variables so they can accommodate a leading negative sign. Lines 26 through 39 print out the row headers in the same fashion as the column headers. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In line 42 the two functions Hiword and Loword are used to retrieve the high and low bytes of the integer variable, which contain the row and column respectively. Line 45and 46 wait for a key press and end the program in the usual fashion. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The macro is defined in line 2 takes two parameters, x and y. The compiler wills substitute MAKDWORD(x,y) with (cint(x) shl 16 or cint(y)) replacing x with the first </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">number and y with the second number. Cint is used within the macro so that no matter </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">what values are passed through x and y, the macro will always be working with integers.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The operators or and shl will be discussed later in the book. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Locate statement expects a row number and column number to position texton the screen. In line 42 we are using the two functions Hiword and Loword to return the high (most significant) and low (least significant) words of the integer myInt, which contain the row and column numbers respectively. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Running the program will produce the following output. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12345678901234567890123456789012345678901234567890123456789012345678901234567890 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 We stored the screen location in a single uinteger! </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 3.5: makdword.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#Define is fully explored in the chapter on symbolic constants later in the book. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Decimal Rounding Functions </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">FreeBasic has two built-in rounding functions for use with decimal numbers. Table</font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4.2 lists the functions along with their explanations. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function Syntax Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Int B = Int(expression) Returns an integer value less than or equal tothe input. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Fix B = Fix(expression) Returns the integer part of the input. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 3.2: FreeBasic Rounding Functions </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As with the other conversion functions, this should be tested with both negative and positive numbers to see how the function behaves. The program intfix.bas listed below illustrates the results returned by the functions as well as their use with calculations. </font></font>


</pre><p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace"><font color="#808080"><span style="font-style: normal"><span style="font-weight: normal">'Create
	some double variables </span></span></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace"><font color="#b1b100"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">Dim</font></span></span></font><font size="1" style="font-size: 8pt">
	</font><font color="#b1b100"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">As</font></span></span></font><font size="1" style="font-size: 8pt">
	Double myDouble1 = </font><font color="#cc66cc"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">5.5</font></span></span></font><font size="1" style="font-size: 8pt">,
	myDouble2 = </font><font color="#cc66cc"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">5.9</font></span></span></font><font size="1" style="font-size: 8pt">
	</font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	 
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace"><font color="#808080"><span style="font-style: normal"><span style="font-weight: normal">'Show
	rounding on negative and positive values </span></span></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace"><font color="#b1b100"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">Print</font></span></span></font><font size="1" style="font-size: 8pt">
	</font><font color="#ff0000"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">&quot;Doubles:&quot;</font></span></span></font><font size="1" style="font-size: 8pt">,
	myDouble1, myDouble2 </font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace"><font color="#b1b100"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">Print</font></span></span></font><font size="1" style="font-size: 8pt">
	</font><font color="#ff0000"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">&quot;Int:&quot;</font></span></span></font><font size="1" style="font-size: 8pt">,
	</font><font color="#b1b100"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">Int</font></span></span></font><font color="#66cc66"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">(</font></span></span></font><font size="1" style="font-size: 8pt">myDouble1</font><font color="#66cc66"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">)</font></span></span></font><font size="1" style="font-size: 8pt">,
	</font><font color="#b1b100"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">Int</font></span></span></font><font color="#66cc66"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">(</font></span></span></font><font size="1" style="font-size: 8pt">myDouble2</font><font color="#66cc66"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">)</font></span></span></font><font size="1" style="font-size: 8pt">
	</font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace"><font color="#b1b100"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">Print</font></span></span></font><font size="1" style="font-size: 8pt">
	</font><font color="#ff0000"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">&quot;Fix:&quot;</font></span></span></font><font size="1" style="font-size: 8pt">,
	</font><font color="#b1b100"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">Fix</font></span></span></font><font color="#66cc66"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">(</font></span></span></font><font size="1" style="font-size: 8pt">myDouble1</font><font color="#66cc66"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">)</font></span></span></font><font size="1" style="font-size: 8pt">,
	</font><font color="#b1b100"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">Fix</font></span></span></font><font color="#66cc66"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">(</font></span></span></font><font size="1" style="font-size: 8pt">myDouble2</font><font color="#66cc66"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">)</font></span></span></font><font size="1" style="font-size: 8pt">
	</font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace"><font color="#b1b100"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">Print</font></span></span></font><font size="1" style="font-size: 8pt">
	</font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace"><font color="#808080"><span style="font-style: normal"><span style="font-weight: normal">'Try
	some calculation expressions </span></span></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace"><font size="1" style="font-size: 8pt">myDouble1
	= </font><font color="#cc66cc"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">15.78</font></span></span></font><font size="1" style="font-size: 8pt">
	</font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace"><font size="1" style="font-size: 8pt">myDouble2
	= </font><font color="#cc66cc"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">22.12</font></span></span></font><font size="1" style="font-size: 8pt">
	</font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace"><font color="#b1b100"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">Print</font></span></span></font><font size="1" style="font-size: 8pt">
	</font><font color="#ff0000"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">&quot;Expression:&quot;</font></span></span></font><font size="1" style="font-size: 8pt">,myDouble1;</font><font color="#ff0000"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">&quot;
	+&quot;</font></span></span></font><font size="1" style="font-size: 8pt">;myDouble2;</font><font color="#ff0000"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">&quot;
	= &quot;</font></span></span></font><font size="1" style="font-size: 8pt">;
	</font><font color="#b1b100"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">Str</font></span></span></font><font color="#66cc66"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">(</font></span></span></font><font size="1" style="font-size: 8pt">myDouble1
	+ myDouble2</font><font color="#66cc66"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">)</font></span></span></font><font size="1" style="font-size: 8pt">
	</font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace"><font color="#b1b100"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">Print</font></span></span></font><font size="1" style="font-size: 8pt">
	</font><font color="#ff0000"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">&quot;Int:&quot;</font></span></span></font><font size="1" style="font-size: 8pt">,
	</font><font color="#b1b100"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">Int</font></span></span></font><font color="#66cc66"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">(</font></span></span></font><font size="1" style="font-size: 8pt">myDouble1
	+ myDouble2</font><font color="#66cc66"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">)</font></span></span></font><font size="1" style="font-size: 8pt">
	</font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace"><font color="#b1b100"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">Print</font></span></span></font><font size="1" style="font-size: 8pt">
	</font><font color="#ff0000"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">&quot;Fix:&quot;</font></span></span></font><font size="1" style="font-size: 8pt">,
	</font><font color="#b1b100"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">Fix</font></span></span></font><font color="#66cc66"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">(</font></span></span></font><font size="1" style="font-size: 8pt">myDouble1
	+ myDouble2</font><font color="#66cc66"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">)</font></span></span></font><font size="1" style="font-size: 8pt">
	</font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace"><font color="#808080"><span style="font-style: normal"><span style="font-weight: normal">'Wait
	for keypress </span></span></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Sleep </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace"><font color="#b1b100"><span style="font-style: normal"><span style="font-weight: normal"><font size="1" style="font-size: 8pt">End</font></span></span></font><font size="1" style="font-size: 8pt">
	</font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	 
	</p>
	<pre class="western">

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 3.6: intfix.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 2 uses the alternative syntax for Dim to declare and initialize the working variables. Line 4 through 6 display the results of the conversion function suingboth positive and negative numbers. Line 9 and 10 set the values for the variables to be used in calculations. Lines 12 through 14 display the results of the conversion functions using calculations so FreeBasic resolves the calculations before invoking the functions.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Lines 17 and 18 end the program in the usual way. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The result of running the program is shown in Output 4.6. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Doubles: 5.5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5.9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Int: 6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Fix: 5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Expression: 15.78 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">+ 22.12 = 6.34 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Int: 6 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Fix: 6 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 3.6: infix.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Notice that in the output Int returns a –6 for the input –5.5, since 6 is less than –</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5.5, and 5 for 5.9 since 5 is less than 6. Fix on the other hand truncates the decimal and </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">returns the integer portion of the double. As you can see both functions will also workwith an expression, in this myDouble1 + myDouble2. Which function you would usedepends on what behavior you would need with negative numbers, as they both returnsimilar results with positive numbers. </font></font>
</pre><h2 class="western">
	A Look Ahead 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In addition to the built-in conversion functions, there are a number of functions </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">available in the C Runtime Library, which is the subject of the next chapter. </font></font>

</pre><h2 class="western">
	Exercises 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1) How do you stop your program from printing a carriage return at the end of a line? </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2) What function would you use to convert an unknown value to a Double? </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3) What function would you use to convert an unknown value to an Integer? </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4) What would be the result of the equation 5 / 2 if assigned to an Integer? </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5) How do the functions Int() and Fix() differ in their results? </font></font>

</pre>
</div>
<div id="Arithmetic Operators " dir="ltr" href="../fbeginnerm8.odt">
	<h1 class="western" style="page-break-before: always">Chapter 5
	Arithmetic Operators 
	</h1>
	<pre class="western"></pre><h2 class="western">
	Arithmetic Operators 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Table 6.1 lists all the arithmetic operators in FreeBasic. In the table below, the operators will work on two or more expressions, where expression is a number, variable or another expression. The square brackets in the syntax column indicate optional additional expressions. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function 	Syntax	 Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">+ (Addition) 	B = expression + expression [ + expression…] 	Returns the sum of two or more expressions. Expression can be anumber, variable or another expression. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">- (Subtraction)	 B = expression – expression[ - expression…] 	Returns the difference between two or more expressions. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">* (Multiplication) 	B = expression * expression[ * expression…] 	Returns the product of two or more expressions. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">/ (Division)	 B = expression / expression[ / expression…] 	Returns the division of two or more expression. The result implicitly converted tothe target data type. That is, if B is an integer, the result will be rounded, if B is a double or single, the result will be a decimal number. Note: If the second expression evaluates to zero(0), then a run time error will occur. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">\ (Integer Division) 	B = expression \ expression[ \ expression…] </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Returns the integer result of division of two or more </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">expressions. The result is implicitly converted to an integer. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Note: If the second </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">expression evaluates to zero(0), then a run time error will </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">occur. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">^ (Exponentiation)	 B = expression^value		Returns the result of raising expression to the power of value. That is 2^2 = 2*2. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">MOD (Modulo) 	B = expression MOD 	Returns the remainder of </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function Syntax Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">expression the implicit division of theexpressions as an integerresult. If expression is adecimal value, expression isrounded before the division. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">- (Negation) B = - expression Returns the negated valueof expression. This is thesame as multiplying by –1. Ifexpression is positive, B willnegative. If expression isnegative, B will positive. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">( ) (Parenthesis) B = expression operator </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">( expression [operatorexpression [ (…]) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Forces evaluation of </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">expression. Parenthesis canbe nested, but must be </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">closed properly or a compileerror will occur. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 5.1: Arithmetic Operators </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You should be familiar with most of these operators from math class. Integerdivision is used when you are not concerned about the remainder of the division process.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Mod operator has several uses including executing some code only at certain times,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">and for creating wrap-around functions such as are likely to occur when a sprite reachesthe edge of the screen and needs to wrap around to the other side. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When using these operators together in single statement, you must b aware ofhow FreeBasic evaluates the expression. For example, does 5 + 6 * 3 equal 33 or does itequal 23? FreeBasic evaluates expressions based on precedence rules, that is, rules thatdescribe what gets evaluated when. Table 6.2 lists the precedence rules for thearithmetic operators. The order of precedence is the same order as the listing; that is thetop row has the highest precedence, while lower rows have lower precedence. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Operator </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">( ) (Parenthesis) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">^ (Exponentiation) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">- (Negation) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">*, / (Multiplication and division) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">\ (Integer division) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">MOD (Modulus) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">SHL, SHR (Shift bit left and shift bit right) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">+, - (Addition and subtraction) </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 5.2: Precedence of Arithmetic Operators </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The SHL and SHR operators will be discussed in the next section, BitwiseOperators. They are included here to show where they fall in the precedence rules. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Looking at the table and the equation 5 + 6 * 3 you can see that this will evaluateto 23 not 33, since multiplication has a higher precedence then addition. The compilerwill read the expression from left to right, pushing values onto an internal stack until itcan resolve part or all of the equation. For this equation 5 will be read and pushed, thenthe + operator will be read and pushed onto the stack. Since the + operator requires twooperands, the compiler will read the next element of the expression which will be the *</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">operator. This operator also requires two operands, so * will be pushed onto the stack andthe 3 will be read. Since * takes priority over +, the 6 and 3 will be multiplied, and thatvalue will be stored on the stack. At this point there is a 5, + and 18 on the stack. Sincethere is only one operator left and two operands, the 5 and 18 will be added together tomake 23, which will be returned as the result of the expression. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If you wanted to make sure that 5 + 6 gets evaluated first, then you would useparenthesis to force the evaluation. You would write the parenthesized expression as (5 +</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6) * 3. Since the parenthesis have the highest precedence, the expression they containwill be evaluated before the multiplication. The evaluation process here is the same asthe previous process. The ( is treated as an operator and is pushed onto the stack. The 5,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">+, and 6 are read followed by the ). The ) signals the end of the parenthesis operation, sothe 5 and 6 are added together and pushed onto the stack. The * is read along with the 3.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The stack at this point contains an 11, * and 3. The 11 and 3 are multiplied together and33 is returned as the result of the evaluation. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You can also embed parenthesis within parenthesis. Each time the compilerencounters a (, it begins a new parenthesis operation. When it encounters a ), the last ( isused to evaluate the items contained within the ( and ) and that result is either placed onthe stack for further evaluation or returned as a result. Each ( must be match to a ) or acompiler error will occur. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following program demonstrates both implicit evaluation and forcedevaluation. </font></font>
</pre><p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">Option
	Explicit </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">Dim
	As Integer myInt </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">'Let
	compiler evaluate expression according to precedence </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">myInt
	= 5 + 6 * 3  </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">Print
	&quot;Expression 5 + 6 * 3 = &quot;;myInt </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">'Force
	evaluation </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">myInt
	= (5 + 6) * 3 </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">Print
	&quot;Expression (5 + 6) * 3 = &quot;;myInt </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">'Wait
	for keypress </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> </span>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">Sleep
	</span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> </span>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">End
	</span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<br/>

	</p>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 5.1: precedence.bas </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: As always we open the program with Option Explicit in line 1 and declarethe working variables in line 3. In line 6 the compiler evaluates the math expressionaccording to precedence rules and stores the result in myInt, which is printed to theconsole window in line 7. In line 10, parenthesis are used to force the evaluation of theexpression which is printed to the console screen in line 11. Lines 14 and 15 close theprogram in the usual way. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As you can see from the output below, using parenthesis allows you to control theevaluation of the expression. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Expression 5 + 6 * 3 = 23 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Expression (5 + 6) * 3 = 33 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 5.1: precedence.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">What about the case where tow operators are used that have the sameprecedence level? How does FreeBasic evaluate the expression? To find out, run thefollowing program. </font></font>
</pre><p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> <font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b>Option
	Explicit </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> </span>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> <font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b>Dim
	As Integer myInt </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> </span>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> <font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b>'Expression
	1 </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> <font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b>myInt
	= 3 + 5 4 </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> </span>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> <font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b>Print
	&quot;Expression 1: 3 + 5 4 is&quot;;myInt </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> </span>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> <font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b>'Expression
	2 </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> <font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b>myInt
	= 3 5 + 4 </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> </span>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> <font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b>Print
	&quot;Expression 2: 3 5 + 4 is&quot;;myInt </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> </span>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> <font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b>'Expression
	3 </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> <font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b>myInt
	= 6 * 2 / 3 </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> </span>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> <font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b>Print
	&quot;Expression 3: 6 * 2 / 3 is&quot;;myInt </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> </span>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> <font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b>'Expression
	4 </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> <font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b>myInt
	= 6 / 2 * 3 </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> </span>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> <font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b>Print
	&quot;Expression 4: 6 / 2 * 3 is&quot;;myInt </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> <font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b>Sleep
	</span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">End
	</span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<br/>

	</p>
	<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 5.2: sameprecedence.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: In line 3 the working variable myInt is declared, since the program usesthe Option Explicit directive in line 1. In line 6 the expression has the + operator first andthe – second, while in line 11 the order has been reversed to test the evaluation order. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The results are printed in lines 8 and 13. Line 16 and 21 use the * and / operators on thesame manner to test the order of evaluation and the results are printed in lines 18 and</font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">23. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Running the program produces the following result. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Expression 1: 3 + 5 4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">is 4 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Expression 2: 3 5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">+ 4 is 2 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Expression 3: 6 * 2 / 3 is 4 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Expression 4: 6 / 2 * 3 is 9 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 5.2: Output of sameprecedence.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As you can see from the output each expression has been evaluated from left toright. In expression 1, 3 + 5 is 8 and subtracting 4 equals 4. In expression 2, 3 – 5 isequal to -2, and adding 4 equals 2. In expression 3, 6 * 2 is 12 and divide that by 3 andyou get 4. In expression 4, 6 /2 is 3 and multiplies by 3 results in 9. The program showsthat operators that have the same precedence level are evaluated from left to right. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">This is the case where parenthesis are very helpful in ensuring that the evaluationorder is according to your program needs. When in doubt, always use parenthesis toensure that the result is what you want in your program. </font></font>
</pre><h2 class="western">
	Shortcut Arithmetic Operators 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">FreeBasic has a number of shortcut arithmetic operators similar to those found inthe C programming language. These operators have the same precedence as their singlecounterparts. The following table lists the shortcut operators. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Operator Syntax Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">+= B += expression Add B to expression andassign to B. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">-= B -= expression Subtract B to expressionand assign to B. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">*= B *= expression Multiply B to expression andassign to B. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">/= B /= expression Divide B by expression and </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Operator Syntax Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">assign to B. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">\= B \= expression Integer divide B byexpression and assign to B. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 5.3: Shortcut Arithmetic Operators </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Using these operators will cut down on the typing you have to do, especially forstatements such as a = a + 1, which can be written as a += 1. </font></font>

</pre><h2 class="western">
	Binary Number System 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Computers use the binary, or base 2, numbering system to represent data. Base 2digits are the numbers 0 and 1. A single binary 1 or 0 is called a bit. Four bits is called anybble. Two nybbles, or 8 bits is called a byte and 2 bytes make up a word. The size of adata type determines how many bits are available to represent a particular number. A </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">byte has 8 bits, a short has 16 bits, an integer has 32 bits and a longint has 64 bits. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You will notice that each data type is double the size of the previous data type.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">This is because the binary system uses powers of 2 to represent data. 20 is 1. 21 is 2. 22 is </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4. 23 is 8. 24 is 16, and so on. To find the value of a binary number, you start from theright, which is position 0 and add the power of twos going left if there is a 1 in the bitposition. If a nybble is 1101, then the right-most position is 20, the next position left is </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">skipped since it has a zero, followed by 22 and finally 23. Resolving the power terms givesyou 1 + 4 + 8 which equals 13. The value ranges for the different data types is a directresult of the number of bits in each data type. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Being able to manipulate individual bits, bytes and words has a number of uses.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For example, the messaging system of the Windows API use integers to store both the idof a control and event the control received, as the following code snippet shows. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Case WM_COMMAND2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">wmId = Loword( wParam )</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">wmEvent = Hiword( wParam ) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 5.3: Snippet from Windows Message Loop </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In this snippet the id of the control is stored in the low word of wParam, and theevent number is stored in the high word. Since a word is 2 bytes or 16 bits, you can store65535 ids in a single word, using an unsigned data type, or 32767 ids for a signed datatype. This is a very efficient way to manage data in your program. </font></font>
</pre><h2 class="western">
	The Sign Bit 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The sign bit, the leftmost bit, is used by the computer to determine if a signed datatype is negative or positive using the Two's Complement form of notation. To represent anegative number, the positive value of the number is negated, that is all the 1's arechanged to 0 and the 0's are changed to 1's, and 1 is added to that result. For example,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">binary 5 is 0000 0101. Negating all the bits results in 1111 1010. Adding 1 results in 11111011. Since the leftmost bit is 1, this is a negative number. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">We can confirm this by using the power of 2 notation which results in the following:</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">-128 (27) + 64 (26) + 32 (25) + 16 (24) + 8 (23) + 0 + 2 (21) + 1 (20) = - 5. Remember, ifa bit is zero, we add zero to the total. The following program shows the binaryrepresentation of both positive 5 and negative five. </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Byte myByte </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As String myBits </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myByte = 5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Get the binary form of number </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myBits = Bin(myByte) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Append some leading zeros so print line up </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myBits = String(8 Len(</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myBits), &quot;0&quot;) &amp; myBits </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print out nybbles with a space between so is is easier to read </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;myByte =&quot;;myByte;&quot; which is binary &quot;; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print Mid(myBits, 1, 4) &amp; &quot; &quot; &amp; Mid(myBits, 5, 4) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myByte = 5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Get the binary form of number </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myBits = Bin(myByte) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Append some leading zeros so print line up </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myBits = String(8 Len(</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myBits), &quot;0&quot;) &amp; myBits </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print out nybbles with a space between so is is easier to read </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;myByte =&quot;;myByte;&quot; which is binary &quot;; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print Mid(myBits, 1, 4) &amp; &quot; &quot; &amp; Mid(myBits, 5, 4) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 5.4: signbit.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Lines 3 and 4 declare the working variables, a byte that will represent theactual number and a string that will represent the binary value. In line 6 the myByte isset to 5. In line 8 the Bin function is used to return a string that represents the binaryvalue of 5. Since Bin does not return any leading 0's, the String function is used to padthe string to a full 8 bits for display purposes. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The first parameter of the String function is the number of characters to add andthe second parameter is the character to use to pad the string. Since a byte is 8 bitslong, subtracting the length of myBits from 8 will give the number of 0's to add to thestring, if the length of myBits is less than 8. In line 12 the numeric value of myByte isprinted, which is 5. A semi-colon is added to the end of print statement so that Print willnot print out a carriage return. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In line 13 the binary string is printed in two groups of four, that is each nybble, tomake the display easier to read. The Mid function used in line 13 returns a portion of a </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">string. The first parameter of the Mid function is the string, the second is the startposition and the third parameter is the number of characters to copy. The first Midreturns the first four characters, which is appended to a space using the &amp; operator,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">which in turn is appended to the last four characters. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 15 sets myByte to -5 and lines 17 through 22 format the output and display itto the screen. The program is ended in the usual manner. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program the following output is displayed. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myByte = 5 which is binary 0000 0101 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myByte =5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">which is binary 1111 1011 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 5.3: Output of signbit.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You can see that the output for -5 matches the Two's Complement form. We canconfirm this by negating 1111 1011 which results in 0000 0100 and adding 1 whichresults in 0000 0101, or positive 5. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Why is this important? Signed data types have a smaller range of values thanunsigned data types because a bit is being used to represent the sign of the number. Ifyou are needing to store a large number of data values, such as ids, in a byte or integer,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">the number of possible values you can store depends on whether it is signed orunsigned. If the number of values needed exceed the range of a signed data type, thenuse an unsigned data type. </font></font>
</pre><h2 class="western">
	A Look Ahead 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">There are times when you need to manipulate individual bits and bytes of avariable. FreeBasic has a rich set of bitwise operators and macros that you will see in thenext chapter. </font></font>
</pre>
</div>
<div id="Bitwise Operators " dir="ltr" href="../fbeginnerm9.odt">
	<h1 class="western" style="page-break-before: always">Chapter 6
	Bitwise Operators 
	</h1>
	<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">FreeBasic includes a number of operators that manipulate the bits of a number.  The following table lists the bit wise operators in order of their precedence. That is, the first row has the highest precedence while lower rows have lower precedence. </font></font>
</pre>
	<table width="100%" cellpadding="4" cellspacing="0" style="page-break-inside: avoid">
		<col width="64*">
		<col width="64*">
		<col width="64*">
		<col width="64*">
		<thead>
			<tr valign="top">
				<td width="25%" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Operator</font></font></pre>
				</td>
				<td width="25%" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Syntax</font></font></pre>
				</td>
				<td width="25%" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Truth Table</font></font></pre>
				</td>
				<td width="25%" style="border: 1px solid #000000; padding: 0.04in">
					<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Comments</font></font></pre>
				</td>
			</tr>
		</thead>
		<tbody>
			<tr valign="top">
				<td width="25%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western">Not (Bitwise negation) </pre>
				</td>
				<td width="25%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western">B = NOT expression </pre>
				</td>
				<td width="25%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western" style="text-align: left">NOT 0 = 1 
NOT 1 = 0 </pre>
				</td>
				<td width="25%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
					<pre class="western">Inverts operand bit; turns a 1 into 0 and a 0 into 1. </pre>
				</td>
			</tr>
			<tr valign="top">
				<td width="25%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western">And (Bit wise conjunction)</pre>
				</td>
				<td width="25%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western">B = expression And expression 	</pre>
				</td>
				<td width="25%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western" style="text-align: left">0 AND 0 = 0 
1 AND 0 = 0 
0 AND 1 = 0 
1 AND 1 = 1 </pre>
				</td>
				<td width="25%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
					<pre class="western">Result bit is 1 only if both operand bits are 1.</pre>
				</td>
			</tr>
			<tr valign="top">
				<td width="25%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western">Or (Bit wise disjunction) </pre>
				</td>
				<td width="25%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western">B = expression OR expression </pre>
				</td>
				<td width="25%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western" style="text-align: left">0 OR 0 = 0 
1 OR 0 = 1 
0 OR 1 = 1 
1 OR 1 = 1 </pre>
				</td>
				<td width="25%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
					<pre class="western">Result bit is 1 if either or both operand bits is1. </pre>
				</td>
			</tr>
			<tr valign="top">
				<td width="25%" height="87" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western">Xor (Bit wise exclusion) </pre>
				</td>
				<td width="25%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western">B = expression Xor expression</pre>
				</td>
				<td width="25%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western" style="text-align: left">0 XOR 0 = 0 
1 XOR 0 = 1 
0 XOR 1 = 1 
1 XOR 1 = 0 </pre>
				</td>
				<td width="25%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
					<pre class="western">Result bit is 1 if operand bits are different.</pre>
				</td>
			</tr>
			<tr valign="top">
				<td width="25%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western">Eqv (Bit wise equivalence) </pre>
				</td>
				<td width="25%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western">B = expression EQV expression </pre>
				</td>
				<td width="25%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western" style="text-align: left">0 EQV 0 = 1 
1 EQV 0 = 0 
0 EQV 1 = 0 
1 EQV 1 = 1 </pre>
				</td>
				<td width="25%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
					<pre class="western">Result bit is 1 if both operand bits are 0 or 1. </pre>
				</td>
			</tr>
			<tr valign="top">
				<td width="25%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western">Imp (Bitwise implication) </pre>
				</td>
				<td width="25%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western">B = expression Imp expression </pre>
				</td>
				<td width="25%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western" style="text-align: left">0 IMP 0 = 1 
1 IMP 0 = 0 
0 IMP 1 = 1 
1 IMP 1 = 1 </pre>
				</td>
				<td width="25%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
					<pre class="western">Result bit is 0 if first bit is 1 and second bit is 0, otherwise result is 1. </pre>
				</td>
			</tr>
		</tbody>
	</table>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 6.1: Bitwise Operators </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The truth table column indicates the operation on the individual bits. The order of the bits are not important except for the IMP operator which tests the bits of the second operand using the bits from the first operand. </font></font>
</pre><h2 class="western">
	The NOT Operator 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You saw the NOT operator at work in the two's complement section. The following program performs the same two's complement operation. </font></font></pre>
	<table width="100%" cellpadding="4" cellspacing="0">
		<col width="256*">
		<tr>
			<td width="100%" valign="top" style="border: none; padding: 0in">
				<ul>
					<li/>
<pre class="code2-western">Dim As Byte myByte = 5 </pre>
					<li/>
<pre class="code2-western"></pre>
					<li/>
<pre class="code2-western">'5 in decimal and binary </pre>
					<li/>
<pre class="code2-western">Print &quot;myByte:&quot;;myByte,&quot; Binary: &quot;;Bin(myByte) </pre>
					<li/>
<pre class="code2-western">'Apply NOT operator </pre>
					<li/>
<pre class="code2-western">myByte = Not myByte </pre>
					<li/>
<pre class="code2-western">'Value after NOT operation </pre>
					<li/>
<pre class="code2-western">Print &quot;NOT myByte: &quot;;myByte,&quot; Binary: &quot;;Bin(myByte) </pre>
					<li/>
<pre class="code2-western">'Add 1 after NOT operation </pre>
					<li/>
<pre class="code2-western">myByte = myByte + 1 </pre>
					<li/>
<pre class="code2-western">'Print result = 5 </pre>
					<li/>
<pre class="code2-western">in decimal and binary </pre>
					<li/>
<pre class="code2-western">Print &quot;myByte + 1: &quot;;myByte,&quot; Binary: &quot;;Bin(myByte) </pre>
					<li/>
<pre class="code2-western"></pre>
					<li/>
<pre class="code2-western"></pre>
					<li/>
<pre class="code2-western">Sleep </pre>
					<li/>
<pre class="code2-western">End </pre>
				</ul>
			</td>
		</tr>
	</table>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 6.1: not.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: In line 3 the working variable myByte is declared and initialized using the alternate format of the Dim statement. Line 6 prints out the value of myByte in both decimal and binary. In line 8 the NOT operator is used to negate all the bits in the integer.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The result of the operation is printed to the console window in line 10. In line 12, 1 is added to the result as required by the two's complement method. The result of this operation id printed in line 14. The program is closed in the usual way. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When the program is run, you should see the following output. </font></font>
</pre>
	<table width="100%" cellpadding="0" cellspacing="0">
		<col width="256*">
		<tr>
			<td width="100%" valign="top" style="border: none; padding: 0in">
				<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
				<font face="Courier New, monospace">myByte: 5 Binary: 101 </font>
				</p>
				<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
				<br/>

				</p>
				<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
				<br/>

				</p>
				<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
				<font face="Courier New, monospace">NOT myByte: 6 </font>
				</p>
				<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
				<font face="Courier New, monospace">Binary: 11111010 </font>
				</p>
				<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
				<br/>

				</p>
				<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
				<br/>

				</p>
				<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
				<font face="Courier New, monospace">myByte + 1: 5 </font>
				</p>
				<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
				<font face="Courier New, monospace">Binary: 11111011 </font>
				</p>
				<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
				<br/>

				</p>
				<p style="border: none; padding: 0in; background: #c0c0c0"><br/>

				</p>
			</td>
		</tr>
	</table>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 6.1: Output of not.bas</font></font>

 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As you can see from the output, the final result of the program is -5 after applying the twos complement method to myByte. The 1 in the leftmost position indicates that the number is negative. Bin doesn't add the leading zeros in the first output line, but the three digits shown are the rightmost three digits. </font></font>
</pre><h2 class="western">
	The AND Operator 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The AND operator can be used to test if an individual bit is 1 or 0 by using a mask value to test for the bit position as the following program illustrates. </font></font>
</pre>
	<table width="100%" cellpadding="4" cellspacing="0">
		<col width="256*">
		<tr>
			<td width="100%" valign="top" style="border: none; padding: 0in">
				<ul>
					<li/>
<pre class="code2-western">'Declare working variable and mask value </pre>
					<li/>
<pre class="code2-western">'The mask will test the 3rd bit position, i.e. 4 </pre>
					<li/>
<pre class="code2-western">Dim As Byte myByte = 5, Mask = 4 </pre>
					<li/>
<pre class="code2-western">'Print decimal and binary values </pre>
					<li/>
<pre class="code2-western">Print &quot;Testing 3rd bit position (from right)&quot; </pre>
					<li/>
<pre class="code2-western">Print &quot;myByte:&quot;;myByte,&quot; Binary: &quot;;Bin(myByte) </pre>
					<li/>
<pre class="code2-western">Print &quot;Mask: &quot;;Mask,&quot; Binary: &quot;;Bin(Mask) </pre>
					<li/>
<pre class="code2-western">'Check to see if 3rd bit is set </pre>
					<li/>
<pre class="code2-western">If (myByte And Mask) = 4 Then </pre>
					<li/>
<pre class="code2-western">	Print &quot;3rd bit is 1&quot; </pre>
					<li/>
<pre class="code2-western">Else</pre>
					<li/>
<pre class="code2-western">	Print &quot;3rd bit is 0&quot; </pre>
					<li/>
<pre class="code2-western">End If </pre>
					<li/>
<pre class="code2-western">Print </pre>
					<li/>
<pre class="code2-western">'The mask will test the 2nd bit position, i.e. 2 </pre>
					<li/>
<pre class="code2-western">Mask = 2 </pre>
					<li/>
<pre class="code2-western">'Print decimal and binary values </pre>
					<li/>
<pre class="code2-western">Print &quot;Testing 2nd bit position (from right)&quot; </pre>
					<li/>
<pre class="code2-western">Print &quot;myByte:&quot;;myByte,&quot; Binary: &quot;;Bin(myByte) </pre>
					<li/>
<pre class="code2-western">Print &quot;Mask: &quot;;Mask,&quot; Binary: &quot;;Bin(Mask) </pre>
					<li/>
<pre class="code2-western">'Check to see if 2nd bit is set </pre>
					<li/>
<pre class="code2-western">If (myByte And Mask) = 4 Then </pre>
					<li/>
<pre class="code2-western">	Print &quot;2nd bit is 1&quot; </pre>
					<li/>
<pre class="code2-western">Else </pre>
					<li/>
<pre class="code2-western">	Print &quot;2nd bit is 0&quot; </pre>
					<li/>
<pre class="code2-western">End If </pre>
					<li/>
<pre class="code2-western">Sleep </pre>
					<li/>
<pre class="code2-western">End </pre>
				</ul>
			</td>
		</tr>
	</table>
	<pre class="western">

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 6.2: and.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: In line 5 the working variables are declared and initialized. The first section of the program is testing for the third bit position of myByte, which is bit 22, or </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">decimal 4. Lines 8 through 10 print out the heading, decimal and binary values for the variables. The If statement in line 13 uses the AND operator to test for a 1 in the 3rd bit position, and since binary 5 contains a one in this position, the program will execute the code immediately following the Then keyword. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 21 sets the mask value to 2 to test for a 1 in the second bit position, which is 21 or 2. Line 23 through 25 print out the header, decimal and binary values of the variables. line 28 uses the AND operator to test for a 1, and since binary 5 has a 0 in this position, the program will execute the code immediately following hr Else keyword. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Running the program produces the following output. </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Testing 3rd bit position (from right) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myByte: 5 Binary: 101 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Mask: 4 Binary: 100 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3rd bit is 1 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Testing 2nd bit position (from right) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myByte: 5 Binary: 101 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Mask: 2 Binary: 10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2nd bit is 0 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 6.3: Output of and.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Looking at the binary values you can see how the bits line up and how the And operator can test for individual bits. 5 in binary has a bit set in the 20 (1) and 22 (4) position. Setting the mask value to 4 sets bit position 22 to 1 and all other bit positions to 0. The expression (myByte And Mask) will return an integer value that will contain the And values of the two operands. Since the mask has zeros in every position except for the 22 position, all of the other bits will be masked out, that is 0, returning a 4. Since the return value of 4 matches the target value 4, the code following the Then clause is executed. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The second portion of the program test for the 21 position of myByte. Since this position contains a 0 in myByte, the value returned from the expression (myByte And </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Mask) does not match the target value, so the code following the Else clause if executed. </font></font>
</pre><h2 class="western">
	The OR Operator 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You can use the OR operator to set multiple values in a single variable. The Windows API uses this technique to set flags for objects such as the styles of a window.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following program illustrates this concept.</font></font>
</pre>
	<table width="100%" cellpadding="4" cellspacing="0">
		<col width="256*">
		<tr>
			<td width="100%" valign="top" style="border: none; padding: 0in">
				<ul>
					<li/>
<pre class="code2-western">'Declare working variable </pre>
					<li/>
<pre class="code2-western">Dim As Byte myByte, Mask </pre>
					<li/>
<pre class="code2-western">'Set the flags in the byte </pre>
					<li/>
<pre class="code2-western">myByte = 2 </pre>
					<li/>
<pre class="code2-western">myByte = myByte Or 4 </pre>
					<li/>
<pre class="code2-western">'Print decimal and binary values </pre>
					<li/>
<pre class="code2-western">Print &quot;myByte set to 2 and 4&quot; </pre>
					<li/>
<pre class="code2-western">Print &quot;myByte:&quot;;myByte,&quot; Binary: &quot;;Bin(myByte) </pre>
					<li/>
<pre class="code2-western">Print </pre>
					<li/>
<pre class="code2-western">'Set the mask to 2 </pre>
					<li/>
<pre class="code2-western">mask = 2 </pre>
					<li/>
<pre class="code2-western">Print &quot;Testing for 2&quot; </pre>
					<li/>
<pre class="code2-western">'Check for 2 value </pre>
					<li/>
<pre class="code2-western">If (myByte And Mask) = 2 Then </pre>
					<li/>
<pre class="code2-western">Print &quot;myByte contains 2&quot; </pre>
					<li/>
<pre class="code2-western">Else</pre>
					<li/>
<pre class="code2-western"> Print &quot;myByte doesn't contains 2&quot; </pre>
					<li/>
<pre class="code2-western">End If </pre>
					<li/>
<pre class="code2-western">Print </pre>
					<li/>
<pre class="code2-western">'Set the mask value to 4 </pre>
					<li/>
<pre class="code2-western">Mask = 4 </pre>
					<li/>
<pre class="code2-western">'Print decimal and binary values </pre>
					<li/>
<pre class="code2-western">Print &quot;Testing for 4&quot; </pre>
					<li/>
<pre class="code2-western">If (myByte And Mask) = 4 Then</pre>
					<li/>
<pre class="code2-western"> Print &quot;myByte contains 4&quot; </pre>
					<li/>
<pre class="code2-western">Else</pre>
					<li/>
<pre class="code2-western"> Print &quot;myByte doesn't contain 4&quot; </pre>
					<li/>
<pre class="code2-western">End If </pre>
					<li/>
<pre class="code2-western">Print </pre>
					<li/>
<pre class="code2-western">'Set the mask value to 8 </pre>
					<li/>
<pre class="code2-western">Mask = 8 </pre>
					<li/>
<pre class="code2-western">'Print decimal and binary values </pre>
					<li/>
<pre class="code2-western">Print &quot;Testing for 8&quot; </pre>
					<li/>
<pre class="code2-western">If (myByte And Mask) = 8 Then</pre>
					<li/>
<pre class="code2-western"> Print &quot;myByte contains 8&quot; </pre>
					<li/>
<pre class="code2-western">Else </pre>
					<li/>
<pre class="code2-western">Print &quot;myByte doesn't contain 8&quot; </pre>
					<li/>
<pre class="code2-western">End If </pre>
					<li/>
<pre class="code2-western"></pre>
					<li/>
<pre class="code2-western"></pre>
					<li/>
<pre class="code2-western">Sleep </pre>
					<li/>
<pre class="code2-western">End </pre>
				</ul>
			</td>
		</tr>
	</table>
	<pre class="western"> 
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 6.4: or.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 4 declares the working variables. In line 7, myByte is set to 2 and inline 8, that value is combined with 4 using the OR operator. Lines 10 and 11 print out the decimal and binary values of myByte. In line 14, the mask is set to 2 and in lines 18through 22 the AND operator is used to test for 2 in myByte. Since myByte contains a 2,the program will execute the code immediately following the Then clause. Lines 24through 31 use the same procedure to test for the value of 4. Since myByte contains a 4,the program will print out the text “myByte contains a 4”. In lines 34 through 41, myByte is tested for 8, which is does not contains so the code in line 40 will be executed. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program, you should get the following output. </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myByte set to 2 and 4 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myByte: 6 Binary: 110 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Testing for 2 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myByte contains 2 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Testing for 4 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myByte contains 4 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Testing for 8 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myByte doesn't contain 8 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 6.2: Output of or.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As you can see from the output, you can pack multiple values into a single variable. The number of values a variable can contain depends on the size of data type and the range of values. Using the OR and AND combination is a technique that you will find in wide-spread use, especially in third-party libraries, as it provides an efficient way to pass multiple data items using a single variable. </font></font>
</pre><h2 class="western">
	The XOR Operator 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">One of the more useful aspects of the XOR operator is to flip bits between two states. XORing a value with 0 will return the original value, and XORing with a 1 returns the opposite value. Suppose that you start with a 1 bit and XOR with a 0 bit. Since the two inputs are different you will get a 1. If the start value is 0 and you XOR with a 0, then both values are the same and you will get a 0. In both cases the output is the same as the input. If you start with a 1 and XOR with a 1, you will get a 0 since both inputs are the same. If you start with a 0 and XOR with a 1, you will get a 1 since the inputs are different. Here the inputs have been flipped to the opposite values. You can use this technique with a mask value, XORing once to get a new value, and then XORing again with the same mask to get the original value. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">One use of this technique is to display a sprite on the screen using XOR and then erasing the sprite by using another XOR at the same location. The first XOR combines the bits of the background with the sprite bits to display the image. Another XOR in the same location flips the bits back to their original state, once again showing the background and effectively erasing the sprite image. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">XOR can also be used to swap the values of two variables as demonstrated in the following program. </font></font>
</pre>
	<table width="100%" cellpadding="0" cellspacing="0">
		<col width="256*">
		<tr>
			<td width="100%" valign="top" style="border: none; padding: 0in">
				<ul>
					<li/>
<pre class="code2-western">Dim As Integer myInt1 = 5, myInt2 = 10 </pre>
					<li/>
<pre class="code2-western">Print &quot;myInt1 = &quot;;myInt1;&quot; myInt2 = &quot;;myInt2 </pre>
					<li/>
<pre class="code2-western">Print &quot;Swapping values...&quot; </pre>
					<li/>
<pre class="code2-western">myInt1 = myInt1 Xor myInt2 </pre>
					<li/>
<pre class="code2-western">myInt2 = myInt1 Xor myInt2 </pre>
					<li/>
<pre class="code2-western">myInt1 = myInt1 Xor myInt2 </pre>
					<li/>
<pre class="code2-western">Print &quot;myInt1 = &quot;;myInt1;&quot; myInt2 = &quot;;myInt2 </pre>
					<li/>
<pre class="code2-western">Sleep </pre>
					<li/>
<pre class="code2-western">End </pre>
				</ul>
			</td>
		</tr>
	</table>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 6.5: xor.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: In line 3 the working variables are declared and initialized. Line 5 prints out the initial variable values. Lines 7 through 9 carry out the XOR operation. In line 7,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">MyInt1 is XORed with myInt2 to get an intermediate value which is stored in myInt1. Inline 8, the XOR operation returns the original value of myInt1 which is stored in myInt2.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The third XOR operation in line 9 then returns the value of myInt2 from the intermediate value that was stored in myInt1 in line 7. Line 10 prints out the swapped values and the program is then closed in the usual way. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Running the program produces the following output. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myInt1 = 5 myInt2 = 10 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Swapping values... </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myInt1 = 10 myInt2 = 5 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 6.3: Output of xor.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As you can see the program was able to swap the two values without using a temporary variable because the XOR operator is able to flip the bits between two distinct </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">states. </font></font>
</pre><h2 class="western">
	The EQV Operator 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The EQV operator isn't used much as a bit wise operator, but it can be used to see if two expressions are equivalent as the following program demonstrates. </font></font>
</pre>
	<table width="100%" cellpadding="0" cellspacing="0">
		<col width="256*">
		<tr>
			<td width="100%" valign="top" style="border: none; padding: 0in">
				<ul>
					<li/>
<pre class="code2-western">#define False 0</pre>
					<li/>
<pre class="code2-western">#define True NOT False</pre>
					<li/>
<pre class="code2-western"></pre>
					<li/>
<pre class="code2-western">Dim As Integer myInt1 = 4, myInt2 = 2</pre>
					<li/>
<pre class="code2-western"></pre>
					<li/>
<pre class="code2-western">Print &quot;myInt1 = &quot;;myInt1;&quot; myInt2 = &quot;;myInt2</pre>
					<li/>
<pre class="code2-western">Print</pre>
					<li/>
<pre class="code2-western">'Both statements are true so are equivalent.</pre>
					<li/>
<pre class="code2-western">PRINT &quot;Statement (myInt1 &lt; 5) equiv (myInt2 &gt; 1) &quot;;</pre>
					<li/>
<pre class="code2-western">If (myInt1 &lt; 5) Eqv (myInt2 &gt; 1) = True Then</pre>
					<li/>
<pre class="code2-western">	Print &quot;is equivalent.&quot;</pre>
					<li/>
<pre class="code2-western">Else</pre>
					<li/>
<pre class="code2-western">	Print &quot;is not equivalent.&quot;</pre>
					<li/>
<pre class="code2-western">End If</pre>
					<li/>
<pre class="code2-western">Print</pre>
					<li/>
<pre class="code2-western">'Both statements are false so are equivalent.</pre>
					<li/>
<pre class="code2-western">Print &quot;Statement (myInt1 &gt; 5) equiv (myInt2 &lt; 1) &quot;;</pre>
					<li/>
<pre class="code2-western">If (myInt1 &gt; 5) Eqv (myInt2 &lt; 1) = True Then</pre>
					<li/>
<pre class="code2-western">	Print &quot;is equivalent.&quot;</pre>
					<li/>
<pre class="code2-western">Else</pre>
					<li/>
<pre class="code2-western">	Print &quot;is not equivalent.&quot;</pre>
					<li/>
<pre class="code2-western">End If</pre>
					<li/>
<pre class="code2-western">Print</pre>
					<li/>
<pre class="code2-western">'One is true, the other false so statement</pre>
					<li/>
<pre class="code2-western">'is not equivalent.</pre>
					<li/>
<pre class="code2-western">Print &quot;Statement (myInt1 &gt; 5) equiv (myInt2 &lt; 1) &quot;;</pre>
					<li/>
<pre class="code2-western">If (myInt1 &gt; 3) Eqv (myInt2 &lt; 1) = True Then</pre>
					<li/>
<pre class="code2-western">	Print &quot;is equivalent.&quot;</pre>
					<li/>
<pre class="code2-western">Else</pre>
					<li/>
<pre class="code2-western">	Print &quot;is not equivalent.&quot;</pre>
					<li/>
<pre class="code2-western">End If</pre>
					<li/>
<pre class="code2-western"></pre>
					<li/>
<pre class="code2-western">SLEEP</pre>
					<li/>
<pre class="code2-western">End</pre>
				</ul>
			</td>
		</tr>
	</table>
	<pre class="western">



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 6.6: eqv.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: In lines 3 and 4, the values False and True are defined. FreeBasic uses -1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">to indicate a True result from a logical operation such as that performed when executing an If statement. Since False is defined as 0, NOT False flips all the bits to 1, including the sign bit, making -1. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In line 6 the working variables are declared and initialized. Lines 12 through 18 test the first expression. The If statement in line 13 will execute the first expression, (myInt1&lt; 5). Since 4 &lt; 5 this will return True. The EQV operator has lower precedence then(myInt2 &gt; 1), so this will be evaluated, and since 2 &gt; 1 then will also return true. This leaves -1 EQV -1 to be evaluated. Since -1 is equivalent to -1, the whole statement is True. In line 22, both of the expressions are False. 0 EQV 0 is True, so this statement is also True and will print out the affirmative. In line 32, the first expression is True while the second is False. Since -1 is not equivalent to 0, this statement will evaluate to False and the negative will be printed. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When the program is run, you will see the following output. </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myInt1 = 4 myInt2 = 2 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Statement (myInt1 &lt; 5) equiv (myInt2 &gt; 1) is equivalent. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Statement (myInt1 &gt; 5) equiv (myInt2 &lt; 1) is equivalent. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Statement (myInt1 &gt; 5) equiv (myInt2 &lt; 1) is not equivalent. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 6.7: Output of eqv.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">It is important to realize that you are not testing to see if the expressions are True or False. You are only testing to see if the expressions are equivalent to each other. To put it another way, you are testing to see if two assertions are equivalent to each other. For example, suppose you have two characters in a game and you want to attack with both characters, if they are at equivalent strength. You could build an expression similar to the one in the listing and take action based on the equivalence of the two characters. </font></font>
</pre><h2 class="western">
	The IMP Operator 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Like the EQV operator, IMP is rarely used as a bit wise operator. It is used in logic programming to test whether assertion A implies assertion B. Looking at the truth table we can see that a True assertion implies a True conclusion so True and True is also True. A True assertion however cannot imply a False conclusion so True and False is False. A False premise can imply any conclusion so False with any conclusion is always True. Unless you are building an expert system or natural language interface, you will probably never need to use this operator. </font></font>
</pre><p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in; background: #c0c0c0">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Caution
	Exercise caution when using bit wise operators with arithmetic
	operators, as the result may not be what you expect. When used in
	logical expressions, such as in an If statement, make sure the bit
	wise operators operate on either the True or False values of
	complete expressions to avoid evaluation problems. </font></font>
	</p>
	<pre class="western"></pre><h2 class="western">
	Shortcut Bitwise Operators 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The bit wise operators, like the arithmetic operators, can be written in shorthand form. The following table lists the shortcut versions of the bit wise operators. </font></font>
</pre>
	<table width="100%" cellpadding="4" cellspacing="0">
		<col width="85*">
		<col width="85*">
		<col width="85*">
		<thead>
			<tr valign="top">
				<td width="33%" style="background: transparent" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Operator</span></font></font></font></pre>
				</td>
				<td width="33%" style="background: transparent" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><span style="text-decoration: none"> <font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt">Syntax </span></font></font></font></pre>
				</td>
				<td width="33%" style="background: transparent" style="border: 1px solid #000000; padding: 0.04in">
					<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><span style="text-decoration: none"> <font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt">Comment </span></font></font></font></pre>
				</td>
			</tr>
		</thead>
		<tbody>
			<tr valign="top">
				<td width="33%" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">And=</span></font></font></font></pre>
				</td>
				<td width="33%" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><span style="text-decoration: none"> <font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt">B And= C </span></font></font></font></pre>
				</td>
				<td width="33%" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
					<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">This is the same as B = B And C. </span></font></font></font></pre>
				</td>
			</tr>
			<tr valign="top">
				<td width="33%" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Or=</span></font></font></font></pre>
				</td>
				<td width="33%" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><span style="text-decoration: none"> <font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt">B Or= C </span></font></font></font></pre>
				</td>
				<td width="33%" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
					<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">This is the same as B = B Or C. </span></font></font></font></pre>
				</td>
			</tr>
			<tr valign="top">
				<td width="33%" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Xor= </span></font></font></font></pre>
				</td>
				<td width="33%" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">B Xor= C </span></font></font></font></pre>
				</td>
				<td width="33%" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
					<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">This is the same as B = B Xor C. </span></font></font></font></pre>
				</td>
			</tr>
			<tr valign="top">
				<td width="33%" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">Eqv= </span></font></font></font></pre>
				</td>
				<td width="33%" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">B Eqv = C </span></font></font></font></pre>
				</td>
				<td width="33%" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
					<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="Liberation Serif, serif"><font size="3" style="font-size: 12pt"><span style="text-decoration: none">This is the same as B = B Eqv C.</span></font></font></font></pre>
				</td>
			</tr>
			<tr valign="top">
				<td width="33%" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt"><span style="text-decoration: none">Imp= </span></font></font></font></pre>
				</td>
				<td width="33%" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western" style="font-style: normal; font-weight: normal; text-align: left; text-decoration: none"><font color="#000000"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt"><span style="text-decoration: none">B Imp= C</span></font></font></font></pre>
				</td>
				<td width="33%" style="background: transparent" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
					<p><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">This
					is the same as B = B <font color="#000000"><span style="text-decoration: none"><span style="font-style: normal"><span style="font-weight: normal"><span style="text-decoration: none">Imp
					C. </span></span></span></span></font></font></font>
					</p>
				</td>
			</tr>
		</tbody>
	</table>
	<pre class="western"> 
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 6.2: Shortcut Bitwise Operators </font></font>
</pre><h2 class="western">
	The SHL and SHR Operators 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">SHL stands for shift left and SHR stands for shift right. As the names imply, these operators shift the bits of a byte or integer-type variable either left or right. The following table shows the syntax diagram of both operators. </font></font>
</pre>
	<table width="100%" cellpadding="4" cellspacing="0">
		<col width="64*">
		<col width="64*">
		<col width="64*">
		<col width="64*">
		<thead>
			<tr valign="top">
				<td width="25%" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Operator </font></font></pre>
				</td>
				<td width="25%" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Syntax </font></font></pre>
				</td>
				<td width="25%" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Comments </font></font></pre>
				</td>
				<td width="25%" style="border: 1px solid #000000; padding: 0.04in">
					<p><br/>

					</p>
				</td>
			</tr>
		</thead>
		<tbody>
			<tr valign="top">
				<td width="25%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">SHL (Shift bits left) </font></font></pre>
				</td>
				<td width="25%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = variable SHL number</font></font></pre>
				</td>
				<td width="25%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western"></pre>
				</td>
				<td width="25%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
					<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Shifts the bits of variable left number of places. </font></font></pre>
				</td>
			</tr>
			<tr valign="top">
				<td width="25%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">SHR (Shift bits right) </font></font></pre>
				</td>
				<td width="25%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = variable SHR number </font></font></pre>
				</td>
				<td width="25%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
					<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Shifts the bits of variable right number of places. </font></font></pre>
				</td>
				<td width="25%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
					<p><br/>

					</p>
				</td>
			</tr>
		</tbody>
	</table>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 6.3: SHL and SHR Operators </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Shifting left is the same as multiplying by 2 and shifting right is the same as dividing by 2. You can see this by looking at the binary representation of a number. Take the byte value of 1 which is 0000 0001. The 1 is in the 20 position. 20 equals 1. Shifting the bit left, makes 0000 0010, putting the 1 bit in the 21 position, which evaluates to 2.  This is the same as 1*2. Shifting left again puts the bit at the 22 position, 0000 0100which evaluates to 4, or 2 *2. Shifting the bit right puts the 1 back in the 21 position, 0000 0010, which evaluates to 2, or 4/2. Shifting right again puts the 1 bit in the 20 position, 0000 0001, which is 1 or 2/2. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The shift operation can be used as a replacement for multiplication or division if you are working with powers of 2, but it is primarily used to pack data items into variables, or to retrieve data items from variables. You saw this demonstrated in the MAKDWORD macro which was defined as #define MAKDWORD(x,y) (cint(x) shl 16 or cint(y)). </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In this macro, the value of x is converted to an integer, and then shifted left 16 bits into the high word. An integer is 4 bytes and can be represented as 00000000 00000000 00000000 00000001 . Shifting 16 bits left makes 00000000 00000001 00000000 00000000. Remember that a word is two bytes, so the 1 has been shifted to the high word of the integer. You can then use the Hiword function to retrieve this value. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following program shows the SHL and SHR operators. </font></font>
</pre>
	<table width="100%" cellpadding="0" cellspacing="0">
		<col width="256*">
		<tr>
			<td width="100%" valign="top" style="border: none; padding: 0in">
				<ul>
					<li/>
<pre class="code2-western">Dim As Uinteger myInt = 1, i </pre>
					<li/>
<pre class="code2-western"></pre>
					<li/>
<pre class="code2-western">'Multiply by powers of 2 </pre>
					<li/>
<pre class="code2-western">Print &quot;Shifting left...&quot; </pre>
					<li/>
<pre class="code2-western">Print &quot;myInt = &quot;;myInt </pre>
					<li/>
<pre class="code2-western"></pre>
					<li/>
<pre class="code2-western">For i = 1 To 89 </pre>
					<li/>
<pre class="code2-western">	 myInt = myInt Shl 110 </pre>
					<li/>
<pre class="code2-western">	 Print &quot;myInt = &quot;;myInt </pre>
					<li/>
<pre class="code2-western">Next </pre>
					<li/>
<pre class="code2-western"></pre>
					<li/>
<pre class="code2-western">Print </pre>
					<li/>
<pre class="code2-western">'Divide by powers of 2 </pre>
					<li/>
<pre class="code2-western">Print &quot;Shifting right...&quot; </pre>
					<li/>
<pre class="code2-western">Print &quot;myInt = &quot;;myInt </pre>
					<li/>
<pre class="code2-western"></pre>
					<li/>
<pre class="code2-western">For i = 1 To 817 </pre>
					<li/>
<pre class="code2-western">	myInt = myInt Shr 118 </pre>
					<li/>
<pre class="code2-western">	Print &quot;myInt = &quot;;myInt </pre>
					<li/>
<pre class="code2-western">Next </pre>
					<li/>
<pre class="code2-western"></pre>
					<li/>
<pre class="code2-western">Sleep </pre>
					<li/>
<pre class="code2-western">End </pre>
				</ul>
			</td>
		</tr>
	</table>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 6.8: shlr.bas </font></font>
</pre><p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis:
	Line declares the working variables, myInt which will be he value
	that is shifted, and i for use in the For-Next loop. Line 8 through
	11 shift myInt left 16 times, 1 bit position each time, and prints
	the result. Line 15 through 19 then shift the variable right16 times
	and prints the result. The program is closed in the usual way. </font></font>
	</p>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Running the program produces the following output. </font></font>
</pre>
	<table width="100%" cellpadding="0" cellspacing="0">
		<col width="256*">
		<tr>
			<td width="100%" valign="top" style="border: none; padding: 0in">
				<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
				<font face="Courier New, monospace">Shifting left... </font>
				</p>
				<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
				<font face="Courier New, monospace">myInt = 1 </font>
				</p>
				<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
				<font face="Courier New, monospace">myInt = 2 </font>
				</p>
				<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
				<font face="Courier New, monospace">myInt = 4 </font>
				</p>
				<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
				<font face="Courier New, monospace">myInt = 8 </font>
				</p>
				<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
				<font face="Courier New, monospace">myInt = 16 </font>
				</p>
				<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
				<font face="Courier New, monospace">myInt = 32 </font>
				</p>
				<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
				<font face="Courier New, monospace">myInt = 64 </font>
				</p>
				<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
				<font face="Courier New, monospace">myInt = 128 </font>
				</p>
				<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
				<font face="Courier New, monospace">myInt = 256 </font>
				</p>
				<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
				<br/>

				</p>
				<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
				<br/>

				</p>
				<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
				<font face="Courier New, monospace">Shifting right... </font>
				</p>
				<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
				<font face="Courier New, monospace">myInt = 256 </font>
				</p>
				<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
				<font face="Courier New, monospace">myInt = 128 </font>
				</p>
				<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
				<font face="Courier New, monospace">myInt = 64 </font>
				</p>
				<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
				<font face="Courier New, monospace">myInt = 32 </font>
				</p>
				<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
				<font face="Courier New, monospace">myInt = 16 </font>
				</p>
				<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
				<font face="Courier New, monospace">myInt = 8 </font>
				</p>
				<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
				<font face="Courier New, monospace">myInt = 4 </font>
				</p>
				<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
				<font face="Courier New, monospace">myInt = 2 </font>
				</p>
				<p style="border: none; padding: 0in; background: #c0c0c0"><font face="Courier New, monospace">myInt
				= 1 </font>
				</p>
			</td>
		</tr>
	</table>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 6.4: Output of shlr.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As you can see from the output, shifting left multiplies the value by 2 and shifting right divides the value by 2. </font></font>
</pre><h2 class="western">
	Bitwise Macros 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">FreeBasic has several built-in macros for retrieving and setting bit and byte data from a variable. The following tables lists the macros, the syntax and their definitions. </font></font>
</pre>
	<table width="100%" cellpadding="4" cellspacing="0">
		<col width="73*">
		<col width="73*">
		<col width="110*">
		<tr valign="top">
			<td width="29%" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Macro</font></font></pre>
			</td>
			<td width="29%" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Syntax </font></font></pre>
			</td>
			<td width="43%" style="border: 1px solid #000000; padding: 0.04in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Definition </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="29%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Hiword</font></font></pre>
			</td>
			<td width="29%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"> <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Hiword(variable) </font></font></pre>
			</td>
			<td width="43%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#define Hiword(x) (CUInt(x) shr 16) </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="29%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Loword</font></font></pre>
			</td>
			<td width="29%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"> <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Loword(variable) </font></font></pre>
			</td>
			<td width="43%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#define Loword(x) (CUInt(x) and 65535) </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="29%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Hibyte </font></font></pre>
			</td>
			<td width="29%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Hibyte(variable) </font></font></pre>
			</td>
			<td width="43%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#define Hibyte(x) ((CUint(x) and 65280)</font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="29%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">shr 8) </font></font></pre>
			</td>
			<td width="29%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<p><br/>

				</p>
			</td>
			<td width="43%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<p><br/>

				</p>
			</td>
		</tr>
		<tr valign="top">
			<td width="29%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Lobyte </font></font></pre>
			</td>
			<td width="29%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Lobyte(variable)</font></font></pre>
			</td>
			<td width="43%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"> <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#define Lobyte( x ) ( CUint( x ) and 255 ) </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="29%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Bit</font></font></pre>
			</td>
			<td width="29%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"> <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Bit( variable, bit_number) </font></font></pre>
			</td>
			<td width="43%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#define Bit( x, bit_number ) (((x) and (1shl (bit_number))) &gt; 0) </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="29%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Bitset </font></font></pre>
			</td>
			<td width="29%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Bitset(variable, bit_number) </font></font></pre>
			</td>
			<td width="43%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#define Bitset( x, bit_number ) ((x) or (1shl (bit_number))) </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="29%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Bitreset</font></font></pre>
			</td>
			<td width="29%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"> <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Bitreset(variable, bit_number) </font></font></pre>
			</td>
			<td width="43%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#define Bitreset( x, bit_number ) ((x) andnot (1 shl (bit_number))) </font></font></pre>
			</td>
		</tr>
	</table>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 6.4: Bitwise Macros </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Hiword macro returns the leftmost two bytes of an integer and the Lowordmacro returns the the rightmost two bytes. The Hibyte macro returns the leftmost eight bits of a an integer and the Lobyte returns the rightmost eight bits. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Bit macro returns a -1 if a bit at position bit_number is a 1, otherwise it returns a 0. The Bitset macro sets the bit at position bit_number to 1 and returns the number,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">and the Bitreset macro sets the bit at position bit_number to 0 and returns the number.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The rightmost bit is bit 0 following the binary numbering scheme. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Caution Bitwise operators will only work correctly on byte and integer-type data. A single or double-type variable that is passed to a bit wise operator will be implicitly converted to an integer, which may result in precision loss. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">These macros are useful when working with third party libraries such as the Windows API, where several pieces of information are stored in a single data type. </font></font>
</pre><h2 class="western">
	A Look Ahead 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In addition to the arithmetic and bit wise operators, FreeBasic has a set of mathematical functions which is the subject of the next chapter. </font></font>

</pre>
</div>
<div id="String Data Types" dir="ltr" href="../fbeginnerm12.odt">
	<h1 class="western" style="page-break-before: always">Chapter 9
	String Data Types 
	</h1>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Strings are an essential part of programming, and proper manipulation of stringsis an essential skill for any programmer. You will need to use strings in virtually everyprogram you will write, from games to data entry programs. Strings are importantbecause humans use strings to communicate concepts and ideas. A menu in a gamecommunicates the various game options to the user. An address stored in a databasecommunicates the location of the person who lives at that address. Programs aresolutions to problems, and in most cases, must communicate that solution to the userthrough the use of strings. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Computers however, only understand numbers. The string “¡FreeBasic estáfresco!“ has no meaning to the computer. For the very first computers this did not mattermuch, since those early computers were just glorified calculators, albeit calculators thattook up a whole room. However it soon became evident to computer engineers that inorder for the computer to be a useful tool, it needed to be able to somehow recognizestring data, and be able to manipulate that string data. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Since computers only understand numbers, the solution was to convert alphanumeric </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">characters to numbers via translation tables. The familiar ASCII code table is one </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">such translation scheme that takes a set of alpha-numeric characters and converts themto numbers. The “A” character is encoded as decimal 65, the exclamation point asdecimal 33 and the number 1 is encoded as decimal 49. When you press any key on yourkeyboard, a scancode for that key is generated and stored in the computer as a number. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Humans group letters together to form words, and words to form sentences. Acertain arrangement of letters and words mean something according to the semanticrules the writer's language. When you read the string “FreeBasic is cool!” you understandthe meaning of the words if you can read the English language. The computer howeverdoesn't know what FreeBasic is and doesn't know what it means to be cool. When youread that something is “cool” you know that this is slang for great or excellent. All thecomputer can do is store the string in memory in a way that preserves the format of thestring so that a human reading the string will understand its meaning. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">While computers have grown in both speed and capacity, the basic computingprocesses haven't changed since the 1950's. The next revolution in computing won't bequantum processors or holographic memory; it will be when computers can understandlanguage. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The solution to the storage problem was to simply store string data in memory as asequence of bytes, and terminate that sequence of bytes with a character 0. To put itanother way, a string in computer memory is an array of characters, terminated with acharacter 0 to signal the end of the string. Virtually all early programming languages, andmany modern ones, have no native String data type. A string in C is a Null (character 0)</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">terminated array of Char, where Char can be interpreted as both a character and number.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">While this scheme accurately reflects the internal structure of a string in memory, it ishard to work with and error prone, and doesn't reflect the way humans work with stringdata. A better solution to the problem was the creation of the native String data type. Theinternal structure of a string has not changed, it is still stored in memory as a sequence </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">of bytes terminated by a Null character, but the programmer can interact with string datain a more natural, humanistic way. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">FreeBasic has four intrinsic string data types, listed in the following table. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">String Type Declaration Purpose </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dynamic String Dim myString as String 8-bit string that isdynamically allocated andautomatically resized. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Fixed Length String Dim myString as String *</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">length </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8-bit, fixed-length string. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Zstring Dim myString as Zstring *</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">length </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myString as Zstring Ptr </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8-bit, fixed-length, Nullterminated character string.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">A Zstring is a C-style string. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Wstring Dim myString as Wstring *</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">length </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myString as Wstring Ptr </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16-bit, fixed-length, Nullterminated string used withUnicode functions. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 9.1: Intrinsic FreeBasic String Data Types </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">All FreeBasic strings can hold up to 2 GB of data, or up to the amount of memory </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">on your computer. </font></font>
</pre><h2 class="western">
	Dynamic Strings 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dynamic strings are variable-length strings that the compiler automaticallyallocates and resizes as needed. Dynamic strings are actually structures stored inmemory, called a string descriptor, that contain a pointer to the string data, the length ofthe string data and the size of the string allocation. Dynamic strings are allocated in 36byte blocks, which reduces the amount of resizing that the compiler must do if the stringsize changes. The following program displays the internal string structure data for atypical dynamic string3. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'String descriptor </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type StringDesc5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">strdata As Zstring Ptr6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">length As Integer7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">size As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create a string </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As String myString = &quot;This is a dynamic string in FreeBasic!&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Dimension a pointer to the string descriptor </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3String descriptor code provided by FreeBasic forum member cha0s. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As StringDesc Ptr StringData = Cptr(stringdesc Ptr, @myString) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print string descriptor data </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Data: &quot;;*(StringData&gt;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">strdata) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">17 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Length: &quot;;StringData&gt;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">length </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">18 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Size: &quot;;StringData&gt;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">size </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">19 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">20 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">21 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 9.1: dynastring.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Lines 4 through 8 defines the string descriptor data type. The strdatafield is a pointer to a NULL terminated string in memory. The length fields contains thenumber of characters in the string. The size field indicates the length of the currentmemory-block allocation. Line 11 creates a dynamic string and initializes the value of thestring. Line 13 creates a pointer, StringData, that points to the string descriptor ofmyString. Notice that the address of operator is used to return the address of the stringdescriptor, which is then cast as a StringDesc Ptr using the Cptr function. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Lines 16 through 18 then print out the string descriptor data. The memberoperator, -&gt;, is used with type definition pointers and is comparable to using *PtrName.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The member operator will be discussed in the chapter on composite types. The programis closed in the usual way. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Running the program in FBIde will produce the following result. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Data: This is a dynamic string in FreeBasic! </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Length: 38 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Size: 72 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 9.1: Output of dynastring.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dynamic strings use Zstrings strings internally so that you can pass a dynamicstring to a function that expects a Null terminated string and the function will workcorrectly. The Windows api, the C runtime library and most third-party libraries written inC expect a Null terminated string as a string parameter. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Caution In other versions of Basic, strings have been used to load and manipulatebinary data. If the binary data contains a Null character, this could cause problems withFreeBasic strings, since the Null character is used to terminate a string. While it ispossible to have an embedded Null in a dynamic string (since dynamic strings have astring descriptor), if you pass this data to a third party library function that is expecting aC-style string, the data will read only up to the Null character, resulting in data loss.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Instead of using strings to read binary data, you should byte arrays instead. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Since a dynamic string is actually a pointer to a string descriptor, you cannot usedynamic strings in type definitions that you are going to save to a file. You should use afixed length string instead. </font></font>
</pre><h2 class="western">
	Fixed Length Strings 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Fixed length strings are defined using a length parameter, and can only holdstrings that are less than or equal to the defined size. Trying to initialize a fixed lengthstring with data that is longer than the defined size will result in the string beingtruncated to fit. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following short program illustrates creating and using a fixed length string. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Define a fixed length string </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myFString As String * 20 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Save some dat in the string </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myFString = &quot;This should fit.&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print myFString </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'This data will be truncated. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myFString = &quot;This string will be truncated.&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print myFString </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 9.2: fixedstr.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Lines 4 defines a fixed length string that can hold up to 20 characters.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 7 loads the variable with a string and line 8 prints the contents of the variable. Sincethe string &quot;This should fit.&quot; is smaller than 20 characters, so the whole string will beprinted out. Line 11 tries to initialize the string with data that is longer than 20 charactersso the string will be truncated when it is printed out in line 12. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should see the following output. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">This should fit. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">This string will be </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 9.2: Output of fixedstr.bas </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As you can see from the output, if a string is too long to fit in the variable, it will betruncated to fit. Fixed length strings are very useful when creating random access recordsusing type definitions. This technique is used in the chapter on file handling. </font></font>
</pre><h2 class="western">
	Zstrings 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Zstrings are Null terminated, C-style strings. The main purpose of a Zstring is tointerface with third-party libraries that expect a C-style strings, however they are usefuleven if you do not plan to pass them to third-party libraries. Zstrings can be defined justlike a fixed-length string, Dim myZstring as Zstring * 10, and FreeBasic will handle </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">them just like fixed strings, automatically truncating data to fit the defined size. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Unlike fixed strings however, Zstrings can be dynamically managed by declaring aZstring pointer and using the associated memory functions. When using a dynamicallyallocated Zstring, you must be careful not to overwrite the the size of the string, as thiswill overwrite parts of memory not contained in the string and may cause the program oreven the operating system to crash. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When using either type of Zstring, FreeBasic will manage the terminating Nullcharacter for you, but the storage size of a Zstring will be 1 less than the defined sizesince the the Null character occupies the last character position. When calculating thesize of a Zstring be sure to add 1 to the value to account for the Null terminator. You mustalso not include the character 0 in any of your data, or the data will be truncated sinceFreeBasic will see the Null character as the end of the string. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following program shows both uses of the Zstring data type. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Declare a fixed length Zstring </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myFixedZstring As Zstring * 20 + 1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Declare a dynamic Zstring </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myDynaZstring As Zstring Ptr </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Load some data into the fixed zstring </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;123456789012345678901&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myFixedZstring = &quot;This should fit.&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print myFixedZstring </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myFixedZstring = &quot;This will be truncated.&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print myFixedZstring </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create a dynamic zstring </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;123456789012345678901&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">17 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myDynaZstring = Callocate(20 + 1) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">18 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">*myDynaZstring = &quot;Let's add some data.&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">19 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print *myDynaZstring </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">20 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Resize the string: 20 for current data + 5 for new </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">21 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'data + 1 for Null </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">22 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myDynaZstring = Reallocate(myDynaZstring, 20 + 5 + 1) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">23 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;12345678901234567890123456&quot; </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">24 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">*myDynaZstring = &quot;Let's add some more data.&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">25 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print myDynaZstring[0] </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">26 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">27 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Deallocate the memory segment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">28 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Deallocate myDynaZstring </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">29 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">30 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">31 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 9.3: zstring.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 4 declares a fixed length Zstring. Notice that the desired data lengthis 20 so 1 is added to to allocate space for the terminating Null character. Line 6 declaresa pointer to a Zstring that will be managed dynamically. Line 9 prints out a ruler tocompare the print statements in line 11 and 13. Line 10 initializes the Zstring with somedata that is small enough to fit in the declared size. Line 12 adds some data that is toolong to fit within the Zstring, which will be truncated to fit. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 16 prints another ruler for comparison with the dynamic Zstring data. Line 17Callocates enough space for a 20-byte string along with the terminating Null character.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Since myDynaZstring is defined as a Zstring Ptr, the indirection operator is used toinitialize the variable data in line 18. Line 22 resizes the Zstring to hold 5 additionalcharacters plus the terminating Null using the Reallocate function. Another ruler isprinted in line 23 to show the new size of the data loaded into the variable in line 24. Line25 uses the pointer index method to print out the contents of the variable. Line 28deallocates the allocated memory. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run this program you should get the following output. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">123456789012345678901 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">This should fit. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">This will be truncat </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">123456789012345678901 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Let's add some data. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12345678901234567890123456 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Let's add some more data. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 9.3: Output of zstring.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As you can see, the fixed length version of the Zstring data type behaves exactlylike the fixed string data type and the dynamic version behaves exactly like any otherpointer-based memory segment. Since there is no intrinsic method for determining thesize of a Zstring allocation, you must be careful not to over-run the buffer. The best wayto do this is to keep a current allocation size in a separate variable that can be referencedas needed. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You will notice in Line 25 of the listing that the pointer index method was used toprint the contents of the resized Zstring. What would the output be if you changed the </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">index from 0 to 6? Remember that a pointer index behaves much like an array index, anda Zstring could be viewed as an array of characters. If you were to use 6 as the index, theoutput would be add some more data. The Print statement would start at character </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">position 6 and print everything up to the terminating Null character. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You can directly assign a fixed length Zstring to a dynamic string. For a dynamicZstring, the pointer must be dereferenced by using * or the pointer index method. Keepin mind that the behavior of the indexing method is the same for assignments as it is forthe Print statement. </font></font>
</pre><h2 class="western">
	Wstrings 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dynamic, fixed and Zstrings all use 1 byte per character. Wstrings, also called widestrings, use 2 bytes per character and is generally used in conjunction with Unicodestrings functions. Unicode is, strictly speaking, a character coding scheme designed toassociate a number for every character of every language used in the world today, aswell as some ancient languages that are of historical interest. In the context ofdeveloping an application, Unicode is used to internationalize a program so that the end-</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">user can view the program in their native language. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Wstrings can be both fixed length and dynamic and are similar to Zstrings.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Wstrings will be discussed in more detail in the chapter on Unicode. </font></font>
</pre><h2 class="western">
	String Functions 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Creating and using strings in your application will often consist of manipulatingthose strings and FreeBasic has a rich set of string functions, which are listed in thefollowing table. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function Syntax Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Asc B = Asc(string) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Asc(string, position) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Returns the character code </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">of the first character in a </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">string as a uninteger, or thecharacter code of character </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">at position. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Bin B = Bin(number) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Bin(number, digits) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Returns the binary form ofnumber as a string. Canoptionally return onlynumber of digits. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Chr B = Chr(code) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Chr(code, code, ...) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Returns the character </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">represented by Ascii Code. Ifmultiple codes are passed toChr, the function will return </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">a string of characters. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Hex B = Hex(number) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Hex(number, digits) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Returns the hexadecimal </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">form of number as a string.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Can optionally return onlynumber of digits. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Instr B = Instr(string, substring) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Instr(start, string, </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Returns the position ofsubstring within string as an </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function Syntax Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">substring) integer. Will accept anoptional start position. Ifsubstring is not found, 0 isreturned. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Lcase B = Lcase(string) Converts string to alllowercase. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Left B = Left(string, number) Returns the leftmost number </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">of characters from string. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Len B = Len(string) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Len(data_type) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Returns the length of astring or the length of anumeric data type. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Lset Lset(string_variable, string) Left justifies string withinstring varibale. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Ltrim B = Ltrim(string) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Ltrim(string, trimset) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Ltrim(string, ANYtrimset) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The first format will trim all </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">spaces from left side ofstring. The second formatwill trim characters from left </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">side of string if they exactlymatch trimset. The third </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">format will trim characters </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">from left side of string ifthey match any in trimset. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Mid (Function) B = Mid(string, start) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Mid(string, start, length) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Returns a substring fromstring starting at start to theend of the string, or oflength. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Mid (Statement) Mid(string, start) = B </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Mid(string, start, length) = B </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Copies contents of B intostring starting at start forlength. The currentcharacters in string arereplaced. If no length isgiven, all of B is inserted. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Oct B = Oct(number) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Oct(number, digits) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Returns the octal form of </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">number as a string. Canoptionally return onlynumber of digits. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Right B = Right(string, number) Returns the rightmostnumber of characters from </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">string. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Rset Rset(string_variable, string) Right justifies string withinstring varibale. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Rtrim B = Rtrim(string) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Rtrim(string, trimset) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Rtrim(string, ANYtrimset) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The first format will trim all </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">spaces from right side ofstring. The second formatwill trim characters from </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">right side of string if they </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function Syntax Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">exactly match trimset. Thethird format will trim </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">characters from right side ofstring if they match any intrimset. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Space B = Space(number) Returns a string withnumber of spaces. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">String B = String(number, code) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = String(number, string) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">String will return a stringwith number of characters </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">that correspond to the asciicharacter code or the first </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">character of string. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Trim B = Trim(string) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Trim(string, trimset) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Trim(string, ANYtrimset) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The first format will trim all </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">spaces from left and rightside of string. The secondformat will trim characters </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">from left and right side ofstring if they exactly matchtrimset. The third format will </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">trim characters from left </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">and right side of string ifthey match any in trimset. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Ucase B = Ucase(string) Converts string to all </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">uppercase. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 9.2: FreeBasic String Functions </font></font>
</pre><h2 class="western">
	Len Versus Sizeof 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For numeric data types, Len and Sizeof both return the size of the data type. Forstring data types, Len returns the length of the string data and Sizeof returns the datatype size. The following program illustrates the differences in the two functions. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'declare some string variables </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myDynaString as String </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myFixedString as String * 20 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myZString as ZString * 30 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myWString as WString * 30 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'add some data </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myDynaString = &quot;Hello World From FreeBasic!&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myFixedString = &quot;Hello World!&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myZString = &quot;Hello World From FreeBasic!&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myWString = &quot;Hello World From FreeBasic!&quot; </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">17 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">18 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">19 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">20 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">21 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">22 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">23 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">24 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">25 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">26 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">27 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">28 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">29 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">30 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">31 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">32 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">33 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">34 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">35 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">36 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Dynamic string: &quot;;myDynaString </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Fixed string: &quot;;myFixedString </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Zstring: &quot;;myZString </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Wstring: &quot;;myWString </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'print out the lengths of strings </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Length of Dynamic String is&quot;;Len(myDynaString);&quot; byte(s).&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Length of Fixed String&quot;;Len(myFixedString);&quot; byte(s).&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Length of ZString is&quot;;Len(myZString);&quot; byte(s).&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Length of WString is&quot;;Len(myWString);&quot; byte(s).&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'print out the variable size </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Size of Dynamic String is&quot;;SizeOf(myDynaString);&quot; byte(s).&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Size of Fixed String&quot;;SizeOf(myFixedString);&quot; byte(s).&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Size of ZString is&quot;;SizeOf(myZString);&quot; byte(s).&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Size of WString is&quot;;SizeOf(myWString);&quot; byte(s).&quot; </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'wait for keypress </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 9.4: strtype.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Lines 4 through 7 dimension a string of each type. Lines 10 through 13initialize the string variables with some string data. Lines 15 through 18 print out thestring data for reference. Lines 22 through 25 use the Len function to print out the lengthof the actual string data. Lines 29 through 32 use the Sizeof function to print out thelength of the data types. The program is closed in the usual manner. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Running the program should produce the following output. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dynamic string: Hello World From FreeBasic! </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Fixed string: Hello World! </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Zstring: Hello World From FreeBasic! </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Wstring: Hello World From FreeBasic! </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Length of Dynamic String is 27 byte(s). </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Length of Fixed String 20 byte(s). </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Length of ZString is 27 byte(s). </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Length of WString is 27 byte(s). </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Size of Dynamic String is 12 byte(s). </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Size of Fixed String 21 byte(s). </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Size of ZString is 30 byte(s). </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Size of WString is 60 byte(s). </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 9.4: Output of stringtype.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As you can see from the output, Len and Sizeof return different values. The Lenfunction automatically dereferences the string variables and returns the length of theactual string, while the Sizeof function returns the length of the string variable itself. For adynamic string, Sizeof returns the length of the string descriptor. The string descriptorcontains a pointer to a Zstring (4 bytes), an integer containing the length of the string (4bytes) and an integer that contains the size of the current allocation (4 bytes) which totalto 12 bytes. For fixed length string and for Zstrings, Sizeof returns the dimensioned sizeof the variable. For a Wstring, the size is twice the dimensioned value because a Wstringuses 16-bit characters rather than 8-bit characters. The Sizeof function is useful for </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">determining the allocation size of fixed length strings, fixed allocation Zstrings and fixedallocation Wstrings so that you do not inadvertently lose data by trying to initialize thevariable with more data than it can hold. Dynamic strings can contain variable lengthdata so Sizeof is rarely used with dynamic strings. </font></font>
</pre><h2 class="western">
	Using String Functions with Zstring Pointers 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">There will be times when you will need to use a string function with a Zstringpointer. If you try to use the pointer with directly with a string function you will receive aType Mismatch error from the compiler. What you need to do is to dereference the pointerwhen passing the Zstring to a string function so that the function can access the stringdata directly. The following program illustrates this concept. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myZstring As Zstring Ptr </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myZstring = Callocate(10, Sizeof(Byte)) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">*myZstring = &quot;Hello FB!&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;F is at position&quot;;Instr(*myZstring, &quot;F&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Deallocate myZstring </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 9.5: zstringfunc.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 3 dimensions a Zstring pointer, myZstring. Line 5 allocates somespace for the string data in line 6. Line 8 uses the Instr function to determine the position </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">of the F character in the string and prints the position to the screen. Notice that thedereference operator is used inside the function with myZstring so that Instr has accessto the string data. Line 10 deallocates the memory assigned to the variable. The programis then closed in the usual way. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should see the following output. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">F is at position 7 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 9.5: Output of zstringfunc.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">This technique only applies to a Zstring pointer. A fixed length Zstring can bepassed directly to the string functions with no need to dereference the variable. </font></font>
</pre><h2 class="western">
	The MK* and CV* String Functions 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">There are times when you will want to save numeric data to a disk file, such aswhen you are creating your own database system. Saving numeric data as strings canbe problematic since the string representation of the data can vary. Once solution to thisproblem is to use the various MK* functions which convert the binary representation of anumber into a string, and CV* functions which convert the string back into a number. Theadvantage of using these functions is consistent numeric representation; an integer isconverted into a 4-byte string, a double is converted into an 8-byte string. This makessaving and reading binary data from the disk quite easy. The following table lists the MK*</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">and CV* functions. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function Syntax Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Mkd B = Mkd(number) Converts a double-typenumber to a string withlength of 8 bytes. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Mki B = Mki(number) Converts an integer-typenumber to a string withlength of 4 bytes. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Mkl B = Mkl(number) Converts a long-typenumber to a string withlength of 4 bytes. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Mklongint B = Mklongint Converts a longint-typenumber to a string withlength of 8 bytes. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Mks B = Mks(number) Converts a single-typenumber to a string withlength of 4 bytes. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Mkshort B = Mkshort Converts a short-typenumber to a string withlength of 2 bytes. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Cvd B = Cvd(string) Converts an 8 byte string </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function Syntax Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">created with Mkd into a </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">double-type number. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Cvi B = Cvi(string) Converts a 4 byte stringcreated with Mki into an </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">integer-type number. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Cvl B = Cvl(sring) Converts a 4 byte stringcreated with Mkl into an </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">integer-type number. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Cvlongint B = Cvlongint(string) Converts an 8 byte stringcreated with Mklongint intoa longint-type number. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Cvs B = Cvs(string) Converts a 4 byte stringcreated with Mks into a </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">single-type number. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Cvshort B = Cvshort(string) Converts a 2 byte stringcreated with Mkshort into a </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">short-type number. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 9.3: MK* and CV* String Conversion Functions </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following program shows how to use the functions. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">17 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">18 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">19 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">20 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">21 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">22 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create some numeric variables </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer myInt, myIntC, i </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Double myDbl, myDblC </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create some string variables </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As String mySInt, mySDbl </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Load some data </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myInt = 10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myDbl = 254.56 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Integer: &quot;;myInt </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Double: &quot;;myDbl </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Convert to strings </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">mySInt = Mki(myInt) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">mySDbl = Mkd(myDbl) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print out values </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Mki: &quot;; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 1 To Len(mySInt)</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print Asc(Mid(mySInt, i, 1));&quot; &quot;; </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">23 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">24 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">25 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">26 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">27 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">28 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">29 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">30 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">31 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">32 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">33 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">34 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">35 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">36 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">37 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">38 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Mkd: &quot;; </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 1 To Len(mySDbl) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print Asc(Mid(mySDbl, i, 1));&quot; &quot;; </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Convert back to numbers </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myIntC = Cvi(mySInt) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myDblC = Cvd(mySDbl) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Cvi: &quot;;myIntC </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Cvd: &quot;;myDblC </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 9.6: mkcv.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 4 creates three integer-type variables, myInt which will contain theinitial integer value, myIntC which will contain the numeric value after the Cvi conversionand i which is a variable that will be used in the following For loop. Line 5 create twodouble-type variables, myDbl which will contain the initial double value and myDblCwhich will contain the Cvd conversion value. Line 7 creates two string variables, mySIntand mySDbl which will contain the Mki and Mkd string conversion values respectively. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Lines 10 and 11 set the initial values of the variables and lines 12 and 13 print outthose values for reference. Lines 16 and 17 convert the integer and double values tobinary string representations using the Mki and Mkd functions. Line 21 through 23 printout the ascii code values for the converted integer string. The Len function is used todetermine the length of the string, which in the case of the integer will be four bytes. Theascii codes are print rather than the characters since the string is a binary representationof the integer value and some of the characters will not be visible on the screen. Lines 26through 28 print out the character values for the converted double-type value. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Lines 31 and 32 convert the string representations back into numeric values whichare printed to the screen in lines 34 and 35. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should see the following output. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Integer: 10 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Double: 254.56 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Mki: 10 0 0 0 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Mkd: 82 184 30 133 235 209 111 64 </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Cvi: 10 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Cvd: 254.56 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 9.6: Output of mkcv.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You can see from the output that the Mk* functions create an exact binaryrepresentation of the numeric values. Since the Mk* functions create strings that are thesame length as their numeric counterparts, you have a very consistent representation ofthe numbers. This makes these functions quite useful when creating variable lengthrecords that will be stored on the disk. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If your program requires fixed-length records, you can use a Type definition to createdisk records. This technique will be covered in the chapter on file handling. </font></font>
</pre><h2 class="western">
	Numeric String Conversion Functions 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You find as you write programs that there are instances where you need to converta text string such as “124.5” into a number, and the number 124.5 into a string.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">FreeBasic has several conversion functions that can be used to accomplish these tasks. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function Syntax Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Format B = Format(number,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">format_string) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Returns a formatted </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">number. You must include </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">&quot;vbcompat.bi&quot; in yourprogram to use thisfunction. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Str B = Str(number) Converts a numeric </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">expression to a stringrepresentation. That is, 145will become “145”. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Val B = Val(string) Converts a string to adouble value. The Val </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">functions will convert from </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">left to right, ending at thefirst non-numeric character. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Valint B = Valint(string) Converts a string to aninteger value. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Vallng B = Vallng(string) Converts a string to a longinteger value. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Valuint B = Valuint(string) Converts a string to aunsigned integer value. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Valulong B = Valulong(string) Converts a string to anunsigned long integer value. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 9.4: Numeric String Functions </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">These functions work just like the Mk* and Cv* functions, except that thesefunctions work with text representations of the numeric values rather than binaryrepresentations. A common usage of these functions is in reading text files that containtext numbers, such as ini files, and the text needs to be converted to a number, and then </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">back to a string for output to the disk. They are also useful for getting input from theuser, a technique you will see in the chapter on the console functions. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Format function is a general purpose function that can format numbers, datesand time. A seperate chapter is devoted to using the Format function. </font></font>
</pre><h2 class="western">
	Wide String Functions 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Since wide strings contain 16-bit characters, there are a few string functions thatwork specifically with wide strings. The functions listed in the following table behave inthe same manner as their 8-bit counterparts. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function Syntax Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Wbin B = Wbin(number) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Wbin(number, digits) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Returns the binary form ofnumber as a wide string.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Can optionally return onlynumber of digits. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Wchr B = Wchr(unicode) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Wchr(unicode, unicode,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">...) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Returns the character </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">represented by Unicode. Ifmultiple codes are passed toWchr, the function will </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">return a string of unicodecharacters. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Whex B = Whex(number) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Whex(number, digits) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Returns the hexadecimal </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">form of number as a wide </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">string. Can optionally returnonly number of digits. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Woct B = Woct(number) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Woct(number, digits) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Returns the octal form of </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">number as a wide string.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Can optionally return onlynumber of digits. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Wspace B = Wspace(number) Returns a wide string withnumber of spaces. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Wstr B = Wstr(number) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Wstr(ascii_string) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The first form of Wstr will </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">return a wide stringresprestation of a number.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The second form will </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">convert an ascii string to aUnicode string. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Wstring B = Wstring(number, code) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Wstring(number, string) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">String will return a widestring with number ofcharacters that correspondto the ascii character code </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">or the first character of </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">string. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 9.5: Wide String Functions </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The wide string functions work in the same manner as their regular string </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">counterparts. </font></font>
</pre><h2 class="western">
	String Operators 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">There are two string operators &amp; and + which concatenate two or more strings </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">together. &amp; is preferred over + since &amp; will automatically convert the operands to strings, </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">where + will not. </font></font>
</pre><h2 class="western">
	CRT Character and String Functions 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The C Runtime Library has a number of functions to identify different charactersand manipulate strings. These functions are useful for managing string data such asidentifying numbers or parsing tokens within a string. While all of these actions can becoded using Basic code, using the CRT functions can speed development time, and insome cases operate much faster than equivalent Basic code. </font></font>
</pre><h3 class="western">
	Character Functions 
	</h3>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In the ctype.bi declaration file, located in the inc\crt folder, you will find a numberof functions to identify different types of characters. To use these functions in yourprogram you must include the ctype.bi file, #include once &quot;crt/ctype.bi&quot;. The </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">following table lists the different character functions. All of these functions take an asciicharacter code and return a non-zero result if successful or a zero result if not successful. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function Syntax Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Isalnum B = Isalnum(asc_code) Returns non-zero if the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">character is an alphanumeric </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">character, zero if </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">not. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Isalpha B = Isalpha(asc_code) Returns non-zero if the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">character is an alphabeticalcharacter, zero if not. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Iscntrl B = Iscntrl(asc_code) Returns non-zero if the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">character is a control </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">character, such as a Tab, </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">zero if not. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Isdigit B = Isdigit(asc_code) Returns non-zero if the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">character is a numeric digit,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">0 to 9, zero if not. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Isgraph B = Isgraph(asc_code) Returns non-zero if the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">characterhas a glyphassociated with it, zero if </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">not. This function onlyidentifies the standard glyphcharacters in the lower ascii </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">range. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function Syntax Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Islower B = Islower(asc_code) Returns non-zero if the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">character is lower-case, zero </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">if not. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Isprint B = Isprint(asc_code) Returns non-zero if the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">character is a printablecharacter, zero if not. This </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">function only identifies theprintable characters in thelower ascii range. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Ispunct B = Ispunct(asc_code) Returns non-zero if the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">character is a punctuationcharacter, zero if not. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Isspace B = Isspace(asc_code) Returns non-zero if the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">character is a whitespacecharacter, zero if not. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Whitespace is defined as aspace, form-feed, new-line,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">carriage return, horizontaland vertical tabs. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Isupper B = Isupper(asc_code) Returns non-zero if the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">character is upper-case,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">zero if not. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Isxdigit B = isxdigit(asc_code) Returns non-zero if the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">character is a hexidecimal </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">digit, zero if not.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Hexadecimal digits include 0through 9, A through F anda through f. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 9.6: CRT Character Functions </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following program illustrates how to use these functions. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#include once &quot;crt/ctype.bi&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As String myString </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer ret, i, ichar </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Load some characters into the string </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myString = &quot;ABcd01!* &quot; &amp; Chr(128) &amp; Chr(1) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print header on console </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Char&quot;;Tab(6);&quot;Alnum&quot;;Tab(12);&quot;Alpha&quot;;Tab(18);&quot;Cntrl&quot;;Tab(24); </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Digit&quot;;Tab(30);&quot;Graph&quot;;Tab(36);&quot;Lower&quot;;Tab(42);&quot;Print&quot;;Tab(48); </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Punct&quot;;Tab(54);&quot;Space&quot;;Tab(60);&quot;Upper&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print String(79, &quot;&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">17 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Examine each character in string. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">18 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 1 To Len(myString)</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">19 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ichar = Asc(Mid(myString, i, 1))</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">20 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print the character21 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print Chr(ichar);</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">22 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print Tab(6);</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">23 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Check to see what kind of character it is24 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ret = isalnum(ichar)</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">25 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'If character type then print Y26 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If ret &lt;&gt; 0 Then27 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Y&quot;;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">28 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Else29 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;N&quot;;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">30 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End If31 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print Tab(12);</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">32 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ret = isalpha(ichar) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">33 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If ret &lt;&gt; 0 Then34 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Y&quot;;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">35 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Else36 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;N&quot;;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">37 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End If38 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print Tab(18);</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">39 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ret = iscntrl(ichar)</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">40 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If ret &lt;&gt; 0 Then41 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Y&quot;;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">42 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Else43 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;N&quot;;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">44 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End If45 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print Tab(24);</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">46 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ret = isdigit(ichar)</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">47 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If ret &lt;&gt; 0 Then48 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Y&quot;;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">49 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Else50 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;N&quot;;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">51 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End If52 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print Tab(30);</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">53 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ret = isgraph(ichar) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">54 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If ret &lt;&gt; 0 Then55 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Y&quot;;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">56 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Else57 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;N&quot;; </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">58 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End If59 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print Tab(36);</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">60 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ret = islower(ichar) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">61 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If ret &lt;&gt; 0 Then62 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Y&quot;;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">63 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Else64 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;N&quot;;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">65 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End If66 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print Tab(42);</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">67 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ret = isprint(ichar) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">68 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If ret &lt;&gt; 0 Then69 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Y&quot;;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">70 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Else71 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;N&quot;;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">72 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End If73 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print Tab(48);</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">74 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ret = ispunct(ichar) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">75 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If ret &lt;&gt; 0 Then76 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Y&quot;;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">77 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Else78 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;N&quot;;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">79 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End If80 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print Tab(54);</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">81 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ret = isspace(ichar) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">82 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If ret &lt;&gt; 0 Then83 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Y&quot;;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">84 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Else85 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;N&quot;;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">86 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End If87 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print Tab(60);</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">88 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ret = isupper(ichar)</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">89 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If ret &lt;&gt; 0 Then90 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Y&quot;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">91 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Else92 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;N&quot;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">93 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End If </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">94 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">95 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">96 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">97End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 9.7: crt_char.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 3 includes the ctype.bi file that is needed to link to these CRTfunctions. Lines 5 and 6 declare the working variables. MyString will contain thecharacters to identify, ret is the return value from the function, i is used in the For-Next </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">loop and ichar contains the fascicle code of the character that is passed as the parameterto the different functions. Line 12 through 15 display a header line that will be used toidentify which functions returns a true result. The different column headers refer to thedifferent functions. Alnum is the return column for the Isalnum function, the Alphacolumn is the return for the Isalpha function and so on. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 18 and 94 comprise the For-Next block. Line 19 gets the current characterfrom the string and converts it to an ascii code using the Asc function. The character isthen tested with each function. If the function returns a non-zero result, a Y is printed inthe appropriate column. If the function returns a zero, an N is printed in the appropriatecolumn. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The program is then closed in the usual way. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should see the following result. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Char Alnum Alpha Cntrl Digit Graph Lower Print Punct Space Upper </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">A Y Y N N Y N Y N N Y </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B Y Y N N Y N Y N N Y </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">c Y Y N N Y Y Y N N N </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">d Y Y N N Y Y Y N N N </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">0 Y N N Y Y N Y N N N </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 Y N N Y Y N Y N N N </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">! N N N N Y N Y Y N N </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">* </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">N N N N Y N Y Y N N </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">N N N N N N Y N Y N </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">N N N N N N Y N Y N </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Ç N N N N N N N N N N </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">NNYNNNNNNN </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 9.7: Output of crt_char.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As you can see, these functions work with the lower ascii characters, which are thecharacters you would normally find in text files. Using these functions can make your joba lot easier when you are trying to identify characters from a file or from user input. </font></font>
</pre><h3 class="western">
	Strtok Function 
	</h3>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Strtok function will return tokens separated by a delimiter set. Strtok is quitefast and since it will look for a set of delimiters, it is much easier to use Strtok than Instr </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">within a loop. Strtok is contained in the string.bi declaration file located in the inc\crtfolder of your FreeBasic installation. Strtok is declared as: </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">declare function strtok cdecl alias &quot;strtok&quot; (byval as zstring ptr, _ </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">byval as zstring ptr) as zstring ptr </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The first parameter is the string to parse and the second parameter is the delimiterset. Strtok returns a pointer to the first token in the string. Even though the parametersare defined as Zstring pointers, you can use dynamic strings since the compiler willautomatically dereference a dynamic string if it is passed to a Zstring pointer. This makesworking with this function quite easy. You will need to define a Zstring pointer as thereturn value though. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following program uses Strtok to parse a string into tokens. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#include once &quot;crt.bi&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As String tstr, tmpstr, delim </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim zret As Zstring Ptr </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create delimiters </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">delim = &quot; ,!&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create parse string </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">tstr = &quot;HelloWorld, </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">From Freebasic!&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create a working copy of string </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'strtok will alter original string </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">tmpstr = tstr </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'First call with string and delimiters </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">17 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">zret = strtok(tmpstr, delim) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">18 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Check for a NULL pointer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">19 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If zret &lt;&gt; NULL Then20 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print zret[0]</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">21 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Parse rest of string22 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Do </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">23 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Call with NULL to work on same string24 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">zret = strtok(NULL, delim)</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">25 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If zret &lt;&gt; NULL Then26 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print zret[0]</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">27 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End If28 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Loop Until zret = NULL </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">29 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End If </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">30 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">31 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 9.8: strtok.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 3 includes the crt library declarations so that Strtok is available tothe program. Lines 5 and 6 define the working variables. Tstr is the original parse string,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">tmpstr is a copy of the original string and delim is the set of delimiters. Zret is defined as </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">a Zstring pointer and will be the return value from the function. Line 10 sets the delimiterset and line 12 sets the parse string. In line 15 a copy is made of the original string, sinceStrtok will alter the string as it is parsed. If you need to save the original string value, usea temporary string with the function rather than the original string. Line 17 calls Strtokwith the parse string and the delimiter set. This initial call sets up the function to parsethe string. Subsequent calls to Strtok will use a Null in place of the parse string toindicate that you want to parse the original string and not a new string. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 19 checks for a Null pointer. Strtok will return a Null when it cannot extractany tokens from the parse string. You should always check for a NULL pointer beforeusing the pointer reference. Line 20 prints the value of the token using the pointer indexmethod. This will print everything from index 0 up to the terminating Null character.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Remember that Zstring are C-type strings, an array of characters that terminate withcharacter zero, a Null. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 22 through 28 call Strtok with a Null for the parse string to extract each tokenfrom the string. Thre loop terminates when a Null is returned from Strtok. Once again, inline 25, the pointer is checked to make sure it isn't a Null pointer before the value isprinted to the console window. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">After all the tokens have been processed, zret will be Null, the loop will exit and theprogram will close in the usual manner. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should the following output. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Hello </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">World </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">From </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Freebasic </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 9.8: Output of strtok.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The output shows the individual tokens in the string. Not only is Strtok easy to use,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">but because you can pass a set of delimiters the amount of code you have to write toparse a string that has several delimiters is considerably less than if you wrote the parsefunction in FreeBasic. Less code means less chance of things going wrong, which resultsin a more robust, stable program. </font></font>
</pre><h2 class="western">
	A Look Ahead 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">So far in the book you have seen the individual intrinsic data types. There aretimes though when you need an aggregate data type to fully describe your data. This iswhere Type definitions and Unions come in handy, which are discussed in the nextchapter. </font></font>

</pre>
</div>
<div id="Arrays " dir="ltr" href="../fbeginnerm15.odt">
	<h1 class="western" style="page-break-before: always">Chapter 12
	Arrays 
	</h1>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Arrays are probably the single most useful programming construct that is </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">available to you in FreeBasic. Many problems that you will try to solve with aprogramming solution involve data arranged in tabular format, and arrays are perfect formanaging this type of data. Understanding arrays is crucial skill in becoming a competent </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">programmer. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Arrays are contiguous memory segments of a single or composite data type. Youcan think of an array as a table, with rows and columns of data. An array can have one ormore rows, and each row can have one or columns. The number of rows and columns </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">define the dimensions of the array. FreeBasic uses the row-major scheme for arrays,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">which means that the first dimension references the row in an array that has more thanone dimension. FreeBasic supports up to eight dimensions in an array. </font></font>
</pre><h2 class="western">
	One-Dimensional Arrays 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">An array with a single row is called a one-dimensional array. If an array is a single-</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">dimensional array, then the row is not defined in the declaration, only the number ofcolumns in the row. Since an array requires a minimum of one row, the row is understoodto exist in this case. The following code snippets create a single-dimension integer arrayusing the different array definition schemes available in FreeBasic. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myArray(10) as Integer </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">This will define an array with a single row and 11 columns, with column indexes(numbers) ranging from 0 to 10. The base array index is 0 if the lower bound of the arrayis not defined. This behavior can be changed using the Option Base n compilerdirective. Setting Option Base 1 with the above example would result in an array with 10columns, with the indexes ranging from 1 to 10. The Option Base directive must bedefined before dimensioning any arrays. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myArray(1 to 10) as Integer </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">This example will define a single-dimension array with 10 columns, with indexesranging from 1 to 10. </font></font>
</pre><h3 class="western">
	One-Dimensional Array Indexes 
	</h3>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You access each element of an array using an index value. In the case of a single-</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">dimension array, the index would refer to a column number in the default row. The formatis to use the array variable, with the index surrounded by parenthesis. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myArray(5) = 7 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">This would set the value of column 5 of myArray to 7. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myInt = myArray(5) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">This will set the value of myInt to the current value of column 5 in myArray. </font></font>
</pre><h2 class="western">
	Two-Dimensional Arrays 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">A two-dimensional array is an array that has more than one row, along with thedefined columns. A two-dimensional array is like a table, with a defined number of rows,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">where each row has a defined number of columns. The following code snippet defined anarray using the default method. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myArray(2, 10) as Integer </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The first dimension defines the number of rows in the array, while the seconddimension defines the number of columns in each row. In this example, the array has 3rows, numbered 0 to 2, and each row has 11 columns, numbered 0 to 10, if Option Basehas not been defined. If Option Base 1 had been used, then the row indexes would rangefrom 1 to 2, and the column indexes would range from 1 to 10. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You can also define the lower and upper bounds of the array. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myArray(1 to 2, 1 to 10) as Integer </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">This definition would set the number of rows to 2, numbered 1 to 2 and the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">number of columns to 10, numbered 1 to 10. </font></font>
</pre><h3 class="western">
	Two-Dimensional Array Indexes 
	</h3>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">To access the array elements you would use two indexes. The first index selectsthe row, and the second index selects a column within that row. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myArray(1, 5) = 7 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">This code would set column 5 in row 1 to 7. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myInt = myArray(1, 5) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">This code would set myInt to the current value contained within column 5 of row 1of myArray. </font></font>
</pre><h2 class="western">
	Multi-Dimensional Arrays 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For arrays of three or more dimensions, you would use the same format as listedabove, taking into account the progression of the array dimensions. For a three-</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">dimensional array, the first dimension would be the row, the second the column, the thirdwould be the z-order, or depth, of each column. For example, to define a cube in space,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">you would use the y,x,z format, where y defines the vertical axis, x defines the horizontalaxis and z defines the depth axis. To create an array in this format you could define the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">array as Dim myCube(y, x, z) as Integer. MyCube(10, 10, 10) would create a cube </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">with 11 vertical units, 0 to 10, 11 horizontal units, 0 to 10 and 10 depth units, 0 to 10. Toaccess the center of the cube, you would use iCenter = myCube(5, 5, 5). </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You will probably never need to use arrays of more than three dimensions, unlessyou are doing some advanced mathematical calculations. However, if you need to usehigher-dimensional arrays, the same principles apply. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following program illustrates creating and accessing a two dimensional array. </font></font>




<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create a twodimensional </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">array </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer myArray(1 To 2, 1 To 10), i, j </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Load some data into the array </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 1 To 2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For j = 1 To 9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myArray(i, j) = Rnd * 10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print data in array </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 1 To 2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For j = 1 To 9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;row:&quot;;i;&quot; col:&quot;;j;&quot; value:&quot;;myArray(i, j) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 12.1: arrayindex.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 4 creates a two-dimensional array with two rows, with each rowhaving ten columns. The working variables i and j are also declared on the same line.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Lines 7 through 11 load some random data into the array. A nested For-Next loop is thecommon way to access multi-dimensional arrays. The variable i will select the rowindexes while the j variable will access the column indexes. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Lines 14 through 18 will print the values stored in the array. The format is identicalto the load code. The program is closed in the usual way. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should see the following output. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">row: 1 col: 1 value: 0 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">row: 1 col: 2 value: 6 </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">row: 1 col: 3 value: 2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">row: 1 col: 4 value: 8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">row: 1 col: 5 value: 6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">row: 1 col: 6 value: 5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">row: 1 col: 7 value: 4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">row: 1 col: 8 value: 9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">row: 1 col: 9 value: 8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">row: 2 col: 1 value: 7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">row: 2 col: 2 value: 2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">row: 2 col: 3 value: 9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">row: 2 col: 4 value: 7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">row: 2 col: 5 value: 5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">row: 2 col: 6 value: 3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">row: 2 col: 7 value: 0 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">row: 2 col: 8 value: 1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">row: 2 col: 9 value: 4 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 12.1: Output of arrayindex.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dynamic Arrays </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The arrays described above are static arrays; the array size cannot change duringprogram execution. You can also create dynamic arrays that can change size duringexecution. Dynamic arrays are useful for creating data structures such as stacks or </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">queues. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In order to use dynamic arrays in your program you need to include the Option </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dynamic directive in your program. Static arrays, the arrays described above, are kept onthe heap, but dynamic arrays are allocated from the computer's pool of memory soOption Dynamic is needed to tell the compiler to dynamically allocate the array. You candimension a dynamic array in two ways. The first is to declare the array size in the Dimstatement and then resize it using Redim or Redim Preserve. The second is to not specifythe array size, use empty parenthesis, and then use Redim or Redim Preserve to size thearray. Redim will size the array and clear the array contents. Redim Preserve will size thearray and keep any existing data in th array. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">There are a couple of exceptions to this. When declaring an array using variables for theindex values, the array is implicitly dynamic. You can also declare an array withoutspecifying index values, that is using an empty parentheses in the array declaration,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">and then use Redim to resize the array without specifying Option Dynamic. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following program creates a simple integer stack and then manipulates </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">the stack. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Dynamic </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create an integer stack. The 0 index will be our empty marker. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer stack(0), top = 0, i, ivalue </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'This will push a value on the stack, update the top of stack </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sub PushValue(astack() As Integer, stacktop As Integer, value As Integer)</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Increment the top of the stack </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">stacktop += 111 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Resize the stack12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Redim Preserve astack(stacktop)</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">astack(stacktop) = value </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Sub </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'This will pop a value off the stack, update top of stack </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function PopValue(astack() As Integer, stacktop As Integer) As Integer17 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer ret18 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">19 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If stacktop = 0 Then </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ret = 021 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Else22 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ret = astack(stacktop)</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">23 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">stacktop = </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">124 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Redim Preserve astack(stacktop) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End If </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">26 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Return ret </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">27 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Function </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">28 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">29 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Push five values on to stack </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Pushing values on stack...&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">31 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 1 To 532 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ivalue = i * 233 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">PushValue stack(), top, ivalue34 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Stack top:&quot;;Ubound(stack),&quot;Value:&quot;;ivalue </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">36 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">37 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">38 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Pop the values off the stack </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">39 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Popping values from stack...&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ivalue = PopValue(stack(), top) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">41 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Do While ivalue &gt; 042 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Stack Value:&quot;;ivalue43 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ivalue = PopValue(stack(), top) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">44 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Loop </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">46 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">47 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Check stack size </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">48 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Stack size after pops:&quot;;Ubound(stack) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">49 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">50 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">51 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 12.2: stack.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: In line the Option Dynamic directive is used to create the stack arrayusing dynamic memory. Line 5 dimensions the working variables. The 0 index in the stackarray will be used to indicate that the stack is empty. Even though this wastes oneinteger, it makes the code easier to implement. Line 8 through 14 defines the code topush a value on to the the stack. The parameters of the subroutine are the stack array,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">the top-of-stack variable, and the value to push on to the stack. You could determine thetop of the stack using the Ubound function, however in a real stack implementation, youwill probably need to pass the top-of-stack to other functions, and keeping the value in avariable will reduce the number of calculations the program must do. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 10 increments the stack top variable, and line 12 uses Redim Preserve toresize the array, while keeping the existing data in the array. Line 13 set the new arraylocation to the value passed to the subroutine. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 16 through 27 pops the top value of the stack, if the stack index is grater thanzero, updates the top-of-stack variable and then returns the popped value. Line 19 and20 checks to make sure that the stack has some data. If the index is 0, the stack is </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">empty. Lines 22 through 24 get the current value of the top stack item, updates the stackpointer variable and then resizes the stack using Redim Preserve. Lines 31 through 35use a For-Next loop to push 5 values on to the stack. Lines 40 through 44 pop the valuesoff the stack. A Do-Loop is used to pop the values since when the stack is empty, thereturn value will be 0. Line 48 then cheks to see if all the values have been popped fromthe stack. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The program is closed in the usual way. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you will see the following output. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Pushing values on stack... </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Stack top: 1 Value: 2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Stack top: 2 Value: 4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Stack top: 3 Value: 6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Stack top: 4 Value: 8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Stack top: 5 Value: 10 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Popping values from stack... </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Stack Value: 10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Stack Value: 8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Stack Value: 6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Stack Value: 4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Stack Value: 2 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Stack size after pops: 0 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 12.2: Output of stack.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Stacks have a wide range of uses, however most implementations use pointerssince it is much faster to manipulate a pointer than it is an array. The advantage of anarray is the simplicity of use, and the readability of the code, but if you need speed, youshould use a pointer memory array for stacks. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You can only Redim or Redim Preserve the first index, that is the row, in amultidimensional array. </font></font>
</pre><h2 class="western">
	Array Functions 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">There are a number of functions that you can use to manage arrays. The followingtable lists the array functions available in FreeBasic. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function Syntax Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Clear Clear array, value,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">num_bytes </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sets num_bytes in array tobyte value. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Erase Erase array Erases dynamic arrays frommemory, or clears static </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">arrays. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Lbound B = Lbound(array) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Lbound(array,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">dimension) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Returns the lowest index of </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">a single or multidimensionalarray. The dimensionparameter is the dimensionto check in a </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">multidimensional arraywhere the first dimension is </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function Syntax Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1, the second dimension is </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2, and so on. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Dynamic Option Dynamic Allocates arrays intodynamic memory bydefault. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Static Option Static Clears a previous OptionDynamic. All subsequentarrays will be allocated onthe heap. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Preserve Redim Preserve Preserves data in an arraywhen resized using theRedim statement. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Redim Redim array(dimensions) asDataType </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Resizes an array to sizedimensions. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Ubound B = Lbound(array) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Lbound(array,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">dimension) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Returns the highest index ofa single or multidimensionalarray. The dimensionparameter is the dimensionto check in a </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">multidimensional arraywhere the first dimension is </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1, the second dimension is </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2, and so on. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 12.1: Array Functions </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Out of all the functions, you will probably use the Lbound and Ubound functionsthe most, especially when working with dynamic arrays. The following program uses bothfunctions to get the size of a two dimensional array. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Dynamic </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create a dynamic array </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer myArray(), i, nb </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Resize array with two dimensions </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Redim myArray(1 To 1, 1 To 5) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print upper and lower bounds for each row and column </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;First Redim&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Min Row Index:&quot;;Lbound(myArray, 1); </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot; Max </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Row Index:&quot;;Ubound(myArray, 1) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Min Column index:&quot;;Lbound(myArray, 2); </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print&quot; Max </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Column index:&quot;;Ubound(myArray, 2) </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">17 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">18 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">19 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">20 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">21 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">22 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">23 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">24 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">25 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">26 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">27 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">28 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">29 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">30 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">31 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">32 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Additional Redims&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Redim array five times </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 1 To 5</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">nb = Ubound(myArray, 1) + 1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Redim myArray(1 To nb, 1 To 5) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print new array size </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Min Row Index:&quot;;Lbound(myArray, 1); </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot; Max </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Row Index:&quot;;Ubound(myArray, 1) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Min Column index:&quot;;Lbound(myArray, 2); </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot; Max </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Column index:&quot;;Ubound(myArray, 2) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 12.3: ulbound.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 2 set the compiler directive Option Dynamic so that the array isallocated in dynamic memory. Line 5 creates a dynamic array with no dimensionsspecified. Line 7 uses Redim to create a two-dimensional array. Lines 10 through 15 printthe upper and lower bounds using Lbound and Ubound respectively. Notice that thedimension parameter is used to specify which dimension to get the lower and upperbounds. 1 is used to get the bounds for the first dimension, and 2 is used to get thesecond dimension. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Lines 20 through 29 resize the first dimension of the array and print the new lowerand upper indexes. Line 21 gets the current upper bound of the first dimension, 1 isadded to that value and then Redim is used in line 22 to resize the first dimension of the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">array. Lines 24 through 27 get the new bounds and print the values to the screen. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The program is closed in the usual way. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should see the following output. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">First Redim </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Min Row Index: 1 Max </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Row Index: 1 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Min Column index: 1 Max </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Column index: 5 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Additional Redims </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Min Row Index: 1 Max </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Row Index: 2 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Min Column index: 1 Max </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Column index: 5 </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Min Row Index: 1 Max </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Row Index: 3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Min Column index: 1 Max </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Column index: 5 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Min Row Index: 1 Max </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Row Index: 4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Min Column index: 1 Max </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Column index: 5 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Min Row Index: 1 Max </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Row Index: 5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Min Column index: 1 Max </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Column index: 5 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Min Row Index: 1 Max </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Row Index: 6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Min Column index: 1 Max </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Column index: 5 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 12.4: Output of ulbound.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The first Redim sets the initial bounds for the array. The additional Redims increasethe number of rows in the array, while leaving the number of columns in intact. Keep inmind that arrays in FreeBasic are table-like, where each row has the same number ofcolumns. Ragged arrays, where each row has a different number of columns, cannot becreated in FreeBasic using arrays. You would have to use pointers to create a ragged </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">array. </font></font>
</pre><h2 class="western">
	Arrays of Types 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type definitions allow you to group related data into a single entity, and often youwill need more than one instance of a type to fully express the data. Arrays of types allowyou create multiple instances of a type definition that can be easily managed using thearrays functions. An example of this usage may be an inventory system for your RPG, aseries of document descriptions within an editor, and a set of employee records from arandom access database. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You create arrays of types just as you would with any of the intrinsic data types.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following code snippet illustrates the syntax. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type myPoint </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">x As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">y As Integer </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type myLine </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">p1 As myPoint </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">p2 As myPoint </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">char As String * 1 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myLineSet (1 to 3) as myLine </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The code defines a set of 3 lines, with endpoints p1 and p2, where each endpointis located at row and col. The following program illustrates using this definition to printsome lines to the console screen. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Define the point </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type myPoint </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">x As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">y As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Define the line </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type myLine </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">p1 As myPoint </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">p2 As myPoint </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">char As String * 1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create a set of 3 lines </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">17 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myLineSet (1 To 3) As myLine </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">18 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer i </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">19 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">20 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'This subroutine uses the Bresenham Line algorithm </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">21 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'to print a line on the console screen. Google </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">22 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'&quot;Bresenham Line algorithm&quot; for more information. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">23 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sub DrawLine(aLine As myLine)</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">24 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer i, deltax, deltay, num25 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer d, dinc1, dinc226 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer x, xinc1, xinc227 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer y, yinc1, yinc228 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer x1, y1, x2, y229 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">30 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Get the endpoint coordinates31 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">x1 = aLine.p1.x32 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">y1 = aLine.p1.y33 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">x2 = aLine.p2.x34 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">y2 = aLine.p2.y35 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">36 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Get the delta change in both x and y37 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">deltax = Abs(x2 x1)</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">38 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">deltay = Abs(y2 y1)</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">39 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">40 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Calculate the slope of the line41 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If deltax &gt;= deltay Then </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">42 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">num = deltax + 143 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">d = (2 * deltay) deltax44 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">dinc1 = deltay Shl 145 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">dinc2 = (deltay deltax) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Shl 146 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">xinc1 = 147 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">xinc2 = 148 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">yinc1 = 049 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">yinc2 = 150 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Else51 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">num = deltay + 152 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">d = (2 * deltax) deltay53 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">dinc1 = deltax Shl 154 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">dinc2 = (deltax deltay) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Shl 155 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">xinc1 = 056 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">xinc2 = 157 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">yinc1 = 158 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">yinc2 = 159 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End If60 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">61 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If x1 &gt; x2 Then62 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">xinc1 = xinc163 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">xinc2 = xinc264 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End If65 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">66 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If y1 &gt; y2 Then67 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">yinc1 = yinc168 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">yinc2 = yinc269 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End If70 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">71 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">x = x172 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">y = y173 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Locate y, x74 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print aLine.char;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">75 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 2 To num76 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Get the next iteration of the line77 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If d &lt; 0 Then78 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">d = d + dinc179 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">x = x + xinc180 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">y = y + yinc181 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Else82 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">d = d + dinc283 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">x = x + xinc284 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">y = y + yinc285 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End If86 Locate y, x </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">87 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">88 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">89 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">90 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">91 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">92 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">93 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">94 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">95 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">96 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">97 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">98 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">99 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">100 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">101 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">102 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">103 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">104 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">105 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">106 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">107 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">108 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">109 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">110 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">111 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">112</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print aLine.char; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Sub </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Returns a random number between low and high </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function GetRandom(lowerbound As Integer, upperbound As Integer) As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">GetRandom = Int((upperbound lowerbound </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">+ 1) * Rnd + lowerbound) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Function </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Randomize Timer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Initialize and print the lines </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = Lbound(myLineSet) To Ubound(myLineSet)</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Set the first endpoint coordinates </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myLineSet(i).p1.x = GetRandom(1, 80) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myLineSet(i).p1.y = GetRandom(1, 25) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Set the second endpoint coordinates </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myLineSet(i).p2.x = GetRandom(1, 80) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myLineSet(i).p2.y = GetRandom(1, 25) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Get the display character </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myLineSet(i).char = Chr(GetRandom(33, 47)) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print the line </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">DrawLine myLineSet(i) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 12.5: arrayoftypes.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Lines 4 through 7 define the coordinates for the an endpoint of a line.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Lines 10 through 14, define a line, with two endpoints and the character used to print theline on the console screen. Line 17 defines a set of three lines, and line 18 defines a </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">working variable that will be used in a For-Next loop that will initialize and display theline. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Lines 23 through 89 define a subroutine that implements the Bresenham Linealgorithm to print the line to the console screen. There are a number of resources on theInternet that explain the algorithm in detail and can be found using your favorite searchengine. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Lines 92 through 94 define a function that will return a random integer in therange of lowerbound to upperbound, inclusive. Line 96 initializes the random numbergenerator by seeding the generator with the current Timer value. Randomize Timerensures that each call to Rnd will return a different random number. Without the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Randomize statement, Rnd will return the same sequence of random number. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 98 through 109 initialize each line in the array and then calls the DrawLinesubroutine to print the line. When accessing the fields of a type within an array, you mustspecify which array element you are accessing by using parentheses with an index value, </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">jut as you would an intrinsic data type. You can then access each element within the typeusing the familiar dot notation you saw in the chapter on composite types. Notice thatthe syntax is similar to the syntax used in the type memory array example, and the rulesare accessing type fields is the same. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Once each array element has been initialized and each line printed, the program isclosed in the usual way. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should see something like the following output.</font></font>

 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">%%%</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">%%%</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">%% )</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">%%% )</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">%%% )</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">%%% )</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">%%% )</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">%% )</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">%%% )</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">%% )</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">////// </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">////////// </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">////////// </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">////////// </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">////////// </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">////////// </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">///// </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt"><b>Output 12.3: Output of arrayoftypes.bas </b></font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Your output will vary since the end points of the lines, and the line character arerandom generated. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Arrays in Types </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As you saw in the chapter on composite types, type fields be both intrinsic andcomposite type. You can also create static arrays within a type definition. In the listingabove, you can see that a line has two endpoints. Rather than using two distinct fields,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">you can create an array of endpoints that describe the line. The following code listing is amodification of the previous listing, using an array to describe the endpoints. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Define the point </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type myPoint </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">x As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">y As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Define the line </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type myLine11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">pts(1 To 2) As myPoint12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">char As String * 1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create a set of 3 lines </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myLineSet (1 To 3) As myLine </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">17 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer i, j </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">18 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">19 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'This subroutine uses the Bresenham Line algorithm </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'to print a line on the console screen. Google </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">21 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'&quot;Bresenham Line algorithm&quot; for more information. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">22 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sub DrawLine(aLine As myLine)</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">23 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer i, deltax, deltay, num24 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer d, dinc1, dinc2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer x, xinc1, xinc226 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer y, yinc1, yinc227 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer x1, y1, x2, y228 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">29 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Get the endpoint coordinates </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">x1 = aLine.pts(1).x31 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">y1 = aLine.pts(1).y32 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">x2 = aLine.pts(2).x33 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">y2 = aLine.pts(2).y34 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Get the delats change in both x and y36 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">deltax = Abs(x2 x1)</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">37 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">deltay = Abs(y2 y1)</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">38 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">39 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Calculate the slope of the line </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If deltax &gt;= deltay Then41 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">num = deltax + 142 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">d = (2 * deltay) deltax43 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">dinc1 = deltay Shl 144 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">dinc2 = (deltay deltax) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Shl 1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">xinc1 = 146 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">xinc2 = 147 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">yinc1 = 0 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">164 </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">48 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">yinc2 = 149 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Else50 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">num = deltay + 151 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">d = (2 * deltax) deltay52 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">dinc1 = deltax Shl 153 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">dinc2 = (deltax deltay) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Shl 154 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">xinc1 = 055 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">xinc2 = 156 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">yinc1 = 157 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">yinc2 = 158 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End If59 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">60 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If x1 &gt; x2 Then61 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">xinc1 = xinc162 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">xinc2 = xinc263 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End If64 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">65 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If y1 &gt; y2 Then66 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">yinc1 = yinc167 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">yinc2 = yinc268 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End If69 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">70 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">x = x171 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">y = y172 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Locate y, x73 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print aLine.char;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">74 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 2 To num75 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Get the next iteration of the line76 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If d &lt; 0 Then77 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">d = d + dinc178 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">x = x + xinc179 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">y = y + yinc180 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Else81 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">d = d + dinc282 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">x = x + xinc283 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">y = y + yinc284 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End If85 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Locate y, x86 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print aLine.char;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">87 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">88 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Sub </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">89 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">90 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Returns a random number between low and high </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">91 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function GetRandom(lowerbound As Integer, upperbound As Integer) As Integer92 GetRandom = Int((upperbound lowerbound </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">+ 1) * Rnd + lowerbound) </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">93 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">94 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">95 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">96 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">97 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">98 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">99 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">100 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">101 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">102 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">103 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">104 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">105 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">106 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">107 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">108 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">109 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">110 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">111 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">112 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Function </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Randomize Timer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Initialize and print the lines </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = Lbound(myLineSet) To Ubound(myLineSet)</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For j = Lbound(myLineSet(i).pts) To Ubound(myLineSet(i).pts) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Set the first endpoint coordinates </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myLineSet(i).pts(j).x = GetRandom(1, 80) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myLineSet(i).pts(j).y = GetRandom(1, 25) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Set the second endpoint coordinates </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myLineSet(i).pts(j).x = GetRandom(1, 80) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myLineSet(i).pts(j).y = GetRandom(1, 25) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Get the display character </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myLineSet(i).char = Chr(GetRandom(33, 47)) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print the line</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">DrawLine myLineSet(i) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt"><b>Listing 12.6: arrayintypes.bas</b> </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: This program is identical to the previous program, except that thisprogram uses an array to describe the endpoints of the line. Only the changes to theprogram will discussed in this section. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 11 defines a single dimension array of endpoints that has two elements. Inlines 97 through 110, the program initializes each line element. The outer loop selectseach line type within the line set array. The inner For-Next loop then selects eachendpoint element with the endpoint array. Notice that you an use Lbound and Ubound forthis array, just as you can with the main array. Arrays within a type definition are truearrays, and all the functions available in FreeBasic can be used with embedded arrays.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The inner j loop Lbound and Ubound use the outer loop specification, myLineSet(i).pts, </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">to select a line element within the line set array, and then the function is applied to theembedded array. The endpoints are then initialized using both the i and j specifications, </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myLineSet(i).pts(j).x = GetRandom(1, 80). The variable i selects a line while j </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">selects an endpoint within the selected line. The dot notation is used to reference each </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">field within the type definition, including the endpoint array. Again, the notation andprinciples are similar to a type memory array. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The program is closed in the usual way after printing all the lines. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The output of this program is the same as the previous program and is not shownhere. Using an array for the endpoints enables you to easily extend the line definition tosupport not only lines, but triangles and squares. The following code snippet shows onepossible definition. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type myObj </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">objid As Integer </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Union </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myLine(1 To 2) As myPoint </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myTriangle(1 To 3) As myPoint </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">mySquare(1 To 4) As myPoint </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Union </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">char As String * 1 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The objid field would indicate which type of object is contained within thedefinition. That is, a 1 may indicate a line, a 2 may indicate a triangle and a 3 mayindicate a square. Since the definition defines a single object, a union is used to enclosethe endpoint arrays to maximize memory usage. To print the object to the screen, youwould examine the objid and then use the Lbound and Ubound on the appropriateendpoint array definition, printing the number of lines that correspond to the type ofobject. One further enhancement you can make to this program is to add a functionpointer to the type definition, and then write print routines that correspond to the type ofobject being printed. Using this technique will enable you to further extend theusefulness of the code by simplifying the process of adding new objects to the typedefinition. For example, if you needed to be able to describe a cube, you would simplyadd an new array to the union, add a cube print function, and the type definition wouldbe able to print a cube by simply adding a few lines of code, while keeping the originalfunctionality intact. </font></font>
</pre><h2 class="western">
	Array Initialization 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You can initialize an array with values when using the Dim statement in a mannersimilar to initializing any of the other intrinsic data types, and type definitions. Thefollowing code snippet illustrates the syntax using a one dimensional array. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim aArray(1 to 5) As Integer =&gt; {1, 2, 3, 4, 5} </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">This code snippet dimensions a ubyte array with 5 elements, then sets theelements to the list contained within the curly brackets. The arrow operator, =&gt; tells thecompiler that the list following the Dim statement should be used to initialize the array.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You can also dimension multidimensional arrays in the same manner, by specifyingblocks of data enclosed within curly braces as the following code snippet illustrates. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim bArray(1 to 2, 1 to 5) As Integer =&gt; {{1, 2, 3, 4, 5}, _ </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">{6, 7, 8, 9, 10}} </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In this example, the first block, {1, 2, 3, 4, 5}, corresponds to row 1, and thesecond block, {6, 7, 8, 9, 10}, corresponds to row 2. Remember that FreeBasic arrays arerow-major, so the row is specified before the column. When you initialize an array in thismanner, you must be sure that the number of elements defined will fit into the array. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following programs initializes two arrays and print the values to the console. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">17 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">18 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">19 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">20 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">21 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">22 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim aArray(1 To 5) As Integer =&gt; {1, 2, 3, 4, 5} </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim bArray(1 To 2, 1 To 5) As Integer =&gt; {{1, 2, 3, 4, 5}, _ </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">{6, 7, 8, 9, 10}} </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer i, j </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print aArray values. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 1 To 5</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;aArray(&quot;;i;&quot; ):&quot;;aArray(i) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print bArray values. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 1 To 2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For j = 1 To 5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;bArray(&quot;;i;&quot;,&quot;;j;&quot; ):&quot;;bArray(i, j) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 12.7: arrayinit.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 3 creates a single-dimension array and initializes the values of thearray. Line 4 creates a two-dimensional array and initializes the both rows of the array.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 9 through 11 print the contents of the first array to the screen and lines 15 through19 print the contents of the second to the screen. The program is then closed in the usual </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">way. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should see the following output. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">aArray( 1 ): 1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">aArray( 2 ): 2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">aArray( 3 ): 3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">aArray( 4 ): 4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">aArray( 5 ): 5 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">bArray( 1, 1 ): 1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">bArray( 1, 2 ): 2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">bArray( 1, 3 ): 3 </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">bArray( 1, 4 ): 4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">bArray( 1, 5 ): 5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">bArray( 2, 1 ): 6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">bArray( 2, 2 ): 7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">bArray( 2, 3 ): 8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">bArray( 2, 4 ): 9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">bArray( 2, 5 ): 10 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 12.8: Output of arrayinit.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As you can see from the output, both arrays have been initialized correctly, andwithout using a loop to load the data into the array. You can initialize arrays of any sizeusing this method, although large arrays get a bit hard to work with and it is important tomaintain the proper order of data in the initialization block. </font></font>
</pre><h2 class="western">
	Type Array Initialization 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Since you can initialize a type definition and an array, it stands to reason you cando the same with a type array. In the chapter on type definitions you saw the syntax forinitializing a type, and here you have seen how to initialize an array. To initialize a typearray, you use both the type initialization syntax with the array initialization syntax, asyou would expect. The following code snippet illustrates this combined syntax. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type aType </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">a As Integer </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">b As Byte </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">c(1 To 2) As Zstring * 10 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As aType myType(1 To 2) =&gt; { (1234, 12, {&quot;Hello&quot;, &quot;World&quot;}), _ </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">(5678, 24, {&quot;From&quot;, &quot;Freebasic&quot;}) _ </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">} </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The curly brackets signify that this is an array initialization, while the parenthesisindicate the type initialization. Since the type has an embedded array, you use the curlybrackets to load the data into the embedded array, just as you would a stand-alone array.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If the embedded array was a multidimensional array, then you would need to wrap eachrow in { and } just as you would a stand-alone array. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following program shows how all this works together. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create a type definiton </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type aType5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">a As Integer6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">b As Byte7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">c(1 To 2) As Zstring * 10 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">17 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">18 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">19 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">20 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">21 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">22 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">23 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">24 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">25 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">26 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">27 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">28 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">29 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">30 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">31 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Dimension and init the type array </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As aType myType(1 To 2) =&gt; { (1234, 12, {&quot;Hello&quot;, &quot;World&quot;}), _ </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">(5678, 24, {&quot;From&quot;, &quot;Freebasic&quot;}) _ </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">} </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Working variables </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer i, j </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Display type values </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 1 To 2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Type array index: &quot;;i </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">With myType(i)</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print .a </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print .b </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For j = 1 To 2</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print .c(j)</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End With </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 12.9: typearray-init.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Lines 4 through 8 define the type definition. Line 11 dimensions andinitializes the type definition array. The type elements are enclosed in parenthesis, whilethe embedded array is enclosed within curly brackets. Line 15 creates some workingvariables for the For-Next loops. Lines 18 through 28 print the values to the consolescreen using a With block. The program is closed in the usual way. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should see the following output. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type array index: 1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1234 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Hello </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">World </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type array index: 2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5678 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">24 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">From </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Freebasic </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 12.4: Output of typearray-init.bas </font></font>
</pre><h2 class="western">
	CRT Array Functions 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">There are a few CRT functions that you can use to manipulate arrays. The followingtable lists the Mem* functions which are defined in string.bi. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function Syntax Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Memchr Ptr = </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Memchr(@Array(start),</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">byte_value, Ubound(Array)) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Returns a pointer tobyte_value in byte Array, orNull pointer if byte_value isnot found. Memchr onlyworks with byte arrays. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Memcpy Ptr = </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Memcpy(@ArrayTo(start),</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">@ArrayFrom(start),</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">num_bytes) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Copies num_bytes fromArrayFrom to ArrayTo andreturns a pointer to ArratTo.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Do not use this function if </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">From and To overlap. UseMemmove instead. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Memmove Ptr = </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Memmem(@ArrayTo(start),</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">@ArrayFrom(start),</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">num_bytes) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Works the same as Memcpybut correctly handlesoverlapping memory </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">segments. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 12.2: CRT Array Functions </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following program illustrates using Memchr to search for a byte within a bytearray, and Memcpy to copy one array into another array. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#include once &quot;crt.bi&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">17 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">18 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">19 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">20 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">21 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">22 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">23 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">24 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">25 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">26 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">27 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">28 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">29 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">30 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">31 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Ubyte aArray(1 To 5) =&gt; {65, 123, 100, 52, 42}, bArray(1 To 5) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim bret As Ubyte Ptr </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer index, i </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Look for 100 in byte array </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Looking for byte 100...&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">bret = Memchr(@aArray(1), 100, Ubound(aArray)) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If bret &lt;&gt; NULL Then</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">index = bret @</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">aArray(Lbound(aArray)) + Lbound(aArray) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;100 found at index &quot;;index </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Else</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;100 not found.&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End If </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Copy aArray to bArray </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Copying aArray to bArray...&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">bret = Memcpy(@bArray(1), @aArray(1), Ubound(aArray) * Sizeof(Ubyte)) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If bret &lt;&gt; NULL Then</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 1 To 5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;bArray(&quot;;i;&quot; ) = &quot;;bArray(i) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End If </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 12.10: memfunc.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 3 includes the crt.bi header file so that Memchr and Memcpy will beavailable to the program. Both functions are located in string.bi, which is included whenyou include crt.bi. Line 5 creates two ubyte arrays, the first which is initialized with somebyte data. Remember that the ubyte data type has a range of 0 to 255. Line 6 declares aubyte pointer which will be the return value fr the Memchr function. Line 7 declares twoworking variables, index which will be used to calulate the array index of the Memchrsearch, and I which will be used to print the contents of bArray after the Memcpyoperation. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 12 calls the Memchr function. The first parameter is the address of the firstelement of aArray, which has an index of 1, the value to find, which is 100, and thelength of the array. If Memchr finds the byte in the array, it will return a pointer to thevalue. If it cannot find the byte, bret will be Null. Line 13 checks the return value to makesure that bret is not Null; using a Null pointer will cause the program to behave strangelyor crash. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 14 calculates the array index of the found byte. Bret contains the address ofbyte 100 in the array. @aArray(1) returns the address of the first element of the array.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Since arrays are sequential memory locations, you can find the array index by </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">subtracting the address of the first array element from bret, and then adding the lowerbound index to the value. This will give you the index of the array element. Line 15 printsthe calculated index value to the console. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 23 copies the values from aArray to bArray. Again, the address of the firstelement of each array is passed to function, along with the number of bytes to copy. Thenumber of bytes to copy is passed to the function with the code Ubound(aArray) *</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sizeof(Ubyte), which uses the number of elements in the array times the size of a ubyte.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Lines 24 through 28 then print the values of bArray to screen to verify that the array wasin fact copied. The program is closed in the usual way. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should see the following output. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Looking for byte 100... </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">100 found at index 3 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Copying aArray to bArray... </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">bArray( 1 ) = 65 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">bArray( 2 ) = 123 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">bArray( 3 ) = 100 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">bArray( 4 ) = 52 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">bArray( 5 ) = 255 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 12.5: Output of memfunc.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As you can see from the output, both operations succeeded. Memcopy isextremely handy when you need to make a copy of an array. The function is much fasterthan using a For-Next, and there considerably less code to write. </font></font>
</pre><h2 class="western">
	Using the -exx Compiler Switch 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The -exx compiler switch will enable error and bounds checking within yourprogram. If you go outside the bounds of an array within your program, the compiler willgenerate an “out of bounds” error while the program is running. This is a great help indebugging your program, and finding problems associated with arrays. -exx will alsoinform of you of Null pointer assignments, so it is quite useful when working with pointersas well. If you are using FBIde select View-&gt;Settings from the menu and the FreeBasictab in the settings dialog. Add -exx to the end of your compiler command string. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Using -exx does add quite of bit of additional code to your program, so once yourprogram is functioning correctly, you will want to compile the program without the -exxswitch. </font></font>

</pre><h2 class="western">
	A Look Ahead 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Manipulating date and time values is a common task in programming. FreeBasic </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">has a number of date and time functions that make working with date and timeinformation quite easy, as you will see in the next chapter. </font></font>

</pre>
</div>
<div id="Composite Data Types " dir="ltr" href="../fbeginnerm13.odt">
	<h1 class="western" style="page-break-before: always">Chapter 10
	Composite Data Types 
	</h1>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">There are times when creating a program that you may want to define anaggregate structure such as a personnel record, or an enemy in a game. While you cando this using individual data types, it is hard to manage within a program. FreeBasic </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">offers two composite data types, the Type and Union. </font></font>
</pre><h2 class="western">
	Types 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">FreeBasic allows you to group several data types into a unified structure called aType definition which you can use to describe these aggregate data structures. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The basic structure of a type definition is: </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type type name </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">var definition </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">var definition </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">... </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Type-End Type block defines the scope of the definition. You define theelements of the type structure in the same manner as using the Dim keyword, withoutusing Dim. The following code snippet shows how to build an employee type. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type EmployeeType </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">fname As String * 10 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">lname As String * 10 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">empid As Integer </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">dept As Integer </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You can use any of the supported data types as data elements, including pointersand other type definitions. When you create the type definition, such as the exampleabove, you are just creating a template for the compiler. In order to use the typedefinition, you need to create a variable of the type, as the following code snippetillustrates. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim Employee As EmployeeType </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Once you have created a variable of the type, you can access each element withinthe type using the dot notation var_name.field_name. Using the above example, to </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">access the fname field you would use Employee.fname = “Susan”. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">To access multiple fields at a time, you can use the With-End With block. Thefollowing code snippet shows how to use the With block with the above example. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">With Employee </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.fname = &quot;Susan&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.lname = &quot;Jones&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.empid = 1001 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.dept = 24 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End With </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following program shows how to define, create and manage a type definition. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create type definition </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type EmployeeType5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">fname As String * 106 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">lname As String * 107 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">empid As Integer8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">dept As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create an instance of the type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim Employee As EmployeeType </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Initialize the type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">With Employee16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.fname = &quot;Susan&quot;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">17 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.lname = &quot;Jones&quot;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">18 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.empid = 100119 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.dept = 24 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">20 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End With </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">21 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">22 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print out header row </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">23 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;First Name&quot;;Tab(13);&quot;Last Name&quot;;Tab(25);&quot;Emp ID&quot;;Tab(33);&quot;Dept&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">24 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print String(79, &quot;&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">25 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print out data </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">26 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">With Employee27 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print RTrim(.fname);Tab(13);RTrim(.lname);Tab(24);.empid;Tab(32);.dept </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">28 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End With </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">29 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">30 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">31 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 10.1: type.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 4 through 9 define the type structure that is used in the program.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The type has 4 fields, two fixed length strings and 2 integer values. Dynamic strings can </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">be used within a type definition, however if you want to save the type information to thedisk, then you need to use fixed length strings. Dynamic strings are actually pointers to astring descriptor and saving a type that contains dynamic strings will save the 4 bytepointer value, rather than the actual string data, resulting in data loss. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 12 creates a variable of the type, Employee. The type definition is a templateand cannot be used until you create an instance of the type by creating a variable of thetype. Lines 15 through 20 initialize the type variable with some data using the a With-EndWith block. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 23 prints a header row to the console that indicates the field name data. TheTb function is used to align data names to the appropriate column. Line 24 uses theString function to print a dashed line, just to offset the header row from the data row.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Lines 26 through 28 prints the type data. Rtrim is used on the fixed length stringelements to trim off any unused trailing spaces. The Tab function is again used to alignthe data to the appropriate columns. The program is then ended in the usual way. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should the following output. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">First Name Last Name Emp ID Dept </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Susan Jones 1001 24 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 10.1: Output of type.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As you can see from the program, using a type definition is a perfect way to grouprelated data into a single data structure. Not only is it a compact way to describe data inyour program, but by grouping related data into a single object, you can manipulate thatdata as a single entity, rather than as a bunch of unrelated variables. This reduces thechances that errors will creep into your program by trying to manage large a set ofindividual variables. </font></font>
</pre><h2 class="western">
	Types Within Types 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In addition to the intrinsic data types, type fields can also be based on a typedefinition. Why would you want to do this? One reason is data abstraction. The moregeneral your data structures, the more you can reuse the code in other parts of yourprogram. The less code you have to write, the less chance of errors finding their way intoyour program. Using the Employee example, suppose for a moment that you needed totrack more dept information than just the department id. You might need to keep track ofthe department manager, the location of the department, such as the floor or thebuilding, or the main telephone number of the department. By putting this informationinto a separate type definition, you could this information by itself, or as part of anothertype definition such as the Employee type. By generalizing your data structures, yourprogram will be smaller, and much more robust. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Using a type within a type is the same as using on of the intrinsic data types. Thefollowing code snippets illustrates an expanded department type and an updated employee type. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type DepartmentType </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">id As integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">managerid as integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">floor as integer </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type EmployeeType </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">fname As String * 10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">lname As String * 10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">empid As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">dept As DepartmentType </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim Employee As EmployeeType </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">To access the department information within the Employee type, you use thecompound dot notation to access the dept fields. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Employee.dept.id = 24 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Employee.dept.managerid = 1012 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Employee.dept.floor = 13 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The top levels is Employee, so that reference comes first. Since dept is now a typedefinition, you need to use the dept identifier to access the individual fields within the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">DepartmentType. You can even carry this further, by including a type within a type withina type. You would simply use the dot notation of the additional type level as needed.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">While there is no limit on the levels of nested type definitions, it gets to be a bit unwieldywhen used with several levels. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You can also use the With-End With block with nested types, by nesting the Withblock, as illustrated in the following code snippet. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">With Employee </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.fname = &quot;Susan&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.lname = &quot;Jones&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.empid = 1001 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">With .dept </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.id = 24 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.managerid = 1012 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.floor = 13 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End With </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End With </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Notice that the second With uses the dot notation, .dept, to specify the next levelof type definitions. When using nested With blocks, be sure that match all the End Withstatements with their correct With statements to avoid a compile error. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following program is a modified version of the previous program illustratingthe new type definitions. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create the type definition </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type DepartmentType </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">id As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">managerid As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">floor As Integer </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type EmployeeType </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">fname As String * 10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">lname As String * 10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">empid As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">dept As DepartmentType </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create an instance of the type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim Employee As EmployeeType </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Initialize the type </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">With Employee </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.fname = &quot;Susan&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.lname = &quot;Jones&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.empid = 1001 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">With .dept</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.id = 24 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.managerid = 1012 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.floor = 13</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End With </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End With </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print out header row </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;First Name&quot;;Tab(13);&quot;Last Name&quot;;Tab(25);&quot;Emp ID&quot;;Tab(33); </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Dept&quot;;Tab(39);&quot;Manager&quot;;Tab(47);&quot;Floor&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print String(79, &quot;&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print out data </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">With Employee</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print Rtrim(.fname);Tab(13);Rtrim(.lname);Tab(24);.empid;Tab(32); </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">With .dept </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print .id;Tab(38);.managerid;Tab(46);.floor </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End With </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End With </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 10.2: type-type.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Lines 4 through 8 define the new type for the department. This is used inthe employee type definition is line 14. The field dept is defined as DepartmentType, inthe same manner as Employee is defined in line 18, with the Dim of course. Line 21through 30 use two With-End With blocks to initialize the type data. Employee is the firstlevel type, while .dept, using the dot notation, is the second level type. It is importantthat you use the dot notation with the second level With block so that the compiler knowsthat you are referring to a type element within Employee. Lines 33 and 34 prints theheader row with the additional department field information. Lines 37 through 42 thenprint the type data, again using a nested With block. Notice how using the With blocksdocument the type structure without needing any additional comments. While this isn'tthe primary reason to use a With block, it does create code that is easily understood. Theprogram is closed in the usual way. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should see the following output. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">First Name Last Name Emp ID Dept Manager Floor </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Susan Jones 1001 24 1012 13 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 10.2: Output of type-type.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">While it may not be readily apparent from the example, abstracting the data in thismanner gives you a tremendous amount of flexibility in your program. A company willusually have more than one department, so by abstracting the department informationinto a separate type definition, you can create functions that manage the departmentinformation, while at the same time minimizing the impact on the employee data </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">structure. </font></font>
</pre><h2 class="western">
	Type Assignments 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Extending the idea of data abstraction further, it would be nice to be able toseparate the initialization of the department type from the initialization of the employeetype. By separating the two functions, you can easily add additional departments asneeded. This is where you can use type assignments. Just as you can assign one intrinsicdata type to another, you can assign one type variable to another type variable,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">providing they share the same type definition. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following program abstracts the department initialization function and assignsthe result to the department type within the Employee type. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create the type definition </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type DepartmentType </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">id As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">managerid As Integer </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">floor As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type EmployeeType11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">fname As String * 1012 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">lname As String * 1013 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">empid As Integer14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">dept As DepartmentType </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">17 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'This function will init the dept type and return it to caller </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">18 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function InitDept(deptid As Integer) As DepartmentType19 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim tmpDpt As DepartmentType21 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Select Case deptid22 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Case 24 'dept 2423 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">With tmpDpt </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">24 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.id = deptid </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">25 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.managerid = 1012 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">26 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.floor = 1327 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End With28 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Case 48 'dept 4829 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">With tmpDpt </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.id = deptid </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">31 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.managerid = 1024 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">32 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.floor = 1233 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End With34 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Case Else 'In case a bad department id was passed35 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">With tmpDpt </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">36 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.id = 0 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">37 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.managerid = 0 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">38 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.floor = 039 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End With </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Select41 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Return the dept info42 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Return tmpDpt </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">43 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Function </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">44 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">45 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create an instance of the type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">46 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim Employee As EmployeeType </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">47 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">48 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Initialize the Employee type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">49 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">With Employee </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.fname = &quot;Susan&quot;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">51 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.lname = &quot;Jones&quot; </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">52 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">53 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">54 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">55 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">56 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">57 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">58 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">59 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">60 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">61 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">62 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">63 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">64 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">65 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">66 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">67 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">68 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">69</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.empid = 1001 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.dept = InitDept(24) 'get dept info </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End With </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print out header row </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;First Name&quot;;Tab(13);&quot;Last Name&quot;;Tab(25);&quot;Emp ID&quot;;Tab(33); </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Dept&quot;;Tab(39);&quot;Manager&quot;;Tab(47);&quot;Floor&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print String(79, &quot;&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print out data </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">With Employee</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print Rtrim(.fname);Tab(13);Rtrim(.lname);Tab(24);.empid;Tab(32); </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">With .dept </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print .id;Tab(38);.managerid;Tab(46);.floor </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End With </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End With </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 10.3: type-assign.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: This program is identical to the previous program, with the addition of thedepartment initialization function in lines 18 through 43. The functions is defined in line18 as returning the DepartmentType, with one parameter, the department id. Line 19creates a temporary department type variable that will be initialized with the appropriatedata, and returned from the function. The function uses a Select Case block to set the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">data within the temporary type. The Select statement will execute the block of code thatmatches the deptid. If no matches are found, the Else case will return a zero for eachelement. Since it is probable that no dept will have an id of 0, this value can be checkedto make sure that the passed deptid is valid. The Return statement in line 42 returns theinitialized dept information to the caller. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The function is used in line 53 to set the data values for the department in theEmployee type. Although this program doesn't include a check for an invalid departmentid for clarity, you could add a check on the department id following the Employeeinitialization code to make sure that a valid department id was used in the function. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The rest of the program is the same as the previous program, and prints theemployee information to the screen. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program, you should see that the output is identical to theprevious program output. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">First Name Last Name Emp ID Dept Manager Floor </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Susan Jones 1001 24 1012 13 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 10.3: Output of type-assign.bas </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">By just adding a simple function to the program, you have made the programeasier to maintain than the previous versions. If a new department is created, you cansimply update the InitDept function with the new department information, recompile andthe program is ready to go. </font></font>
</pre><h3 class="western">
	Pointers to Types 
	</h3>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You can create a pointer to a type, just as you can create a pointer to any of theintrinsic data types, and the same rules apply. As with any pointer, you must allocatesome memory for the pointer, dereference the data elements, and deallocate the pointerwhen you are done using it. Type pointers use the arrow notation, -&gt;, rather than the dotnotation to access the individual fields with a type. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In the previous program listing, the error checking on an invalid department id wasclunky at best. A better method is to have the InitDept function return a success codethat indicates a valid department id. The following program implements this strategy,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">and uses a DepartmentType pointer to hold the department information for the Employee </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">type. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#define deptok 0 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create the type definition </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type DepartmentType </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">id As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">managerid As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">floor As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type EmployeeType13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">fname As String * 1014 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">lname As String * 1015 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">empid As Integer16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">dept As DepartmentType </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">17 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">18 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">19 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'This function will init the dept type and return it to caller </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">20 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function InitDept(deptid As Integer, dpt As DepartmentType Ptr ) As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">21 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim ret As Integer = deptok22 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">23 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Select Case deptid24 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Case 24 'dept 24 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">25 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">dpt&gt;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">id = deptid </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">26 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">dpt&gt;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">managerid = 1012 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">27 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">dpt&gt;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">floor = 1328 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Case 48 'dept 48 </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">29 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">dpt&gt;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">id = deptid </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">30 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">dpt&gt;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">managerid = 1024 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">31 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">dpt&gt;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">floor = 1232 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Case Else 'In case a bad department id was passed </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">33 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">dpt&gt;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">id = 0 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">34 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">dpt&gt;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">managerid = 0 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">35 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">dpt&gt;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">floor = 0 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">36 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ret = Not deptok37 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Select38 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Return the dept status39 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Return ret </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">40 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Function </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">41 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">42 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create an instance of the types </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">43 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim Employee As EmployeeType </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">44 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim tmpDept As DepartmentType Ptr </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">45 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">46 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Initialize the pointer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">47 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">tmpDept = Callocate(Sizeof(DepartmentType)) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">48 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Get the department info, check return </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">49 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If InitDept(24, tmpDept) &lt;&gt; deptok Then50 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Error on dept type51 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Deallocate tmpDept52 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Invalid Department ID.&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">53 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Else54 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Department ok, init the Employee type55 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">With Employee56 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.fname = &quot;Susan&quot;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">57 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.lname = &quot;Jones&quot;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">58 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.empid = 100159 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.dept = *tmpDept 'Dereference the pointer60 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End With61 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Don't need the dept info now62 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Deallocate tmpDept63 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print out header row64 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;First Name&quot;;Tab(13);&quot;Last Name&quot;;Tab(25);&quot;Emp ID&quot;;Tab(33);</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">65 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Dept&quot;;Tab(39);&quot;Manager&quot;;Tab(47);&quot;Floor&quot;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">66 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print String(79, &quot;&quot;)</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">67 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print out data68 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">With Employee69 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print Rtrim(.fname);Tab(13);Rtrim(.lname);Tab(24);.empid;Tab(32);</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">70 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">With .dept71 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print .id;Tab(38);.managerid;Tab(46);.floor72 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End With73 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End With </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">74 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End If </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">75 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">76 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">77 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 10.4: type-ptr.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: This version of the program has a few modifications from the previousversions, but overall it is the same program. Line 3 defines a return for the InitDeptfunction. If the functions returns this code, the department id is valid; if the function doesnot return this code, the department id is invalid. The type definitions are the same asused previously, but the function in line 20 has changed. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The function now returns an integer value, and there are two parameters, adepartment id and a pointer to the DepartmentType. Line 21 dimensions and initializesthe function return value to deptok. If there are not errors, this value will be returned. Ifthe deptid is invalid, the Case Else will set the return value to Not deptok (-1) in line 36.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">This is a good technique to return boolean values from a function. By initializing thereturn variable to the “ok” status, you only need to set the variable to the “not ok” status,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">if an error occurs. Less typing, less code and fewer chances of introducing bugs into the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">program. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In the individual Case blocks, the arrow notation is used to access the individual </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">fields of the type pointer. The -&gt; automatically dereferences the pointer for you, makingit easier to manipulate the individual fields within the type. Line 39 returns the successcode of the function. You don't need to return any type information, because the functionis actually updating the external department type variable through the pointer. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 44 dimensions a DepartmentType pointer. Which is initialized in line 47.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Remember that Callocate allocates a memory segment, clears the segment and thenreturns the address of the segment which is stored in the variable tmpDept. In line 49 theInitDept function is called inside an If statement. If the function fails, that is returns Notdeptok, then the program deallocates the pointer and prints an error message. If thefunction succeeds, that is returns deptok, then the Employee type is initialized and thedata is printed to the screen. Notice in line 59 that the program is still using a typeassignment, but because tmpDept is a pointer, the dereference operator must be used. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 62 shows the power of using pointers as intermediate data structures. Oncethe department data is in the Employee type, you don't need the department typereference. Line 62 deallocates tmpDept, freeing the memory it was using. There is nosense in wasting memory on data structures that you only use for a very short time. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The rest of the program is identical to the previous programs. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run this program you should again see the same output as the previous </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">programs. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">First Name Last Name Emp ID Dept Manager Floor </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Susan Jones 1001 24 1012 13 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 10.4: Output of type-ptr.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">This change, like the previous change, was minor—most of the original program isin intact—but the program is now much more robust, easier to manage, and less prone toerror than the original program. The fact that the output has not changed even thoughthe program has, is a good indicator that the changes that were made were did notcreate unwanted side effects in the program. This is what data abstraction does;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">minimize negative impacts on existing code. </font></font>
</pre><h3 class="western">
	Type Memory Arrays 
	</h3>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In the chapter on pointers, you saw how to create a memory array of integersusing pointers. You can do the same with Type definitions, in much the same way. Thefollowing program creates a dynamic memory array using a type. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Declare type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type myType5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">id As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Declare a pointer to the type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myTypePtr As myType Ptr </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer i </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create a memory array of types </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myTypePtr = Callocate(5, Sizeof(myType)) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Add some data to the type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 0 To 417 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myTypePtr[i].id = i </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">18 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">19 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">20 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print data </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">21 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Initial data:&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">22 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 0 To 423 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print myTypePtr[i].id </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">24 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">25 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">26 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">27 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Resize the array </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">28 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myTypePtr = Reallocate(myTypePtr, 10) </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">29 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">30 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Add the new data </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">31 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 4 To 932 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myTypePtr[i].id = i </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">33 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">34 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">35 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print data </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">36 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;New Data:&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">37 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 0 To 938 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print myTypePtr[i].id </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">39 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">40 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">41 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Release memory </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">42 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Deallocate myTypeptr </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">43 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">44 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">45 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 10.5: memtype.bas </font></font>
</pre><p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis:
	Lines 4 through 6 declare a simple type. Line 9 dimensions a pointer
	tomyType, and line 10 creates an integer variable i for the
	following For-Next loops. Line 13allocates memory for 5 myType
	entries in the memory array. Lines 16 through 19initialize the
	individual type elements. Notice the syntax
	istype_variable[index].field_name. Since myTypePtr is a typed
	pointer, you can use theindex method to access each element in the
	array. You then use the dot notation toaccess each individual field
	of the type, just as you would using a single type variable.Lines 21
	through 25 print the data to the screen using the same pointer index
	method. Line 28 resizes the memory array with an additional 5 type
	elements. Lines 31through 33 initialize the new memory segment with
	data, and lines 26 through 39 printthe all the data to the screen.
	Line 42 deallocates the memory and the program is closedin the usual
	way. </font></font>
	</p>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should the following output. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Initial data:</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">0</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">New Data: </font></font>



 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">0 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 10.5: Output of memtype.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As you can see, creating a memory array of types is very straight forward. Youcreate the number of elements you need by using Callocate and then using the indexpointer method, you can access each individual type field using the dot notation. Theadvantage of using this method is that you can create dynamic structures in memory andgrow or shrink them as necessary so that you are not wasting memory on elements youmay not need. You can of course create a standard array of types, which will be coveredin the chapter on arrays, and you can even create a dynamic array of types—but themethod shown here does not incur the overhead of a dynamic array, and can be passedto functions using the pointer method. </font></font>
</pre><h2 class="western">
	Dynamic Arrays in Types 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">FreeBasic does allow you you to create an array within a type, which is covered inthe chapter on arrays, but it does not allow you to create dynamic arrays in types. Thereare times when you will need to create a dynamic structure in a type, and this can beaccomplished by using memory array method within a type. The following programillustrates a dynamic array of a type within a type. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'This will be the dynamic type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type pt5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">row As Integer6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">col As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'The base type: </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'darray will contain array data </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type DType12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">darray As pt Ptr </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create an instance of type </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">17 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">18 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">19 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">20 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">21 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">22 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">23 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">24 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">25 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">26 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">27 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">28 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">29 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">30 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">31 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">32 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">33 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">34 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">35 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">36 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">37 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">38 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myType As DType </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer i </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create enough space for elements </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myType.darray = Callocate(5, Sizeof(pt)) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Load data into array </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 0 To 4 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myType.darray[i].row = Int(Rnd * 10) + 1</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myType.darray[i].col = Int(Rnd * 10) + 1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print data </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 0 To 4</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Locate myType.darray[i].row, myType.darray[i].col</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;X&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Free allocated space </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Deallocate myType.darray </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 10.6: dynatype.bas </font></font>
</pre><p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis:
	Lines 4 through 7 define a type that will be used in the dynamic
	array.</font></font></p>
	<p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The
	program will use the row and column to print a character to the
	screen. Lines 11through 13 define the base type. Notice that darray
	is dimensioned as a pointer to thetype pt. If you needed an array of
	integers, you would use As Integer Ptr. The methodsare the same
	whether using an intrinsic data type, or another type as illustrated
	here.</font></font></p>
	<p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line
	20 allocates memory for 5 array elements. Since the program is
	creating an array oftypes, the second parameter to Callocate is the
	size of the type, pt. For an integer array itwould be
	Sizeof(Integer). Lines 23 through 26 initialize the type array with
	a randomrow and column which will be used within the print code that
	follows. The access syntaxin lines 24 and 25 follow what you have
	already seen; the dot notation is used to accessthe base type field
	darray, which is then accessed using the pointer indexing method,</font></font></p>
	<p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">since
	the program is using a typed pointer. The dot notation is then used
	to access theindividual fields of the array type. The syntax is the
	same as that shown with the typememory array, except here you have
	one additional level of indirection because the arrayis contained
	within a type. </font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Lines
	29 through 32 use the row and column fields to print an X to the
	screen.</font></font></p>
	<p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Again
	you can see that the dot notation and pointer index methods are used
	to accessthe fields within the type. Line 35 frees the memory
	allocated and the program is closedin the usual way. </font></font>
	</p>
	<pre class="western">

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should see something similar to the following </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">output.</font></font>

 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">X</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">X</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">X</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">X</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">X </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 10.6: Output of dynatype.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The location of the X's will vary since the rows and columns are generatedrandomly, but since Randomize is not being used, you should the same layout between </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">runs. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The two previous programs are quite similar in format. The differences are thelevels of indirection being used. In the memory array program, the type itself was beingused as the array element, so the pointer index was used at the top level, with the dotnotation used to access the field data. In this program, the memory array is embeddedwithin the type, so you use the standard dot notation to access the base type field,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">darray, and then use the pointer index method on the field to select the array element.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Since the array element is a type, you use the dot notation to access the array elementfield, just as you would as if it were a simple type variable. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You could of course create a memory array that contained a memory array. In thiscase, you would use the pointer index method to select the base type element, and thenthe dot notation to select the memory array field, then a pointer index to access theelement within the embedded array, and finally the dot notation to select the arrayelement field. It sounds complicated, but is actually easier to implement than it is toexplain. The following program modifies the previous program to illustrate this concept. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'This will be the embedded type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type pt5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">row As Integer6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">col As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'The base type: </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'darray will contain array data </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type DType12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">darray As pt Ptr </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create a pointer to base type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myType As DType Ptr </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">17 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer i, j </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">18 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">19 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Set up random number generator </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">20 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Randomize Timer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">21 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">22 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create enough space for 3 base type elements </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">23 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myType = Callocate(3, Sizeof(Dtype)) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">24 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create space for 3 pt elements within base type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">25 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 0 To 2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">26 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myType[i].darray = Callocate(3, Sizeof(pt)) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">27 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">28 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">29 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Load data within the type arrays </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">30 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 0 To 2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">31 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For j = 0 To 232 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myType[i].darray[j].row = Int(Rnd * 10) + 133 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myType[i].darray[j].col = Int(Rnd * 10) + 134 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">35 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">36 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">37 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print data </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">38 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 0 To 239 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For j = 0 To 240 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Locate myType[i].darray[j].row, myType[i].darray[j].col41 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;X&quot;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">42 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">43 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">44 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">45 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Free embedded type array </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">46 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 0 To 247 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Deallocate myType[i].darray </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">48 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">49 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Free base type array </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">50 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Deallocate myType </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">51 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">52 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">53 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 10.7: dyna-type2.bas </font></font>
</pre><p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis:
	Line 4 through 7 define the type that that will be an array within
	the basetype. Lines 11 through 13 define the base type. Darray is
	dimensioned as a pointer to the type pt since this will be a memory
	array with the base type. Line 16 defines a pointer tothe base type,
	Dtype, since the base type will also be a memory array. Line 17
	definestwo working variables, i and j, which will be used in the
	For-Next loops to create and loaddata within the types. Line 20
	initializes the random number generator. </font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line
	23 creates a three-element memory using the base type. Lines 25
	through 27then create a three-element memory array using the
	subtype, pt, for each base typeelement. Notice that the base type,
	myType is indexed using the pointer index methodsince it is a
	pointer, and each darray element is initialized using Callocate,
	since darray isalso a pointer. Lines 30 through 35 load data into
	the memory array elements row andcolumn. The outer For loop indexes
	the base type pointer, while the inner loop indexesthe darray type
	pointer. Since darray is an element of myType, darray is selected
	usingthe dot notation, and since row and col are elements of daray,
	these are selected usingthe dot notation. </font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Lines
	38 through 43 use the same logic to print the X's on the screen. The
	outerloop selects the base type pointer, while the inner loop
	selects the embedded pointer.The row and col elements of darray are
	used in the Locate statement to move the cursorto the position
	described by the row and col variables, and an X is printed to the
	screen. </font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Lines
	46 through 48 deallocate the darray memory array. The order of
	deallocationis important here. You must deallocate the embedded
	array first, before you deallocatethe base type array. If you
	deallocate the base type array without deallocating theembedded
	array, the embedded array elements will remain in memory causing
	amemory leak. The rule of thumb here is to deallocate the inner most
	pointer elementsfirst, and then work out toward the base pointer
	element. Line 50 deallocates the basetype elements, only after the
	darray elements have been deallocated. The program isthen closed in
	the usual way. </font></font>
	</p>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should see something similar to the followingoutput. There should be nine X's, however since the random number generator is workingwithin a 10 by 10 space, it is possible two X's may occupy the same row and column, soyou may not see all nine X's.</font></font>

 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">X X</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">X X</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">X</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">X</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">X X</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">X </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 10.7: Output of dyna-type2.bas </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">While this may seem confusing at first, if you look at the code you will see arecurring pattern. The pointer elements are selected using the pointer index method,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">followed by the dot notation to select the individual type elements. You start with thebase type, in this case myType, index the pointer, and then select the elements using thedot notation, in this case darray. Since darray is a pointer, it is selected using a pointerindex, followed by the dot notation to select the row and col elements. The pattern,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">pointer index, dot notation, pointer index, dot notation would be used for as many levelsas needed to resolve a individual element within the memory array. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following diagram shows the memory layout of the program. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">MyType[0] &gt; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.darray[0] &gt; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.row, .col </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.darray[1] &gt; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.row, .col </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.darray[2] &gt; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.row, .col </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">MyType[1] &gt; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.darray[0] &gt; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.row, .col </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.darray[1] &gt; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.row, .col </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.darray[2] &gt; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.row, .col </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">MyType[2] &gt; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.darray[0] &gt; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.row, .col </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.darray[1] &gt; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.row, .col </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.darray[2] &gt; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.row, .col </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You can see the pattern reflected in the diagram. If row were a type pointer, thenyou would just repeat the pattern of index, dot notation on row to resolve the next levelof elements. This type of data structure gives you a lot of flexibility in your programming.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">There is no need to have three darray elements for each base element; myType[0] maypoint to 4 elements and myType[2] may point to 1 element. You would need to add anadditional field in myType to indicate how many darray elements were each myTypeelement, but that is a minor adjustment and easily programmed. What this concept givesyou is tight control over your data structures, efficient use of memory and at a relativelylow cost in code. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function Pointers in Types </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Once you have created a type definition, you will usually need to create one ormore subroutines or functions that act on that data. By using function pointers, you cangroup the code that acts on this data right along with the data itself. This gives you apowerful capability to organize your data into code objects that operate as a single unit.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">This is one of the ideas behind OOP, or object oriented programming; encapsulating dataand the methods (subroutines and functions) that operate on that data into a singleentity. While FreeBasic doesn't yet support object oriented programming, you can derivesome of the benefits of OOP by using functions pointers along with data when you createyour type definitions. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You define a function (or subroutine) pointer by declaring a prototype functiondeclaration with the type element name. The following code snippet shows a typicaldeclaration. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type myObject </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">arg1 As Integer </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">arg2 As Integer </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ret As Integer </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myFunc As Function(arg1 As Integer, arg2 As Integer) As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Declare Function typeFunc(arg1 As Integer, arg2 As Integer) As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">... </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim Obj as myObject </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Obj.myFunc = @typeFunc </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">... </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function typeFunc(arg1 As Integer, arg2 As Integer) As Integer </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">... </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Function </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The type definition is defined using data in the normal manner, along with a field,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myFunc, that is defined As Function. When a field is defined As Function or As Sub, thiscreates a pointer to the function or subroutine. Notice that the type definition of myFuncdoesn't include a function, but does include the parameter and return types. Since this isa pointer field, the name isn't required, but the parameters and return type in theprototype declaration, must match the actual function in order for the compiler to do typechecking on the pointer field. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Declare statement following the type is needed as a forward reference so thatthe compiler knows that a function is defined somewhere in the code. If you left out thedeclaration, you would get a variable not declared error when trying the to compile thecode. You create an instance of the type using the Dim statement, just as you have seenin the other examples. Since myFunc is a pointer, you can't use it until you initialize thepointer and you do this by using the Addressof operator on the real function's name. Thiswill store the address of the function in myFunc, which is used when calling the function.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The real function must be coded of course, so that you actually have some code to callwhen using the function pointer. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following program illustrates creating and using a function pointer in a type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">def. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create a type definition that has data and function ptr </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type myObject </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">arg1 As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">arg2 As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ret As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myFunc As Function(arg1 As Integer, arg2 As Integer) As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Need to declare function for forward reference </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Declare Function typeFunc(arg1 As Integer, arg2 As Integer) As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create a type variable </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim Obj As myObject </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Set the address of the function </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Obj.myFunc = @typeFunc </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">17 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Set the data elements </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">18 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Obj.arg1 = 1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">19 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Obj.arg2 = 5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">20 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Call the function </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">21 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Obj.ret = Obj.myFunc(obj.arg1, Obj.arg2) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">22 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Show result </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">23 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Func return is&quot;;Obj.ret </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">24 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">25 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">26 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">27 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">28 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function typeFunc(arg1 As Integer, arg2 As Integer) As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">29 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Return arg1 + arg2 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Function </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 10.8: type-func.bas </font></font>
</pre><p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis:
	Lines 4 through 9 define a type with both integer data fields and
	afunction pointer field. MyFunc is defined As Function along with
	the function prototype.</font></font></p>
	<p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">This
	sets up myFunc as a function pointer. The Declaration statement in
	line 12 is used asa forward reference to the actual function code.
	If you did not supply the declaration, youwould get a variable not
	found error on line 16. Line 14 creates a variable of the typeand
	line 16 uses the Addressof operator to initialize the function
	pointer to the address oftypeFunc, the actual function. Lines 18 and
	19 initialize the data fields, arg1 and arg2.</font></font></p>
	<p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line
	21 actually calls the function with the proper arguments. Notice
	that the dot notationis used in calling the function, myFunc as well
	as passing the data to the function. Obj.retolds the functions
	return value. </font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The
	program is closed using the Sleep and End commands, followed by
	thefunction definition. Whenever you create a function pointer, you
	must have somecorresponding function code in order to pass the
	address of that code to the functionpointer. </font></font>
	</p>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program, you should see the following output.</font></font>

 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Func return is 6 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 10.8: Output of type-func.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As you can see, function pointers are quite simple to define and use. Not only isyour data encapsulated within a single code object, the methods that act on that data arealso contained within that same object, giving you a powerful way to organize your datastructures. The example program is quite simple of course, but you can use this conceptto reduce the complexity of your code. Suppose you are writing a game and the enemyunits have been defined using a type definition. By also including the subroutines orfunctions that act on that data within the type definition, you have a single code objectthat fully describes an enemy. If you need to make changes to the enemy code, you only </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">have to update a single code object, rather than a scattered bunch of variables andsubroutines. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">This method also enables you to pass information to functions or subroutines as asingle unit, by simply declaring a parameter as the type definition, and you have accessto both the data and methods within the called function. This makes the code much more </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">reliable and easier to maintain. It also enables you to generalize the code so that whenyou create these type of objects, they can be used in other programs. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Forward References </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">There may be a time when you need to create two type definitions that referenceeach other. Since FreeBasic is a single pass compiler, this poses a problem since thecompiler will encounter a reference to a type that hasn't been defined yet. The solution isto create a forward reference of the second type. You do this by using the Type-Askeywords, without the End Type. For example, suppose you have two types Type1 andType2. Type1 references Type2 and Type2 references Type1. It doesn't matter what orderyou define the types, you will generate an error in the compiler, because each type has areference that hasn't been defined yet. In order for the compiler to compile successfullyyou need to create a forward reference to the second type, and then use that referencein defining the first type. The following code snippet illustrates this concept. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Forward reference </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type FT as Type2 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type Type1 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">fType as FT </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type Type2 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">fType as Type2 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The code Type FT as Type2 creates the forward reference that is in turn used in </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">the Type1 definition to refer to Type2, fType as FT. FT and Type2 are actually the samething, FT is just an alias for the Type2 definition. Whenever you need to have one or motetype definitions refer to each other, you will need to create forward declarations for thethe types that have not been defined when referenced. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Bit Fields </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">There is yet another data type that can be used in type definitions, the bit field. Bitfields are defined as variable_name: bits As DataType. The variable name must befollowed with a colon and the number of bits, followed by the data type. Only integerdata types are allowed within a bit field. Bit fields are useful when you need to keep trackof boolean type information, such as if a pixel is on or off. The following programillustrates using bit fields within a type definition. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type BitType4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">b1: 1 As Integer5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">b2: 4 As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myBitType As BitType </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myBitType.b1 = 1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myBitType.b2 = 1101 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Bit field 1: &quot;;myBitType.b1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Bit field 2: &quot;;myBitType.b2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">17 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 10.9: bitfield.bas </font></font>
</pre><p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis:
	Lines 3 through 6 define a type with two bit fields. B1 is defined
	as 1 bit,</font></font></p>
	<p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">and
	b2 is defined as 4 bits. Line 8 creates a variable of the type
	definition. Line 10 setsb1 to 1. Since b1 is defined a 1 bit, the
	only valid values are 0 or 1. Line 11 sets b2 to1101. Here there are
	four bits so you can have a range of 0000 to 1111. Lines 13 and
	14print out the values of the bits. The program is closed in the
	usual way. </font></font>
	</p>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should see the following output. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Bit field 1: 1 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Bit field 2: 13 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 10.9: Output of bitfield.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The data type of the bit field determines how many bits you can declare in a bitfield. Since an integer is 32 bits long, you could declare up to 32 bits in the field.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">However, in most cases you would declare a single bit for each field, and use a number offields to define the bit masking that you wish to use. Using a single bit simplifies thecoding you need to do to determine if a bit is set or cleared. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Field Property </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you create a variable of a type definition, the type is padded in memory. Thepadding allows for faster access of the type members since the type fields are aligned ona 4 byte or Word boundary. However, this can cause problems when trying to read a typerecord from a file that is not padded. You can use the use field property to change thepadding of a type definition. The field keyword is used right after the type name and canhave the values 1, for 1 byte alignment (no padding), 2 for 2 byte alignment and 4 for 4byte alignment. To define a type with no padding you would use the following syntax. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type myType field = 1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">v1 As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">v2 As Byte </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For 2 byte alignment you would use field = 2. If no field = property is assigned,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">then the padding will be 4 bytes. If you are reading a type definition created by FreeBasicusing the default alignment, then you do not need to use the field property. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If you reading a Quick Basic type record, then you will need to use field = 1, as QB usedbyte alignment by default. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type Initialization </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You can initialize a type definition when you dimension the type just as you canany of the intrinsic variables. The following code snippet illustrates the syntax. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type aType </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">a As Integer </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">b As Byte </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">c As String </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myType As aType =&gt; (12345, 12, &quot;Hello&quot;) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In the Dim statement, the arrow operator is used to signal the compiler that youare initializing the type variable. The type element values must be enclosed inparenthesis, and separated by commas. The order of the value list corresponds to theorder of the type elements, where a will be set to 12345, b to 12 and c to “Hello”. Thefollowing short program initializes a type using this syntax. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create a type def </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type aType5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">a As Integer6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">b As Byte7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">c As String </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create and init the type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myType As aType =&gt; (12345, 12, &quot;Hello&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Display values </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">With myType </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print .a16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print .b17 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print .c </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">18 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End With </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">19 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">20 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">21End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 10.10: type-init.bas </font></font>
</pre><p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis:
	Lines 4 through 8 define a type definition. Line 11 dimensions the
	typevariable and sets the filed elements to the listed values. The
	order of the values </font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">correspond
	to the order of the field elements. Line 14 through 18 prints the
	type valuesto the screen. The program is then closed in the usual
	way. </font></font>
	</p>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should the following output.</font></font>

 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12345</font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Hello </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 10.10: Output of type-init.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Initializing a type definition in a Dim statement is useful when you need to have aset of initial values for a type, or values that will not change during program execution.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Since the values are known at compile time, the compiler can doesn't have to spendcycles loading the values during runtime. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Unions </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Unions look similar to Types in their definition. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Union aUnion </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">b As Byte </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">s As Short </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i As Integer </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Union </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If this were a Type, you could access each field within the definition. For a Union,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">you can only access one field at any given time; all the fields within a Union occupy thesame memory segment, and the size of the Union is the size of the largest member. Inthis case, the Union would occupy four bytes, the size of an Integer, with the b fieldoccupying 1 byte and the s field occupying 2 bytes within the 4 byte integer space. Eachfield starts at the first byte, so the s field would include the b field, and the i field wouldinclude both the b field and the s field. The following program illustrates this concept. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">17 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">18 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">19 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">20 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Define a union </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Union aUnion </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">b As Byte </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">s As Short </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i As Integer </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Union </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myUnion As aUnion </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Set the integer value </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myUnion.i = 2047483641 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print members </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Integer: &quot;;Tab(10);Bin(myUnion.i) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Byte: &quot;;Tab(33);Bin(myUnion.b) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Short: &quot;;Tab(28);Bin(myUnion.s) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 10.11: union.bas </font></font>
</pre><p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis:
	Line 4 through 8 define the example union. Line 10 defines a
	variable ofthe union definition. Line 13 sets the integer field to a
	value that will overlap the b and sfields. Lines 15 through 17 print
	out the values of each field of the union in binary so thatyou can
	see the overlap of the values. The program is closed in the usual
	way. </font></font>
	</p>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should the following output. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Integer: 1111010000010100001111011111001 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Byte: 11111001 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Short: 1111011111001 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 10.11: Output of union.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You can easily see the overlapped values in the output. While a union is useful onits own, you can combine a union with a type definition to create extremely flexible andefficient data structures. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Types in Unions </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">A good example of using a type definition in a union is the Large_Integer definitionfound in winnt.bi. The Large_Integer data type is used in a number of Windows functionswithin the C Runtime Library. The following code snippet shows the Large_Integerdefinition. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">union LARGE_INTEGER </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">type </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">LowPart as DWORD </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">HighPart as LONG </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">end type </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">QuadPart as LONGLONG </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">end union </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Dword data type is defined in windef.bi as an Uinteger, type DWORD as </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">uinteger, and the Longlong type is defined as a Longint, type LONGLONG as longint. A </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Long is the same as an integer. Remember that a type occupies contiguous memorylocations, so the HighPart field follows the LoPwart part field in memory, the typeoccupies the same memory segment as the QuadPart field. When you set QuardPart to alarge integer value, you are also setting the values of the type fields, which you can thenextract as the LowPart and HighPart. You can also do the reverse, that is by setting theLowPart and HighPart of the type, you are setting the value of the QuadPart field. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As you can see, using a type within a union is an easy way to set or retrieveindividual values of a component data type without resorting to a lot of conversion code.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The layout of the memory segments does the conversion for you, providing that thememory segments make sense within the context of the component type. In theLarge_Integer case, the LowPart and HighPart have been defined to return theappropriate component values. Using values other than Dword and Long would not returncorrect values for LowPart and HighPart. You need to make sure when defining a typewithin a union, you are segmenting the union memory segment correctly within the typedefinition. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Unions in Types </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">A union within a type definition is an efficient way to manage data when one fieldwithin a type can only be a single value. The most common example of this is the Variantdata type found in other programing languages. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">FreeBasic does not have a Variant data type at this time. However, when classes areadded to FreeBasic, it will be quite easy to create a Variant data type and overload thearithmetic operators to create a Variant that behaves just like the intrinsic data types.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Classes are planned for a future version of FreeBasic. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If you can only access a single field within a union, how do you know which field toaccess when a union is contained within a type definition? Usually you will include anidentifier field within the type, but outside the union, that identifies which union field toaccess. The following program illustrates this concept by creating a simple Variant data </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">type. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Union field ids </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#define vString 0 </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#define vInteger 1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Define type def with variable data fields </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Type vType9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">vt_id As Integer10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Union11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">s As String12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i As Integer13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Union </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Type </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create variant variable </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">17 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myVariant As vType </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">18 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">19 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'This subroutine prints out value </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">20 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sub PrintVariant(v As vType)</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">21 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If v.vt_id = vString Then22 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;String value: &quot;;v.s23 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Elseif v.vt_id = vInteger Then24 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Integer value:&quot;;v.i25 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End If </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">26 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Sub </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">27 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">28 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Set the id to a string </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">29 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myVariant.vt_id = vString </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">30 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myVariant.s = &quot;This is a string.&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">31 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print the string value </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">32 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">PrintVariant myVariant </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">33 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Clear the string memory before seting the integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">34 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myVariant.s = &quot;&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">35 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Set the id to an integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">36 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myVariant.vt_id = vInteger </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">37 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myVariant.i = 300 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">38 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print the integer value </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">39 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">PrintVariant myVariant </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">40 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">41 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">42 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 10.12: simplevariant.bas </font></font>
</pre><p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis:
	Line 4 and 5 define the union ids. These values will be used to
	determine which field within the union to access. Lines 20 through
	26 define a subroutine that willprint the value of the union field
	based on the id. If the id field is VString, then the s fieldwithin
	the union is printed. If the id field is VInteger, then the i field
	is printed. Line 29sets the id field to Vstring and line 30 sets the
	union field s to a string. The PrintVariantsubroutine is called in
	line 32 to print out the value. Line 34 clears the allocated
	memoryof the dynamic string by setting the union field s to an empty
	string. <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line
	36 sets the id field to an integer, and the value of the union field
	i is set to300. Line 39 calls the PrintVariant subroutine to print
	the integer value. The program isthen closed in the usual way. </font></font></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in; background: #c0c0c0">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in; background: #c0c0c0">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in; background: #c0c0c0">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt"><font size="2" style="font-size: 11pt"><span style="background: #c0c0c0">Caution</span></font><font size="2" style="font-size: 11pt">
	There are two subtle danger in this program that may not be
	readilyapparent. Remember that a dynamic string is actually a
	pointer to an allocated memorysegment. The union field s is actually
	a pointer to this memory segment. Since the fieldss and i overlap in
	memory, setting i to a value also sets s to a value; that is, in
	theprogram i is set to 300, which also sets s to 300. Since s is a
	pointer, trying to access safter setting i will access memory
	location 300, which will be garbage data and maycause the program to
	crash. </font></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in; background: #c0c0c0">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The
	other problem with this program is that it can potentially lead to a
	memoryleak while the program is running. The string value is an
	allocated memory segment.</font></font></p>
	<p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in; background: #c0c0c0">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Setting
	the integer value, overwrites the pointer address in s, which means
	you have lostthe pointer address to the memory segment. The string
	data still exists in memory, butnow that data is lost, causing a
	memory leak. This is why the string value in the unionwas set to an
	empty string before setting the integer value. Setting the string
	value to anempty string deallocates the string data and frees the
	string pointer. </font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: 2.50pt solid #000000; border-bottom: 2.50pt solid #000000; border-left: none; border-right: none; padding: 0.02in 0in; background: #c0c0c0">
	<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When
	using pointers within a union, great care must be taken to insure
	that thepointer is pointing to the correct memory location, and that
	they are deallocated correctlyto prevent memory leaks. </font></font>
	</p>
	<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should see the following output. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">String value: This is a string. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Integer value: 300 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 10.12: Output of simplevariant.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Using a combination of unions and types within a program allows to design customdata types that have a lot of flexibility, but care must be taken to ensure that you areusing the data constructs correctly. Improper use of these data types can lead to hard-tofind </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">bugs. The benefits however, out-weigh the risks and once mastered, are a powerfulprogramming skill. </font></font>
</pre><h2 class="western">
	A Look Ahead 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">There are times when you will need values that do not change during a program.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">These values are called Symbolic Constants and are the subject of the next chapter. </font></font>

</pre>
</div>
<div id=" Pointer Data Type" dir="ltr" href="../fbeginnerm11.odt">
	<h1 class="western" style="page-break-before: always">Chapter 8
	Pointer Data Type 
	</h1>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The pointer data type is unique among the FreeBasic numeric data types. Insteadof containing data, like the other numeric types, a pointer contains the memory addressof data. On a 32-bit system, the pointer data type is 4 bytes. FreeBasic uses pointers for anumber of functions such as ImageCreate, and pointers are used heavily in externallibraries such as the Windows API. Pointers are also quite fast, since the compiler candirectly access the memory location that a pointer points to. A proper understanding ofpointers is essential to effective programming in FreeBasic. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For many beginning programmers, pointers seem like a strange and mysteriousbeast. However, if you keep one rule in mind, you should not have any problems usingpointers in your program. The rule is very simple: a pointer contains an address, not data.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If you keep this simple rule in mind, you should have no problems using pointers. </font></font>
</pre><h2 class="western">
	Pointers and Memory 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You can think of the memory in your computer as a set of post office boxes (P.O.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Box) at your local post office. When you go in to rent a P.O. Box, the clerk will give you anumber, such as 100. This is the address of your P.O. Box. You decide to write the numberdown an a slip of paper and put it in your wallet. The next day you go to the post officeand pull out the slip of paper. You locate box 100 and look inside the box and find a nicestack of junk mail. Of course, you want to toss the junk mail, but there isn't a trash canhandy, so you decide to just put the mail back in the box and toss it later. Working withpointers in FreeBasic is very similar to using a P.O. Box. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you declare a pointer, it isn't pointing to anything which is analogous to theblank slip of paper. In order to use a pointer, it must be initialized to a memory address,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">which is the same as writing down the number 100 on the slip of paper. Once you havethe address, find the right P.O. Box, you can dereference the pointer, open the mail box,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">to add or retrieve data from the pointed-to memory location. As you can see there arethree basic steps to using pointers. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1. Declare a pointer variable. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2. Initialize the pointer to a memory address. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3. Dereference the pointer to manipulate the data at the pointed-to memory location. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">This isn't really any different than using a standard variable, and you use pointersin much the same way as standard variables. The only real difference between the two isthat in a standard variable, you can access the data directly, and with a pointer you mustdereference the pointer to interact with the data. The following program illustrates theabove steps. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 'Create a pointer doesn't </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">point to anything. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 Dim myPointer As Integer Ptr </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 'Initialize the pointer to point to 1 integer </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 myPointer = Callocate(1, Sizeof(Integer)) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 'Print the address </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 Print &quot;Pointer address:&quot;;myPointer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 'Add some meaningful data </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 *myPointer = 10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 'Print the contentswill </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">not be garbage </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 Print &quot;Memory location contains:&quot;;*myPointer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 'Deallocate the pointer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Deallocate myPointer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">17 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">18 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 8.1: basicpointer.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: In line 4 a pointer to an integer is created. The pointer doesn't point to a memory location yet, and if you were to try and use this uninitialized pointer, you would generate an error. Line 7 uses the Callocate function to set aside memory equal to the size of an integer, that is 4 bytes, and returns the starting address of the memory segment. The second parameter passed to Callocate is the size of the memory unit to allocate. The first parameter is the number of units to allocate. In this program, one unit of size integer is being allocated. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Now that myPointer has been initialized, you can use it. Line 9 prints out contentsof myPointer which illustrates that the variable contains a memory address and not data.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In line 11 data is added to the memory location using the indirection operator *. Theindirection operator tells the compiler you want to work with the data that myPointer ispointing to, rather than the memory address contained in the variable. Line 13 prints outthe contents of the memory location which is now 10. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In line 15, the memory allocated with Callocate is freed using the Deallocateprocedure. The program is closed in the usual way. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Running the program should produce a result similar to the following output. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Pointer address:3089536 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Memory location contains: 10 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 8.1: Output of basicpointer.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The address printed on your computer will probably be different, since theoperating system allocates the memory used by Callocate. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When your program terminates, all memory that was allocated in the program is freedand returned to the operating system. However, it is good practice to deallocatememory when it is no longer needed, even if it isn't strictly necessary when a programterminates. The better you manage your program's memory, the less chance ofproblems you will have when running the program on different computer configurations. </font></font>

</pre><h2 class="western">
	Typed and Untyped Pointers 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">FreeBasic has two types of pointers, typed and untyped. The preceding programdeclared a typed pointer, Dim myPointer as Integer Ptr, which tells the compiler thatthis pointer will be used for integer data. Using typed pointers allows the compiler to dotype checking to make sure that you are not using the wrong type of data with thepointer, and simplifies pointer arithmetic. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Untyped pointers are declared using the Any keyword: Dim myPointer as Any </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Ptr Untyped pointers have no type checking and default to size of byte. Untyped pointersare used in the C Runtime Library and many third party libraries, such as the Win32 API,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">to accommodate the void pointer type in C. You should use typed pointers so that thecompiler can check the pointer assignments, unless working with libraries that requirethe void pointer. </font></font>
</pre><h2 class="western">
	Pointer Operators 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">There are two pointer operators in FreeBasic; the indirection operator and theaddressof operator. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Operator Syntax Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">* (Indirection) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">[ ] (Index Access) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = *myPointer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">*myPointer = B </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = myPointer[index] </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myPointer[index] = B </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You can access the data in a </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">pointer memory location byeither using the indirectionoperator or using indexaccess. The index format </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">uses the size of the data </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">type to determine theproper indexing. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">@ (AddressOf) myPointer = @myVar </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myPointer = @mySub() </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myPointer = @myFunction() </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Returns the memoryaddress of a variable, </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">subroutine or function. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 8.1: Pointer Operators </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You will notice that the addressof operator not only returns the memory address ofa variable, but it can also return the address of a subroutine or function. You would use </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">the address of a subroutine or function to create a callback function such as used in the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">CRT function qsort. Callback functions will discussed later in this chapter. </font></font>
</pre><h2 class="western">
	Memory Functions 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">FreeBasic has a number of memory allocation functions that are used withpointers, as shown in the following table. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function Syntax Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Allocate myPointer =</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Allocate(number_of_bytes) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Allocates number_of_bytesand returns the memory </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function Syntax Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">address. If myPointer is 0,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">the memory could not beallocated. The allocated </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">memory segment is notcleared and contains </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">undefined data. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Callocate myPointer =</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Callocate(number_of_elements, size_of_elements) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Callocate allocates </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">number_of_elements that </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">have size_of_elements and </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">returns the memoryaddress. If the memorycould not be allocated, </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Callocate will return 0. The </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">memory segment allocatedis cleared. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Deallocate Deallocate myPointer Frees the memory segmentpointed to by myPointer. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Reallocate myPointer =</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Reallocate(pointer,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">number_of_bytes) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Reallocate changes the sizeof a memory segmentcreated with Allocate or </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Callocate. If the new size is </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">larger than the existingmemory segment, thecontents of the memorysegment remainedunchanged. If the new sizeis smaller, the contents of </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">the memory segment aretruncated. If pointer is 0,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Reallocate behaves just likeAllocate. A 0 is returned if </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">the memory segmentcannot be changed. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 8.2: FreeBasic Memory Functions </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">These functions are useful for creating a number of dynamic structures such aslinked lists, ragged or dynamic arrays and buffers used with third party libraries. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When using the Allocate function you must specify the storage size based on thedata type using the equation number_of_elements * Sizeof(datatype). To allocate </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">space for 10 integers your code would look like this: myPointer = Allocate(10 * </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sizeof(Integer)). An integer is 4 bytes so allocating 10 integers will set aside 40 bytesof memory. Allocate does not clear the memory segment, so any data in the segment willbe random, meaningless data until it is initialized. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Callocate works in the same fashion, except that the calculation is done internally.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">To allocate the same 10 integers using Callocate your code would look like this: </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myPointer = Callocate(10, Sizeof(Integer)). Unlike Allocate, Callocate will clear </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">the memory segment. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Reallocate will change the size of an existing memory segment, making it larger orsmaller as needed. If the new segment is larger than the existing segment, then the datain the existing segment will be preserved. If the new segment is smaller than the existingsegment, the data in the existing segment will be truncated. Reallocate does not clearthe added memory or change any existing data. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">All of these functions will return a memory address if successful. If the functionscannot allocate the memory segment, then a NULL pointer (0) is returned. You shouldcheck the return value each time you use these functions to be sure that the memorysegment was successfully created. Trying to use a bad pointer will result in undesirablebehavior or system crashes. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">There is no intrinsic method for determining the size of an allocation; you mustkeep track of this information yourself. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Caution Be careful not to use the same pointer variable to allocate two or morememory segments. Reusing a pointer without first deallocating the segment it points towill result in the memory segment being lost causing a memory leak. </font></font>
</pre><h2 class="western">
	Pointer Arithmetic and Pointer Indexing 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you create a memory segment using the allocation functions, you will need away to access the data contained within the segment. In FreeBasic there are twomethods for accessing data in the segment; using the indirection operator with pointerarithmetic, and pointer indexing. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Pointer arithmetic, as the name suggests, adds and subtracts values to a pointer toaccess individual elements within a memory segment. When you create a typed pointersuch as Dim myPointer as Integer ptr, the compiler knows that the data being usedwith this pointer is of size Integer or 4 bytes. The pointer, when initialized, points to thefirst element of the segment. You can express this as *(myPtr + 0). To access the secondelement, you need to add 1 to the pointer, which can be expressed as *(myPtr + 1).</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Since the compiler knows that the pointer is an Integer pointer, adding 1 to the pointerreference will actually increment the address contained in myPtr by 4, the size of anInteger. This is why using typed pointers is preferable over untyped pointers. Thecompiler does much of the work for you in accessing the data in the memory segment. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Notice that the construct is *(myPtr + 1) and not *myPtr + 1. The * operator hashigher precedence than +, so *myPtr + 1 will actually increment the contents myPtrpoints to, and not the pointer address. *myPtr will be evaluated first, which returns thecontents of the memory location and then +1 will be evaluated, adding 1 to the memorylocation. By wrapping myPtr + 1 within parenthesis, you force the compiler to evaluatemyPtr + 1 first, which increments the pointer address, and then the * is applied to returnthe contents of the new address. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Pointer indexing works the same way as pointer arithmetic, but the details arehandled by the compiler. *(myPtr + 1) is equivalent to myPtr[1]. Again, since thecompiler knows that myPtr is an integer pointer, it can calculate the correct memoryoffsets to return the proper values using the index. Which format you use if up to you, butmost programmers use the index method because of its simplicity. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following program shows both methods of accessing a memory segment. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myPtr As Integer Ptr </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer i </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Try and allocate space for 10 integers </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myPtr = Callocate(10, Sizeof(Integer)) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Make sure the space was allocated </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If myPtr = 0 Then </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Could not allocate space for buffer.&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End 1 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End If </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Load data into the buffer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Loading data, print data using *...&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 0 To 9</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">*(myPtr + i) = i</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Index:&quot;;i;&quot; data:&quot;;*(myPtr + i) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print data from buffer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Show data using indexing...&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 0 To 9</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Index:&quot;;i;&quot; data:&quot;;myPtr[i] </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Free the memory </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Deallocate myPtr </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 8.2: ptraccess.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: In lines 3 and 4 the working variables are declared. Space for 10 integersis created in Line 7 using the Callocate function. Lines 10 through 13 check to make surethat the memory was allocated. If it wasn't, the program ends. The End 1 terminates theprogram with an exit code of 1. This is useful for instances where the program may berun from a batch file and you want to make sure the program ran successfully. You cancheck the exit code in the batch file and take the appropriate action. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Lines 17 through 20 load and print the memory segment with ten integers usingthe indirection operator and pointer arithmetic. Lines 25 through 27 print out the valuesusing the index method. Notice that the index method is much more compact and easierto read. In line 30 the buffer is deallocated, even though it isn't strictly necessary as theprogram is terminating. Deallocating memory is a good habit to get into, even when itmay not be strictly necessary. The program is closed in the usual way. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should see the following output. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Loading data, print data using *... </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Index: 0 data: 0 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Index: 1 data: 1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Index: 2 data: 2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Index: 3 data: 3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Index: 4 data: 4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Index: 5 data: 5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Index: 6 data: 6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Index: 7 data: 7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Index: 8 data: 8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Index: 9 data: 9 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Show data using indexing... </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Index: 0 data: 0 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Index: 1 data: 1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Index: 2 data: 2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Index: 3 data: 3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Index: 4 data: 4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Index: 5 data: 5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Index: 6 data: 6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Index: 7 data: 7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Index: 8 data: 8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Index: 9 data: 9 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 8.2: Output of ptraccess.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As you can see from the output, both formats produce the same results, but the</font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">index method is a lot easier to read and understand, and less error-prone than the</font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">indirection method. </font></font>
</pre><h2 class="western">
	Pointer Functions 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Freebasic has a set of pointer functions to complement the pointer operators. Thefollowing table lists the pointer functions. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function Syntax Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Cptr myPtr = Cptr(data_type,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">expression) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Converts expression to adata_type pointer.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Expression can be another </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function Syntax Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">pointer or an integer. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Peek B = Peek(data_type,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">pointer) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Peek returns the contents of </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">memory location pointer toby pointer. Data_typespecifies the type ofexpected data. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Poke Poke data_type, pointer,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">expression </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Puts the value of expressioninto the memory locationpointed to by pointer. Thedata_type specifies the typeof data being placed intothe memory location. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sadd myPtr =</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sadd(string_variable) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Returns the location in </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">memory where the stringdata in a dynamic string islocated. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Strptr myPtr =</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Strptr(string_variable) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The same as Sadd. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Procptr myPtr = Procptr(function) Returns the address of a </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">function. This works the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">same way as the addressofoperator @. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Varptr myPtr = Varptr(variable) This function works the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">same way as the addressofoperator @. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 8.3: Pointer Functions </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Sadd and Strptr functions will be discussed in the chapter on the string datatypes. The Peek and Poke functions have been added for the purposes of supportinglegacy code. Procptr and Varptr both work just like the address of operator, but Proptronly works on subroutines and functions and Varptr only works on variables. Cptr is usefulfor casting an untyped pointer to a typed pointer, such as a return value from a thirdparty library. </font></font>
</pre><h2 class="western">
	Subroutine and Function Pointers 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Subroutines and functions, like variables, reside in memory and have an addressassociated with their entry point. You can use these addresses to create events in yourprograms, to create pseudo-objects and are used in callback functions. You create a subor function pointer just like any other pointer except you declare your variable as apointer to a subroutine or function rather than as a pointer to a data type. Before using afunction pointer, it must be initialized to the address of a subroutine or function usingProcptr or @. Once initialized, you use the pointer in the same manner as calling theoriginal subroutine or function. The following program illustrates declaring an using afunction pointer. </font></font>




<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Declare our function to be used with pointer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Declare Function Power(number As Integer, pwr As Integer) As Integer </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Dim a function pointer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim FuncPtr As Function(x As Integer, y As Integer) As Integer </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Get the address of the function </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">FuncPtr = @Power </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Use the function pointer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;2 raised to the power of 4 is&quot;;FuncPtr(2, 4) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Write the function that will be called </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function Power(number As Integer, pwr As Integer) As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Return number^pwr </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Function </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 8.3: funcptr.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 4 declares the function prototype that will be used with the functionpointer. Line 7 declares the function pointer using the the As Function syntax. Notice thatthe Dim statement does not use the Ptr keyword; the compiler knows that this will be afunction pointer since it is declared using the As Function method. When declaring afunction pointer, the parameter list must match the number and type of parameters ofthe pointed-to function, but as you can see, the names do not have to match. In fact, thepointer can be declared as Dim FuncPtr As Function(As Integer, As Integer) As </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Integer, without the parameter names. The only requirement is to make sure that thetype and number of parameters, and the return type, match the function declaration anddefinition. Line 10 initializes the function pointer to the address of the function using theaddress of operator @. You could use Procptr here as well. Line 13 uses the pointer tocall the function. The calling syntax is the same as using the function name: FuncPtr(2,4)</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">is equivalent to Power(2, 4). Lines 15 and 16 close the program in the usual way. Lines 19through 21 define the actual Power function. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Running the program will produce the following result. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 raised to the power of 4 is 16 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 8.4: Output of funcptr.bas </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">While this example program may not seem to have any advantages over justcalling the function directly, you can use this method to call several functions using asingle function pointer. For example, if you were creating your own user interface, youcould implement events using a function pointer that called one of several differentsubroutines depending on the object receiving the event. The only requirement would bethat each subroutine must contain the same number and type of parameters. </font></font>
</pre><h2 class="western">
	Creating a Callback Function 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">One of the primary uses for function pointers is to create callback functions. Acallback function is a function that you have created in your program that is called by afunction or subroutine in an external library. Windows uses callback functions toenumerate through Window objects like fonts, printers and forms. The qsort, functioncontained within the C Runtime Library sorts the elements of an array using a callbackfunction to determine the sort order. The prototype for the qsort function is contained instdlib.bi: </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">declare sub qsort cdecl alias &quot;qsort&quot; (byval as any ptr, byval as size_t, </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">byval as size_t, byval as function cdecl(byval as any ptr, byval as any </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ptr) as integer) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following lists the parameter information for the qsort subroutine. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1. The first parameter is the address to the first element of the array. The easiest wayto pass this information to qsort is to append the address of operator to the firstelement index: @myArray(0). </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2. The second parameter is the number of elements in the array, that is the array </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">count. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3. The third parameter is the size of each element in bytes. For an array of integers,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">the element size would be 4 bytes. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4. The fourth parameter is a function pointer to the user created compare function.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The function must be declared using the Cdecl passing model, as shown in this </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">parameter. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Using this information, you can see how qsort works. By passing the address of thefirst element along with the count of elements, and the size of each element, qsort caniterate through the array using pointer arithmetic. Qsort will take two array elements,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">pass them to your user defined compare function and use the compare function's returnvalue to sort the array elements. It does this repeatedly until each array element is insorted order. The following program uses the qsort subroutine and a compare function tosort an array of integers. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#include &quot;crt.bi&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Declare the compare function </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'This is defined in the same manner as the qsort declaration </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Declare Function QCompare Cdecl (Byval e1 As Any Ptr, Byval e2 As Any Ptr) _ </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Dimension the array to sort </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myArray(10) As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim i As Integer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Seed the random number generator </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Randomize Timer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">17 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Unsorted&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">18 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Load the array with some random numbers </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">19 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 0 To 920 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Rnd returns a number between 0 and 1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">21 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'This converts the number to an integer22 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myArray(i) = Int(Rnd * 20)</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">23 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print unsorted array24 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;i = &quot;;i;&quot; value = &quot;;myArray(i) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">25 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">26 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">27 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">28 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Call the qsort subroutine </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">29 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">qsort @myArray(0), 10, Sizeof(Integer), @QCompare </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">30 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">31 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">32 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print sorted array. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">33 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Sorted&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">34 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 0 To 935 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Rnd returns a number between 0 and 1 to convert to integer36 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;i = &quot;;i;&quot; value = &quot;;myArray(i) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">37 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">38 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">39 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">40 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">41 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">42 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'The qsort function expects three numbers </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">43 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'from the compare function: </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">44 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'1: </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">if e1 is less than e2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">45 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'0: if e1 is equal to e2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">46 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'1: if e1 is greater than e2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">47 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function QCompare Cdecl (Byval e1 As Any Ptr, _</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">48 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Byval e2 As Any Ptr) As Integer49 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer el1, el250 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Static cnt As Integer51 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">52 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Get the call count and items passed53 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">cnt += 154 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Get the values, must cast to integer ptr55 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">el1 = *(Cptr(Integer Ptr, e1)) </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">56 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">el2 = *(Cptr(Integer Ptr, e2))</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">57 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Qsort called&quot;;cnt;&quot; time(s) with&quot;;el1;&quot; and&quot;;el2;&quot;.&quot;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">58 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Compare the values59 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If el1 &lt; el2 Then60 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Return 161 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Elseif el1 &gt; el2 Then62 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Return 163 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Else64 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Return 065 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End If </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">66End Function </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 8.5: qsort.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 3 includes the crt.bi file so that the qsort routine will be available inthe program. You need to include this file if you want to use any of the CRT functions.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 7 declares the compare function. You will notice that it is declared as a Cdecl </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">function, which matches the 4th parameter definition in the qsort declaration. Since qsortexpects to see either a -1, 0 or 1, the function's return type is an integer. The undercorescharacter _ at the end of line 7 is the line continuation character and tells the compilerthat the following line is actually a part of this line. In line 11 an array of integers isdimensioned. The array will have 10 elements, with indexes from 0 to 9. Line 12dimensions a working variable i, that will be used to load and display the array values. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 15 seeds the random number generator by using the value from the Timerfunction. The Timer function returns the number of seconds, as a double-type value,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">since the computer was started. Lines 19 through 25 initializes the array with somerandom integers and displays them to the console screen. The code in line 22, Int(Rnd *</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">20), uses the Rnd function which returns a double precision number between 0 and 1.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">That number is multiplied by twenty to produce a double-precision number between 0and 20 which is then converted to an integer value using the Int function. Since Intreturns the largest integer less than or equal to the input, the resulting random numberswill range from 0 to 19. In line 24 the value of the current array index is printed to theconsole screen. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In line 29 the qsort subroutine is called. Since the array indexes range from 0 to 9,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">the address of operator on the zero index in used for the first parameter. The array size is10, so that is used as the second parameter. The array is an integer array, soSizeof(Integer) is used to pass the array element size. The final parameter is the addressof the compare function which is passed to qsort using the address of operator. Lines 34through 37 print out the now sorted array. Lines 39 and 40 close the program in the usual </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">way. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Lines 47 through 66 contain the compare function code. In line 47 the function isdefined just like the declare statement in line 7 using two Any Ptr parameters andreturning an integer. The Any Ptrs allow qsort to be able to sort any type of data,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">including composite types. Lines 49 and 50 delcare the function's working variables.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Qsort will pass pointers to the functions, not the actual data, so two integers need to bedeclared so that the data that the pointers point to can be compared. The variable cnt isdefined as Static so that its value will be preserved between calls to the function. Cnt isused to keep track of how many calls to the function qsort will make as it sorts the array. </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Lines 55 and 56 use the indirection operator to return the data from the passedpointers. Notice the Cptr is used to convert the Any Ptr parameters to Integer Ptrs beforeusing the indirection operator. Remember that the code inside the parenthesis will beexecuted before applying the indirection operator. Line 57 prints out the current callcount and the passed parameter values. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 59 through 65 compare the two values and return the appropriate indicatorvalue back to qsort. The Return statement, as expected, is used to set the function'sreturn value. The function is closed using the End Function keywords in line 66. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should something similar to the following. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Unsorted </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i = 0 value = 14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i = 1 value = 18 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i = 2 value = 2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i = 3 value = 14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i = 4 value = 3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i = 5 value = 15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i = 6 value = 16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i = 7 value = 4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i = 8 value = 10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i = 9 value = 19 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Qsort called 1 time(s) with 18 and 15. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Qsort called 2 time(s) with 19 and 15. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Qsort called 3 time(s) with 10 and 15. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Qsort called 4 time(s) with 2 and 15. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Qsort called 5 time(s) with 14 and 15. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Qsort called 6 time(s) with 3 and 15. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Qsort called 7 time(s) with 14 and 15. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Qsort called 8 time(s) with 16 and 15. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Qsort called 9 time(s) with 4 and 15. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Qsort called 10 time(s) with 16 and 15. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Qsort called 11 time(s) with 4 and 15. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Qsort called 12 time(s) with 18 and 16. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Qsort called 13 time(s) with 19 and 18. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Qsort called 14 time(s) with 18 and 16. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Qsort called 15 time(s) with 10 and 4. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Qsort called 16 time(s) with 2 and 10. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Qsort called 17 time(s) with 14 and 10. </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Qsort called 18 time(s) with 3 and 14. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Qsort called 19 time(s) with 14 and 14. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Qsort called 20 time(s) with 10 and 4. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Qsort called 21 time(s) with 2 and 10. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Qsort called 22 time(s) with 14 and 10. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Qsort called 23 time(s) with 3 and 14. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Qsort called 24 time(s) with 10 and 4. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Qsort called 25 time(s) with 2 and 10. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Qsort called 26 time(s) with 3 and 10. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Qsort called 27 time(s) with 3 and 4. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Qsort called 28 time(s) with 2 and 4. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Qsort called 29 time(s) with 3 and 2. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sorted </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i = 0 value = 2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i = 1 value = 3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i = 2 value = 4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i = 3 value = 10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i = 4 value = 14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i = 5 value = 14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i = 6 value = 15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i = 7 value = 16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i = 8 value = 18 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i = 9 value = 19 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 8.3: Output of qsort.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The first group of numbers show the unsorted array. The middle group of numbersshow the number of times the compare function is called along with the values beingsorted. The last group of numbers show the sorted array. Even though qsort is calledquite a number of times even on this small array, the routine is extremely fast since ituses pointers to sort the values in the array. </font></font>
</pre><h2 class="western">
	Pointer to Pointer 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In FreeBasic you can create a pointer to any of the supported data types, includingthe pointer data type. A pointer to a pointer is useful in situations where you need toreturn a pointer to a function or in creating specialized data structures such as linked-listsand ragged arrays. A pointer to a pointer is called multi-level indirection. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Caution You can have as many levels of indirection as needed, but anythingbeyond two levels is rarely useful and difficult to manage. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">One application of a pointer to pointer is the creation of memory arrays. Thefollowing program demonstrates the creation, manipulation and freeing of a memory </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">array. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Declare a pointer to an int pointer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myMemArray As Integer Ptr Ptr </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer i, j </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create 10 rows of integer pointers </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myMemArray = Callocate(10, Sizeof(Integer Ptr)) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Add 10 columns of integers to each row </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 0 To 912 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myMemArray[i] = Callocate(10, Sizeof(Integer)) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Add some data to the memory segment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 0 To 917 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For j = 0 To 918 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myMemArray[i][j] = Int(Rnd * 10)</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">19 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">21 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">22 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print out data </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">23 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 0 To 924 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For j = 0 To 9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;i,j = &quot;;i;&quot;,&quot;;j;&quot; Mem Array =&quot;;myMemArray[i][j]</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">26 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">27 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">28 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">29 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Free memory segment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 0 To 931 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Deallocate myMemArray[i] </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">32 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">33 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Free the pointer to pointer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">34 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Deallocate myMemArray </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">36 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">37 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 8.6: memarray.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 4 dimensions a pointer to an integer pointer, myMemArray, whichwill simulate a two dimensional array, with myMemArray pointing to a list of integer </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">pointers. This list of pointers will comprise the “rows” of the array. Line 5 just declaressome working variables that are used in the For-Next loops later in the program.</font></font>

 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 8 creates the rows of the array by allocating a memory segment that willcontain 4 integer pointers, which are initialized in lines 11 through 13. Remember thatthe index method of accessing a pointer automatically does the pointer arithmetic foryou. The code in lines 11 through 13 iterates through the memory segment created inline 8 and initializes the memory segment with pointers to memory segments that willcontain integers. In other words, you have a pointer that is pointing to a list of pointers.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">These newly created memory segments are the columns for each row. Each column indexwill be a pointer to a memory location containing an integer. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Lines 16 through 20 add some random numbers to the memory array. Notice thatby using the indexing method you can access the memory array just like a normal array. ipoints to the row (the list of pointers) and j points to the individual columns within thatrow which contain the integer data. The same method is used in lines 23 through 27 toprint out the array values. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Lines 30 through 32 free the individual rows of memory that were created in line 8. It isimportant that each row be freed before freeing myMemArray. If you were to just freemyMemArray, the rows would still be in memory, but unaccessible, causing a memoryleak. Once all the rows have been freed, myMemArray can be freed in line 34. Since theprogram is terminating, Deallocating the memory is not strictly required in this instance,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">but if you needed to reuse the memory, then you must Deallocate in the methoddescribed, otherwise you will get a memory leak while the program is running. Lines 36and 37 close the program in the usual way. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Running the program should produce a result similar to the following. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i,j = 0, 1 Mem Array = 5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i,j = 0, 2 Mem Array = 1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i,j = 0, 3 Mem Array = 8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i,j = 0, 4 Mem Array = 5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i,j = 1, 0 Mem Array = 4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i,j = 1, 1 Mem Array = 3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i,j = 1, 2 Mem Array = 8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i,j = 1, 3 Mem Array = 8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i,j = 1, 4 Mem Array = 7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i,j = 2, 0 Mem Array = 1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i,j = 2, 1 Mem Array = 8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i,j = 2, 2 Mem Array = 7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i,j = 2, 3 Mem Array = 5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i,j = 2, 4 Mem Array = 3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i,j = 3, 0 Mem Array = 0 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i,j = 3, 1 Mem Array = 0 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i,j = 3, 2 Mem Array = 3 </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i,j = 3, 3 Mem Array = 1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i,j = 3, 4 Mem Array = 1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i,j = 4, 0 Mem Array = 9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i,j = 4, 1 Mem Array = 4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i,j = 4, 2 Mem Array = 1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i,j = 4, 3 Mem Array = 0 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i,j = 4, 4 Mem Array = 0 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 8.4: Output of memarray.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As you can see from the output, the memory array behaves exactly like apredefined array. This structure is useful for adding dynamic arrays to type definitions,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">which normally cannot hold a dynamic array. You will see this in more detail in thechapter on composite types. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">One last note on this program. If you run the program more than once, you willnotice that the values in the array are always the same, even though the program isgenerating random numbers. This is because the program did not seed the randomnumber generator using the Randomize statement. To get different numbers for each run,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">add Randomize Timer before calling the Rnd function. </font></font>
</pre><h2 class="western">
	A Look Ahead 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Pointers are an efficient and powerful data type, and you will be seeing more ofthem in this book, including the next chapter where you will explore the string data typesavailable in FreeBasic. </font></font>

</pre>
</div>
<div id="Symbolic Constants" dir="ltr" href="../fbeginnerm14.odt">
	<h1 class="western" style="page-break-before: always">Chapter 11
	Symbolic Constants 
	</h1>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Constants are values that do not change during the life of the program. Constantsare like variables in that the name of the constant refers to the defined value, but unlike </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">a variable, these values cannot be changed in the program. There are two importantreasons why constants should be used in your program. One, they help to document theprogram. Suppose in your role-playing game you have a weapon such as a broadsword. Ifyou define the broadsword as a constant, which you can do with #Define broadsword </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12, you can then refer to the weapon id as broadsword, rather than 12. The number 12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">imparts no real information when you see it in the code; broadsword on the the other </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">hand is quite clear and understandable. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The second reason to use a constant is code maintenance. There may come a timewhen working on your role-playing game that you need to change the value of thebroadsword id. If you have defined the id as a constant, you only need to change it in asingle location, the place where you defined the constant. If you had just used thenumber 12, you would have to search through the code and change each instance where12 referred to the broadsword. If the program is of any length at all, you will probablymiss a reference or two, introducing bugs into your program. Bugs that may be difficult tolocate and fix. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">One of the things you will discover as you progress in your programming adventure isthat programs are dynamic, not static. There is always a new technique beingdeveloped that you can use, a new compiler function that will improve your program,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">and bugs that need to be fixed. The only thing that stays the same in a program is thefact that programs continually evolve over time. You should always keep in mind thatwhen you write a program, you will probably end up making changes to the program,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">and you should code accordingly. It may be easier to write 12 than it is to writebroadsword, but a few extra seconds of typing will save you hours when you need tochange 12 to 120. </font></font>
</pre><h2 class="western">
	#Define as a Constant 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You have already seen #Define at work in several of the example programs.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#Define is a preprocessor command, where the defined symbol is physically replaced inthe code by the associated value. #Define of course is used in a number of situations,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">from creating macros to conditional compilation, but it is also useful for creatingconstants within your program. If you look through the declaration files in the includefolder of your FreeBasic installation, you will see that #Define is used extensively forconstant values. Since the compiler replaces the symbol definition with the defined </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">value, it is a very efficient coding method. It is also quite easy to use, as the followingcode snippet illustrates. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Define directions </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#Define north 1 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#Define neast 2 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#Define east 3 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#Define seast 4 </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#Define south 5 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#Define west 6 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#Define swest 7 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#Define nwest 8 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Once you define the constants, you can use the symbols in your programs just asyou would the values. You have already seen this technique used in some of the exampleprograms presented in the book. </font></font>
</pre><h2 class="western">
	The Const Keyword 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Const keyword is another method to define constants in your program. Theformat is similar to the #define, as the following code snippet illustrates. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Const xk = Chr(255) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Const key_up = xk &amp; Chr(72) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Const key_dn = xk &amp; Chr(80) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Const key_rt = xk &amp; Chr(77) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Const key_lt = xk &amp; Chr(75) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">These constants are the character codes returned by Inkey for the arrow keys.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Inkey returns a two byte string for the extended keys, Chr(255) + the extended keycharacter code. Inkey is covered in detail in the chapter on Console Programming. To usethese constaints in your program you would just use key_lt for example to check to see ifthe left arrow key had been pressed. </font></font>
</pre><h2 class="western">
	Const Versus #Define 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As you can see Const and #Define are similar constructs. The question thenbecomes, which one should you use? Remember that #Define replaces the symbol namewith the text following the symbol. If you wrote #Define key_up xk &amp; Chr(72), then </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">the code xk &amp; Chr(72) would be replace the symbol key_up. If you had several places </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">where you used key_up, then there would be several instances of xk &amp; Chr(72) in your </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">program. You can see that by using #Define in this case your program would beperforming the same calculation over and over. It is much more efficient to use Const inthis case, since the calculation is only done once, when the Const is defined. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">On the other hand, if you are defining single constant values, such as compassdirections, then using a #Define is preferable to using Const. For a Const value, thecompiler must do a lookup in the symbol table and it is much more efficient to simplereplace the symbol with the value using #Define. </font></font>
</pre><h2 class="western">
	Enumerations 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Enumerations are sequential values that the compiler can calculate for you. Tocreate an enumeration, you use enclose the values within an Enum-End Enum block. Thecompass direction defined above could also be defined as an enumeration. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Enum compass </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">north = 1 </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">neast </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">east </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">seast </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">south </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">west </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">swest </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">nwest </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Enum </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In this example, neast will be defined as 2, with east defined as 3 and so on. If nostarting value is set, enumerations start at 0. You can also change the sequence within anenumeration by setting a symbol to a value using =, and any following symbols will beincremented from this starting point. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Enum compass </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">north = 1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">east </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">south </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">west </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">neast = 10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">seast </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">swest </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">nwest </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Enum </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In this example, the value of seast will be 11, swest will be 12 and so on. Once youdefine an enumeration, you can create variables of the Enum and use that variable within </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">your program. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim aCompass as compass </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You can then use the enumeration values to initialize the variable. The followingcode snippet set aCompass to the north-defined value. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">aCompass = north </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Caution The compiler does not check to see if the value being passed to the Enumvariable is within the defined range of the enumeration. It is the responsibility of theprogrammer to ensure that the Enum variable contains the correct values. </font></font>
</pre><h2 class="western">
	A Look Ahead 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In the next chapter you will see how to create and work with Arrays in FreeBasic. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">149 </font></font>


</pre>
</div>
<div id="control structures.odt" dir="ltr" href="../Control%20structures.odt&#255;writer8">
	<p><br/>
<br/>

	</p>
</div>
<div id="Date and Time Functions" dir="ltr" href="../fbeginnerm16.odt">
	<h1 class="western" style="page-break-before: always">Chapter 13
	Date and Time Functions 
	</h1>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Working with dates and time in many Basic languages can be problematic due tothe lack of date and time functions. FreeBasic however, has a rich set of date and time </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">functions, and when used in combination with the Format function, which you will see inthe next chapter, you can easily handle any date or time problem you may encounter. </font></font>
</pre><h2 class="western">
	Intrinsic Date and Time Functions 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">FreeBasic includes the standard date and time functions that you see in most Basiclanguages. The following table lists these functions. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function Syntax Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Date B = Date Returns the current systemdate as a string. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Setdate B = Setdate(date_string) Sets the system date todate_string, returning 0 onsuccess and non-zro on </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">failure. Date string must bein one of the followingformats: mm-dd-yy&quot;, &quot;mmdd-</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">yyyy&quot;, &quot;mm/dd/yy&quot;, or&quot;mm/dd/yyyy&quot;. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Settime B = Settime(time_string) Sets the system time totime_string, returning 0 onsuccess and non-zero on </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">failure. Time string must bein one of the followingformats: &quot;hh:mm:ss&quot;, </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">&quot;hh:mm&quot;, or &quot;hh&quot;. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Time B = Time Returns the current systemtime as a string. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Timer B = Timer Returns the number of </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">seconds since the computerwas started as a double-</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">type value. If the computer'sCPU supports thePerformance Counter, than </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Timer has a resolution in </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">microseconds. On </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">computers without thePerformance Counter, the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">resolution is 1/18 of asecond. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 13.1: Intrinsic Date and Time Functions </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following short programs demonstrates the return values for Date and Time aswell as using Timer in a delay loop. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim myTimer As Double </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Current time is &quot;;Time </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Current date is &quot;;Date </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Number of seconds since computer started: &quot;;Timer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Pausing for 2 seconds...&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myTimer = Timer + 2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Do11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep 10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Loop Until Timer &gt; myTimer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Press any key to continue...&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 13.1: datetime.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 3 dimensions a double-type variable for use with the Timer function.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 5 prints out the current system date. Line 6 prints out the current system time. Line7 prints out the number of seconds since the computer was started. Line 9 initializes thevariable myTimer with the current Timer result plus 2 seconds. The Do-Until loop in lines10 through 12 loop until the 2 seconds have expired. The Sleep in line 11 allows theoperating system to handle any other events while the computer is busy in the Do loop.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Whenever you have an extended loop of this nature, you need to use a Sleep xcommand, where x is the number of milliseconds to wait. This will keep your programfrom consuming 100% CPU time and allow other processes to execute. The program isended in the usual way. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should see something similar to the following </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">output. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Current time is 11:44:02 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Current date is 06272006 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Number of seconds since computer started: 10710.42349851727 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Pausing for 2 seconds... </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Press any key to continue... </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 13.1: Output of datetime.bas </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As the example program illustrates, you can use the Timer function for delay loops.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">This is common in games that want to control the FPS, or frames-per-second, when usingreal-time animation techniques. In the code above, the initial Timer value is saved in avariable. Timer returns the number of seconds since the computer was started, so adding2 to this variable will create a 2 second interval. The Until portion of the loop checks tosee if the current result of the Timer function is greater than the saved value, and exitswhen 2 seconds have elapsed. </font></font>
</pre><h2 class="western">
	Extended Date and Time Functions 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In addition to the functions listed above, FreeBasic has several extended date and </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">time functions that enable you to easily calculate date and time intervals, and extractdifferent parts of a date or time number for use in your program. In order to use thesefunctions you must include &quot;vbcompat.bi&quot; in your program. Most of these functionsrequire a date serial, a double-type value that represents a date and time number. Thedate is stored in the integer portion of the double, while the time is stored in thefractional part of the double. </font></font>
</pre><h3 class="western">
	DateAdd Function 
	</h3>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The DateAdd function returns a future or past date or time based on a certaininterval. The function requires a serial start date or time, an interval string and thenumber of intervals. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">date_serial = DateAdd(interval_string, number_of_intervals, </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">start_date_serial) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following list explains each of the parameters in order; that is, interval_stringis 1 below, number_of_intervals is listed as 2, and so on, along with the return value.</font></font>

 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1. Interval string: This is a string that indicates what interval to add to the startdate_serial. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">a) “yyyy”: years</font></font>

 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">b) </font></font>
“<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">q”: quarters</font></font>

 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">c) </font></font>
“<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">m”: months</font></font>

 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">d) </font></font>
“<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ww”: weeks</font></font>

 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">e) </font></font>
“<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">d”,”w”,”y”: days</font></font>

 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">f) </font></font>
“<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">h”: hours</font></font>

 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">g) </font></font>
“<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">n”: minutes</font></font>

 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">h) “s:” seconds</font></font>

 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2. Number of intervals: The number of intervals defined in interval_string to add tothe passed date_serial. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3. Date serial: The starting date in the calculation. </font></font>

 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4. Return: Returns a date serial that is offset by intervals from the starting date. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following program illustrates the DateAdd function. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#Include Once &quot;vbcompat.bi&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Date serial variable </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim nDate As Double </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim interval As Integer = 2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim intervalstr As String </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Number of intervals:&quot;;interval </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Current Date: &quot;;Format(Now, &quot;mmddyyyy&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Year interval </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">intervalstr = &quot;yyyy&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">nDate = DateAdd(intervalstr, interval, Now) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">17 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print intervalstr;&quot;: &quot;;Format(nDate, &quot;mmddyyyy&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">18 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Quarter interval </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">19 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">intervalstr = &quot;q&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">20 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">nDate = DateAdd(intervalstr, interval, Now) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">21 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print intervalstr;&quot;: &quot;;Format(nDate, &quot;mmddyyyy&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">22 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Month interval </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">23 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">intervalstr = &quot;m&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">24 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">nDate = DateAdd(intervalstr, interval, Now) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">25 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print intervalstr;&quot;: &quot;;Format(nDate, &quot;mmddyyyy&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">26 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Week interval </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">27 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">intervalstr = &quot;ww&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">28 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">nDate = DateAdd(intervalstr, interval, Now) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">29 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print intervalstr;&quot;: &quot;;Format(nDate, &quot;mmddyyyy&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">30 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Day interval </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">31 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">intervalstr = &quot;d&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">32 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">nDate = DateAdd(intervalstr, interval, Now) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">33 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print intervalstr;&quot;: &quot;;Format(nDate, &quot;mmddyyyy&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">34 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'w day interval </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">35 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">intervalstr = &quot;w&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">36 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">nDate = DateAdd(intervalstr, interval, Now) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">37 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print intervalstr;&quot;: &quot;;Format(nDate, &quot;mmddyyyy&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">38 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'y day interval </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">39 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">intervalstr = &quot;y&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">40 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">nDate = DateAdd(intervalstr, interval, Now) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">41 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print intervalstr;&quot;: &quot;;Format(nDate, &quot;mmddyyyy&quot;) </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">42 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">43 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">44 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">45 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">46 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">47 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">48 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">49 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">50 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">51 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">52 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">53 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">54 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">55 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">56 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">57 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">58 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">59 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">60 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">61 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">62 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">63 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Quarter interval </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">intervalstr = &quot;q&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">nDate = DateAdd(intervalstr, interval, Now) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print intervalstr;&quot;: &quot;;Format(nDate, &quot;mmddyyyy&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Current time: &quot;;Format(Now, &quot;hh:mm:ss&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Hour interval </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">intervalstr = &quot;h&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">nDate = DateAdd(intervalstr, interval, Now) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print intervalstr;&quot;: &quot;;Format(nDate, &quot;hh:mm:ss&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Minute interval </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">intervalstr = &quot;n&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">nDate = DateAdd(intervalstr, interval, Now) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print intervalstr;&quot;: &quot;;Format(nDate, &quot;hh:mm:ss&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Second interval </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">intervalstr = &quot;s&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">nDate = DateAdd(intervalstr, interval, Now) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print intervalstr;&quot;: &quot;;Format(nDate, &quot;hh:mm:ss&quot;) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 13.2: dateadd.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: In line 3 the “vbcompat.bi” is included in the program. You need toinclude this file if you want to use the extended date time functions as well as the formatfunction. Line 6 dimensions a double-type variable to hold the return value from theDtaeAdd function. Line 7 creates an integer variable to hold the interval, which is set to</font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2. Line 8 creates a string that will hold the various interval strings. Line 10 prints thecurrent interval number. Line 12 prints the current date using the Format function and theNow function. The Now function returns the current date and time as a date serial. The </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">format function's format string “mm-dd-yyyy” will print a two digit month, a two digit dayand a four digit year. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Lines 15 through 17 set the interval string for the DateAdd function, “yyyy” in thiscase, passes the interval string, interval and the current date serial, using the Nowfunction. The calculated date is returned in nDate, which is passed to the Format functionin line 17. Lines 18 through 45 use the same code blocks to calculate the result for eachinterval string. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 47 pints the current time. DateAdd works with time numbers as well as dates,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">and lines 50 through 60 illustrate the different time offsets. The Format function uses theformat string “hh:mm:ss” in 47 which prints a 24-hour time. The same code blocks areused for the time calculations that were used in the date calculations, and the results are </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">printed in the same fashion. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program your output should look similar to the following. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Number of intervals: 2 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Current Date: 06272006 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">yyyy: 06272008 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">q: 12272006 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">m: 08272006 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ww: 07112006 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">d: 06292006 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">w: 06292006 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">y: 06292006 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">q: 12272006 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Current time: 16:28:12 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">h: 18:28:12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">n: 16:30:12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">s: 16:28:14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 13.2: Output of datedd.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Using a negative interval number will return a past date, rather than a future date.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Changing the variable interval in the above program to -2 will result in the followingoutput. Notice that the date and time return values are two intervals in the past. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Number of intervals:2 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Current Date: 06272006 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">yyyy: 06272004 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">q: 12272005 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">m: 04272006 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ww: 06132006 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">d: 06252006 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">w: 06252006 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">y: 06252006 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">q: 12272005 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Current time: 16:52:09 </font></font>




<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">h: 14:52:09 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">n: 16:50:09 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">s: 16:52:07 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 13.3: Output with Negative Interval Number </font></font>
</pre><h3 class="western">
	DateDiff Function 
	</h3>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The DateDiff functions returns the difference between two date or time serials </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">based on a certain interval. The function requires two date or time serials and an intervalstring. You can optionally specify the first day of the week or the first day of the year. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">int_value </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">= DateDiff(interval_string, date_serial1, date_serial2) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">int_value </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">= DateDiff(interval_string, date_serial1, date_serial2, </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">first_day_of_week) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">int_value </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">= DateDiff(interval_string, date_serial1, date_serial2, </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">first_day_of_week, first_day_of_year) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You can specify the first day of the week when using the “ww” interval but thedefault is to use the system setting. You can also specify which week belongs to whichyear when a week spans the end of one year and the beginning of the next year.</font></font>

 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1. Interval string: The interval strings are the same strings used in the DateAddfunction. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2. Date Serial 1: The first date or time of the difference. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3. Date Serial 2: The second date or time of the difference. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4. First Day of the week: Specifies the day number of the first day of the week. This isused when using the “ww”, or week, interval string. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">a) Not specified: Sunday. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">b) 0: Local settings. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">c) 1: Sunday. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">d) 2: Monday. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">e) 3: Tuesday. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">f) 4: Wednesday. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">g) 5: Thursday. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">h) 6: Friday. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">i) 7: Saturday.</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5. First day of the year: Specifies what year a week will be associated withwhen the week spans years. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">a) 0: Local settings. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">b) 1: January 1 week. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">c) 2: First week having four days in the year. </font></font>



 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">d) 3: First full week of year.</font></font>

 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6. Return: Returns an integer value that represents the number of intervalsbetween the two date or time values. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following program illustrates the DateDiff function. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#Include Once &quot;vbcompat.bi&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Double Date1, Date2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Get current date </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Date1 = Now </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Get past date </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Date2 = DateValue(&quot;1/1/2006&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print out number of days since first of year '06 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Number of days since &quot;;Format(Date2, &quot;mm/dd/yyyy&quot;);&quot; is&quot;;DateDiff(&quot;d&quot;, Date2, </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Date1) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 13.3: datediff.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 3 includes the extended date and time functions contained in the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">vbcompat.bi include file. Line 5 dimensions two double-type variables to hold the currentand past date. Line 8 gets the current date and time. Line 10 uses the DateValue functionto convert the string date to a DateSerial value. Line thirteen prints the number of daysthat have elapsed since January 1, 2006. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should see output similar to the following. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Number of days since 01/01/2006 is 225 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 13.4: Output of datediff.bas </font></font>
</pre><h3 class="western">
	DatePart Function 
	</h3>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The DatePart function returns a specific part of a DateSerial, using the specifiedinterval. The function requires a DateSerial, the interval to return and optionally, the firstday of the week and the first day of the year. The function returns an integer valuerepresenting the specified interval. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">int_value = DatePart(interval_string, date_serial) </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">int_value </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">= DatePart(interval_string, date_serial, first_day_of_week) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">int_value </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">= DatePart(interval_string, date_serial, first_day_of_week, </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">first_day_of_year) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1. Interval string: The interval strings are the same strings used in the DateAddfunction. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2. Date Serial: A date or time serial number. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3. First Day of the week: Specifies the day number of the first day of the week. Thevalues are the same as those listed in the DateDiff function. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4. First day of the year: Specifies what year a week will be associated with when theweek spans years. The values are the same as those listed in the DateDiff function. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5. Return: Returns an integer representing the interval value. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following program illustrates using the DatePart function. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#Include Once &quot;vbcompat.bi&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Double myDate </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Get current date </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myDate = Now </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print date values </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Day number is&quot;;Datepart(&quot;d&quot;, myDate) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Week number is&quot;;Datepart(&quot;ww&quot;, myDate) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Month number is&quot;;Datepart(&quot;m&quot;, myDate) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print the current time numbers </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Hour is&quot;;DatePart(&quot;h&quot;, myDate) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Minutes are&quot;;DatePart(&quot;n&quot;, myDate) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">17 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Seconds are&quot;;DatePart(&quot;s&quot;, myDate) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">18 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">19 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">20 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 13.4: datepart.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 3 includes the extended date and time functions. Line 5 creates a </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">double-type varibale to hold the current date and time serial. Line 8 uses the Nowfunction to return the current system date and time. Line 11 prints the day number. Line12 prints the week number. Line 13 prints the month number. Line 15 prints the hournumber. Line 16 prints the minute number. Line 17 prints the second number. Theprogram is closed in the usual way. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should see something similar to the following. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Day number is 15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Week number is 33 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Month number is 8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Hour is 9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Minutes are 52 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Seconds are 58 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 13.5: Output of datepart.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The values you see will depend on the current date and time setting of your </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">computer. </font></font>
</pre><h3 class="western">
	DateSerial Function 
	</h3>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The DateSerial function will return a double-type DateSerial value based on thepassed year, month and day. The date value returned by DateSerial has no time </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">component. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">date_serial = DateSerial(year, month, day) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1. Year: The year component of the date. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2. Month: The month component of the date. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3. Day: The day component of the the date. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4. Return: Returns a DateSerial that is the value of the year, month and day </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">components. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following program illustrates using the DateSerial function. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#Include Once &quot;vbcompat.bi&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Double myDate </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Build a date serial using the Datepart function </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myDate = DateSerial(Datepart(&quot;yyyy&quot;, Now), Datepart(&quot;m&quot;, Now), _</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Datepart(&quot;d&quot;, Now)) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Current date is &quot;;format(myDate, &quot;mm/dd/yyyy&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 13.5: dateserial.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 3 includes the extended date and time functions in the program.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 5 dimensions a double-type variable which will contain the date serial value. Lines 8and 9 create a date serial using the Datepart function to extract the year, month and daycomponents from the current system date. Line 10 uses the Format function to print thedate to the console screen. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should see the current system date. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Current date is 08/15/2006 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 13.6: Output of dateserial.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Of course it is a bit silly to use the DatePart function when you could simply usethe Now function to return the current system date, but this program shows how bothfunction could be used together in a program. In a real program, the year, month and dayvalues would be probably be coming from an external source which would need to becombined to create a date serial that would then be used for a date calculation. </font></font>
</pre><h3 class="western">
	DateValue Function 
	</h3>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The DateValue function takes a string as it argument and returns a date serialvalue. The date string must be in the same format as the regional settings of the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">computer. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">date_serial = DateValue(date_string) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1. Date String: A date string in the current regional setting format. DateValue will onlyconvert a date string, not a time string. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2. Return: A DateSerial representing the date string. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following program illustrates using the DateValue function. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#Include Once &quot;vbcompat.bi&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Double myDate </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As String myDateStr </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create a date string value </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myDateStr = &quot;08/15/2006&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Get the serial date value </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myDate = DateValue(myDateStr) </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print the value </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Date string is &quot;;Format(myDate, &quot;mm/dd/yyyy&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 13.6: datevalue.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 3 includes the extended date and time functions. Line 5 creates a </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">double DateSerial variable that will contain the converted value. Line 6 defines a stringthat will hold the date string value. Line 9 initializes the string variable to a date format,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">using the US regional settings. This may have to be changed on your computer if you areusing a different setting. Line 11 creates a DateSerial from the string value. Line 13 printsthe value using the Format function. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should see the following output. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Date string is 08/15/2006 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 13.7: Output of datevalue.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If you run this program and get a strange date, then the regional settings on yourcomputer are different than what is shown in this program. For example, if your settinghas the year first, then you will need to change the string format to have the year first inthe string, rather than last. The DateValue function, used in conjunction with the IsDatefunction which is covered later in this chapter, is an easy way to get a date from the userwhich then can be used for date calculations. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Day Function </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Day function will return the day number from a DateSerial. The Day functiontakes a single date serial value and returns an integer representing the day number. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">int_value = Day(date_serial) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1. DateSerial: The date serial value. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2. Return: Integer value representing the day of the month. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Day function returns the same value as DatePart with the day intervalspecified. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Hour Function </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Hour function returns the current hour number from a TimeSerial value. The </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Hour function takes a single TimeSerial value, or a DateSerial value with a timecomponent and returns an integer that represents the hour. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">int_value = Hour(time_serial) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1. TimeSerial: The time serial value. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2. Return: Integer value representing the hour of the day. If the PM specifier is addedto the time value, the hour number returned will be in 24 hour format. That is, 1:00 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">PM will return 13. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following program illustrates using the Hour function. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 #Include Once &quot;vbcompat.bi&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 Dim As Double myTime </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 Dim As String myTimeStr </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 'Create a date string value </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 myTimeStr = &quot;1:10:23 pm&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 'Get the serial date value </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 myTime = TimeValue(myTimeStr) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 'Print the value </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 Print &quot;Hour is&quot;;Hour(myTime) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 13.7: hour.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 3 includes the extended date and time functions. Line 5 creates a </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">double-type TimeSerial variable. Line 6 creates a string variable to hold the string timevalue. Line 9 initializes the string variable to a time string. Line 11 converts ythe timestring to a TimeSerial using the TimeValue function. Line 13 prints the hour number of theTimeSerial. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should see the following output. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Hour is 13 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 13.8: Output of hour.bas </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Minute Function </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Minute function returns the minute number from a TimeSerial value. The </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Minute function takes a single TimeSerial value, or a DateSerial with a time component,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">and returns an integer representing the minute. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">int_value = Minute(time_serial) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1. TimeSerial: The time serial value. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2. Return: Integer value representing the minute of the hour. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Month Function </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Month function returns the month number from a DateSerial value. The Month </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">function takes a single DateSerial value and returns an integer representing the month. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">int_value = Month(date_serial) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1. DateSerial: The date serial value. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2. Return: Integer value representing the month of the year. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">MonthName Function </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The MonthName function returns a string representing the name of the month. TheMonthName function takes an integer representing the month, and an optional flag thatwill return a month abbreviation if set. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">string_value = MonthName(month_number) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">string_value = MonthName(month_number, abbreviate) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1. Month Number: An integer representing the month. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2. Abbreviate: A flag that indicates whether to return an abbreviated month name. Ifflag is 0, the full month will be returned. If the flag is 1, the abbreviated monthname will be returned. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3. Return: A string value representing the name of the month. The return value isbased on the current locale settings of the system. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following program illustrates using the MonthName function. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#Include Once &quot;vbcompat.bi&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer i </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 1 To 12 </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Month &quot;;Monthname(i);&quot; is abbreviated as &quot;;Monthname(i, 1) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 13.8: monthname.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 3 includes the extended date and time function. Line 5 dimensions </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">an integer variable for the following For-Next routine. The For-Next block in lines 7through 9 call the MonthName function to get the full name, and then is called a secondtime with the abbreviate flag set to 1 to get month abbreviation. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should see output similar to the following,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">depending on your local settings. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Month January is abbreviated as Jan </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Month February is abbreviated as Feb </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Month March is abbreviated as Mar </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Month April is abbreviated as Apr </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Month May is abbreviated as May </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Month June is abbreviated as Jun </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Month July is abbreviated as Jul </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Month August is abbreviated as Aug </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Month September is abbreviated as Sep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Month October is abbreviated as Oct </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Month November is abbreviated as Nov </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Month December is abbreviated as Dec </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 13.9: Output of monthname.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Now Function </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Now function returns a double-type value representing the current systemdate and time. The Now function takes no parameters. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">double_value = Now </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1. Return: A double value representing the current system date and time. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Second Function </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Second function returns an integer value representing the second number of aTimeSerial value, or a DateSerial with a time component. The Second function takes asingle TimeSerial value. </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">int_value = Second(time_serial) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3. TimeSerial: The time serial value. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4. Return: Integer value representing the second of the minute. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">TimeSerial Function </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The TimeSerial function will return a double-type TimeSerial value based on thepassed hour, minute and secondy. The time value returned by TimeSerial has no date </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">component. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">time_serial = TimeSerial(hour, minute, second) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1. Hour: The hour component of the time. The hour is passed in twenty-four format. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2. Minute: The minute component of the time. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3. Second: The second component of the the time. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4. Return: Returns a TimeSerial that is the value of the hour, minute and second </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">components. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The TimeSerial function works just like the DateSerial function, except that itreturns a time value rather than a date value. You can get both a date and time byadding a DateSerial value created with the DateSerial function to a TimeSerial valuecreated with the TimeSerial function. Since the date is contained within the integerportion of the DateSerial and the time is contained within the fractional portion of theDateSerial, you can combine the two values by simply adding them. The followingprogram illustrates this concept. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#Include Once &quot;vbcompat.bi&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Double ts, ds, cs </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Get a date serial </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ds = Dateserial(2006, 1, 10) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Get a time serial </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ts = Timeserial(13, 10, 42) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Combine the two </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">cs = ds + ts </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print values </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Date and time is &quot;;Format(cs, &quot;mm/dd/yyyy hh:mm:ss AM/PM&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">17 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 13.9: timedateserial.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 3 includes the extended date and time functions. Line 5 creates </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">three double-type values, ts which will be the time serial value, ds which will be the dateserial value and cs, which will be the combined date and time serial value. Line 8 gets thedate serial value using the DateSerial function. Line 10 gets the time serial value fromthe TimeSerial function. Line 12 adds the two values together to get a combined date andtime serial value. Line 14 uses the Format function to print both the date and time. TheAM/PM specifier is added to the time format string to convert the 24-hour value to a 12hour </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">value. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should see the following output. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Date and time is 01/10/2006 01:10:42 PM </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 13.10: Output of timedateserial.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">TimeValue Function </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The time value function will return a TimeSerial value from a string representingthe time value. The time string can contain either a 24-hour format such as “13:10:42” ora 12-hour format such as “01:10:42PM”. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">time_serial = TimeValue(time_string) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1. Time String: A time string in either 24 or 12-hour formats. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2. Return: A TimeSerial representing the time string. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Year Function </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Year function returns an integer value representing the year number of aDateSerial value. The Year function takes a single DateSerial value. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">int_value = Year(date_serial) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1. DateSerial: The date serial value. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2. Return: Integer value representing the year of the date serial value. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Weekday Function </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Weekday function returns the number of the day of the week. The Weekdayfunction takes a DateSerial value and an optional flag that represents the first day of theweek. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">int_value = Weekday(date_serial) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">int_value = Weekday(date_serial, first_day_of_week) </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1. DateSerial: The date serial value. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2. First Day of Week: A flag that represents the day number that is regarded as thefirst day of the week. The values are the same as those in the DateDiff function. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3. Return: Integer value representing the day of the week. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">WeekDayName Function </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The WeekDayName function returns a string that is the name of the day. TheWeekDayName function takes an integer representing the day of the week, an optionalflag that indicates whether to return an abbreviated name and an option flag thatindicates the first day of the week. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">int_value = WeekDayName(day_number) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">int_value = WeekDayName(day_number, abbreviate) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">int_value = WeekDayName(day_number, abbreviate, first_day_of_week) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1. Day Number: The day number. The day number is interpreted by the first-day-ofthe-</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">week setting. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2. Abbreviate: If this flag is 1, the function will return an abbreviated name, if 0 thenthe full name is returned. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3. First Day of Week: A flag that represents the day number that is regarded as thefirst day of the week. The values are the same as those in the DateDiff function. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4. Return: A string value that represents the name of the day of the week. The dayname is based on the computer's locale setting. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The function works juts like the MonthName function with the added first-day-ofthe-</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">week setting. </font></font>
</pre><h2 class="western">
	A Look Ahead 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Once you have created the data in your program, whether it be numeric, date ortime data, you will at some point need to format that data. The Format function has allthe capability you need to format these data types, and is the subject of the nextchapter. </font></font>

</pre>
</div>
<div id="The Format Function " dir="ltr" href="../fbeginnerm17.odt">
	<h1 class="western" style="page-break-before: always">Chapter 14 The
	Format Function 
	</h1>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Format function is a general purpose formatting function that can handle awide range of numeric values. Once you understand the capabilities of the function, youwill find yourself using this function for all your formatting routines. The Format functioncan handle simple numeric data, date and time values. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">string_value = Format(numeric_value, format_string) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The numeric value parameter can any of the numeric values available in FreeBasic.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The format string contains format characters that specify how to format the numericvalue. If the Format string is an empty string, then Format behaves just like the Strfunction. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">String Format Characters </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You can display text within the format string using the general formatting string.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following table lists the string format characters. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Character Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">: ? + $ () space Will return as a literal string. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">\ Will return the next character in the stringas a literal character. </font></font>
“<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">text” Will return text within double quotes as aliteral string. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">: Used as a separator for time components. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">/ Used as a separator for date components. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 14.1: String Format Characters </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The values listed in the table will return as literal text, and can be used to generatea string that contains both literal characters and formatted numeric text. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Numeric Format Characters </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">There are a number of format characters that can be used to format simplenumeric types. The following table lists the format characters. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Character Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">0 (zero) The zero is a digit placeholder. How thenumber is formatted depends on how manyzeros are in the format string and howmany numbers on either side of the </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Character Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">decimal point of the number. If there arefewer digits than 0's, a leading or trailingzero are added to the format string. If thereare more digits to the right of the decimalthan there are 0's, then the number is </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">rounded. The number to the left of the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">decimal are not changed. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt"># This format character works in the same </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">way as the 0 character, except the leadingor trailing zeros are not displayed. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">. (decimal point) Will return a decimal point within theformated string. If the format string onlyhas #'s to the left of the decimal point, thennumbers smaller than 1 will be displayedwith only a leading decimal point. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">% Will multiply number by 100 and returnpercentage sign. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">, (comma) The comma is used as the thousands </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">separator. Two adjacent commas, or acomma right after the decimal point, willnot display the thousands digits and willround the number. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">E- E+ e- e+ These characters are used to format a </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">string in scientific format. Placing a 0 or #</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">to either the left or right of the characterdetermines the number of digits to displayon either side of the exponent sign. Thenegative characters are used to displaynegative exponents and the positivecharacters are used to display positive </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">exponents. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 14.2: Numeric Format Characters </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As you can see from the character table, there is a wide range of formattingoptions available for formatting numeric data. The following program demonstrates howto use some of the formatting options. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#Include Once &quot;vbcompat.bi&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Double myValue = 123456.789 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Value: &quot;;Format(myValue) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print various format string </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Value as currency: &quot;;Format(myValue, &quot;$###,###,###.##&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">myValue = .10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Value: &quot;;Format(myValue) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Value as scientific: &quot;;Format(myValue, &quot;###E+###&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Value with zeros: &quot;;Format(myValue, &quot;00.0000&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Value as percentage: &quot;;Format(myValue, &quot;##%&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">17 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 14.1: format-numeric.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 3 includes the extended date and time function library which alsoincludes the Format function. Line 5 creates a double value that will be used as the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">numeric value in the formatting expressions. Line 7 prints the unformatted value. Line 9prints the value as a currency value using the $ with commas used to separate thethousand places and two # characters after the decimal point to round the value. Line 10sets the double variable to .1 for different formatting. Line 11 prints the unformattedvalue. Line 12 prints the value in scientific format. Line 13 prints the value with leadingand trailing zeros. Line 14 prints the value as a percentage. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should see the following output. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Value: 123456.789 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Value as currency: $123,456.79 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Value: .1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Value as scientific: 100E3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Value with zeros: 00.1000 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Value as percentage: 10% </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 14.1: Output of format-numeric.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Date Format Characters </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In the previous chapter you saw some of the date format characters used in theexample programs. The following table lists all the date format Characters and theirmeaning. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Character Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">d Returns the day of the month withoutleading zeros. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">dd Returns the day of the month with leading </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">zeros. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ddd Returns the day of the week name as anabbreviation. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Character Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">dddd Returns the day of the week name as a full </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">name. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ddddd Returns the serial date formatted accordingthe locale setting. Includes the year, monthand day. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">m Returns the month number without leading </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">zeros. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">mm Returns the month number with leadingzeros for single month numbers. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">mmm Returns the month name as an </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">abbreviation. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">mmmm Returns the month name as a full name. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">y Returns the year number formatted as twodigits. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">yyyy Returns the year number formatted as fourdigits. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 14.3: Date Format Characters </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following program demonstrates some of the formatting options for dates. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#Include Once &quot;vbcompat.bi&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Double myDate = Now </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print some formatted dates </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Date Serial: &quot;;Format(myDate, &quot;ddddd&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Date with single chars: &quot;;Format(myDate, &quot;d/m/yy&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Date with double chars: &quot;;Format(myDate, &quot;dd/mm/yyyy&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Date with year first: &quot;;Format(myDate, &quot;yyyy/mm/dd&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Date with (): </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">&quot;;Format(myDate, &quot;ddmmyyyy&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Date with ( ): &quot;;Format(myDate, &quot;dd mm yyyy&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 14.2: format-date.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 3 includes the date-time and format library definition. Line 5 createsa date serial values and initializes it to the current date and time using the Now function.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 8 prints the serial date using the local settings. Line 9 prints the date as single </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">month and day values with a two-digit year. Line 10 prints the date with two-digit monthand day values and a four-digit year. Line 11 prints the date with the year first. Line 12using a dash to separate the date components and line 13 uses a space to separate thedate components. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should see the following. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Date Serial: 8/16/2006 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Date with single chars: 16/8/06 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Date with double chars: 16/08/2006 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Date with year first: 2006/08/16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Date with (): </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16082006 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Date with ( ): 16 08 2006 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 14.2: Output of format-date.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Time Format Characters </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The time format characters are similar to the date format characters and are used </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">in much the same way. The following table lists the format characters that you can usewith a TimeSerial value. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Character Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">h Returns the hour without a leading zero. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">hh Returns the hour with a leading zero forsingle digit hour numbers. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">m Returns the minute without a leading zero. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">mm Returns the minute with a leading zero forsingle digit minute numbers. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">s Returns the second without a leading zero. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ss Returns the second with a leading zero forsingle digit second numbers. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ttttt Returns a TimeSerial value formatted as the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">local specific time format. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">AM/PM </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">am/pm </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Converts the time to a 12-hour format and </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">adds an am or pm to the return value. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">A/P </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">a/p </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Converts the time to a 12-hour format ans </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">adds an a or p the return value. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 14.4: Time Format Characters </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following program demonstrates some ways to format a time value. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">#Include Once &quot;vbcompat.bi&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Double myTime = Timeserial(8, 1, 1) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print some formatted times </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Time Serial: &quot;;Format(myTime, &quot;ttttt&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Time with single chars: &quot;;Format(myTime, &quot;h:m:s&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Time with double chars: &quot;;Format(myTime, &quot;hh:mm:ss&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Time with am/pm: &quot;;Format(myTime, &quot;hh:mm:ss am/pm&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Time with a/p: &quot;;Format(myTime, &quot;hh:mm:ss a/p&quot;) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 14.3: format-time.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 3 includes the extended date and time library. Line 5 creates a timeserial value using the TimeSerial function. Line 8 prints the time using the TimeSerialformat. Line 9 prints the time using single-digit characters. Line 10 prints the time usingtwo-digit characters. Line 11 prints the time as in 12-hour format using the AM/PMformat, and line 12 also prints the time in a 12-hour format with the a/p format. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should see the following output. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Time Serial: 8:01:01 AM </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Time with single chars: 8:1:1 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Time with double chars: 08:01:01 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Time with am/pm: 08:01:01 am </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Time with a/p: 08:01:01 a </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 14.3: Output of format-time.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Format function has a tremendous amount of functionality, and when workingwith numeric data, it is an invaluable resource in formatting. You should some time tobecome acquainted with this function as it will save you lot of time when you need toformat your data. </font></font>
</pre><h2 class="western">
	</h2>
</div>
<div id=" Introduction to the C Runtime Library " dir="ltr" href="../fbeginnerm7.odt">
	<h1 class="western" style="page-break-before: always">Chapter 4
	Introduction to the C Runtime Library 
	</h1>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">One of the original motivations for creating FreeBasic was to provide an easy-to use </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">wrapper for the C Runtime Library according to Andre Victor, the language creator.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">FreeBasic is as advanced as it is today because many of the functions are wrappers for the run time functions, which simplified the creation of the language. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Since FreeBasic uses the C run time library, you can use it as well in your programs,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">and there are a number of very useful conversion functions available. The function definitions are contained in the header file crt.bi, and you gain access to those functions by using the #Include directive. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Caution Not all the functions listed in the various bi files in the crt folder </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">have been implemented in FreeBasic. If you get an error similar to the following[path/filename].o:fake:(.text+0x16c): undefined reference to `rint', where path/filename is your program's path and filename, then the function you are trying to use is not supported.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">This is a linker error and indicates that the linker was not able to find the referenced </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">function. There are also a number of functions and structures that will only work in Windows and some that are GNU Extensions and will only work on Linux. </font></font>
</pre><h2 class="western">
	The #Include Directive 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The syntax for the #Include directive is #Include [Once] “filename.ext”. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Remember that a compiler directive instructs the compiler to do something, and in his case, it instructs the compiler to include the file “filename.ext” when compiling. When the compiler reads this directive, it stops reading the current file and starts reading the included file. If the included file also has an #Include directive, then that file is read in as </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">well. You can have up to 16 nested includes per program. To use the run time conversion functions in your own program you would add #Include Once “crt.bi” at the top of </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">your program. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The file extension bi stands for “basic include” and is usually declaration statements and/or subroutines and functions. The crt.bi file is located in the inc folder of </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">your FreeBasic installation. If a bi file is not located in the folder where the program is being compiled, the compiler will look in the inc folder for the file. If it can’t find the file, it will issue an error. You can also include a path with the filename if you keep your include files in a common folder besides the inc folder. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If you look at the contents of crt.bi you see that the file simply includes other files and references the library that contains the actual function code. </font></font>
</pre><p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">#ifndef __CRT_BI__ </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">#define __CRT_BI__ </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">#ifdef __FB_WIN32__ </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">#inclib &quot;msvcrt&quot; </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">#endif </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	 
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">#include once &quot;crt/string.bi&quot;
	</font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">#include once &quot;crt/math.bi&quot;
	</font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">#include once &quot;crt/time.bi&quot;
	</font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">#include once &quot;crt/wchar.bi&quot;
	</font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">#include once &quot;crt/stdlib.bi&quot;
	</font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">#include once &quot;crt/stdio.bi&quot;
	</font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">#include once &quot;crt/io.bi&quot;
	</font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">#include once &quot;crt/errno.bi&quot;
	</font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">#endif ' __CRT_BI__ </font>
	</p>
	<p style="margin-left: 0.15in; margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 4.1: crt.bi </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Crt.bi contains a number of compiler directives, the statements that start with the # character to control the compilation process. In line the directive #ifndef means “if not defined”. If the symbol __CRT_BI__ has not already been defined, then line2 will define the symbol. The #ifdef directive in line 4 means “if defined”. If the compiler is running on a Win32 machine, the symbol __FB_WIN32__ will be defined which will include the library &quot;msvcrt&quot; on line 5 with the #inclib directive which means “include library”. The #endif on line 6 closes the opening #ifdef on line 4. Under Windows,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">FreeBasic uses the Microsoft Runtime which is contained in the dynamic link library (DLL)</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">msvcrt.dll. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 8 through 15 include each of the individual declaration files that make up the C run time library. The “#include once” directive ensures that the individual include files are only added once, even if another module includes them. The #endif on line 17 is used to close the #ifndef on line 1. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Notice that the #Include directive use the Once modifier which tells the compiler that this file should only be loaded once, even if a subsequent file uses the same#Include. This is to prevent duplicate definition errors. It is always good practice to use the Once modifier in your own includes. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Notice that the different files being included are located in the inc/crt folder. This is an example of setting the path for the #Include if they should be in a different folder.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Many of the third-party library bi files are in their own sub folders, just to keep things a bit more organized. The conversion functions we will be examining in this chapter are contained the file crt/math.bi. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The #Inclib directive above the include list tells the compiler what library contains the functions. Library files are compiled subroutines, functions and symbols that define the functionality of the library. Lib files located in the lib folder of your FreeBasic installation.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">They are usually named filename.a for static libraries and filename.dll.a for dynamic link libraries. If you look in the lib folder you will also see some filename.o files. These are object files. Object files contain pre-parsed code that can be linked to an executable file or to a library file. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Caution If you open one of the bi files in the inc folder, which you may need to do from time to time to see what parameters a function requires or to see the return type of </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">a function, be sure not to change anything in the file. You should always open the files in read-only mode if your editor provides that functionality. </font></font>
</pre><h2 class="western">
	The Declaration Statement 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If you look at math.bi you will see a number of Declaration statements. A declaration statement is a function prototype that tells the compiler that there is a function definition somewhere in the program code, or in a library or an external dll. This forward reference is used so that the compiler won’t complain if the function or sub is called before it finds the actual code for the function. Once you understand how to interpret a declaration statement, you will be able to use any function in the run time library. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">To understand the components of a declaration statement, here is the declaration statement for the ceil function in math.bi. The ceil function rounds a decimal value up to the nearest integer. That is, 1.5 would become 2. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Declare function ceil cdecl Alias &quot;ceil&quot; (byval as double) as double </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You can break this declare down into the following functional sections. </font></font>

• <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Declare: This is the keyword for a declare statement. </font></font>
• <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function: This can either be Function, to indicate that this procedure returns a value, or Sub, which indicates that the procedure does not return a value. </font></font>
• <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Ceil: This is the name of the function and the name that you would use in your code. Do not use the name after Alias. </font></font>
• <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Cdecl: This is the function's method of passing arguments. When calling an </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">external function, parameters must be pushed on the stack in the correct order so that the function can pop the parameters off the stack correctly. Cdecl stands for C Declare, and passes the arguments from right to left using the C convention of parameter passing. The Pascal calling convention pushes arguments from left to right and is used when calling functions created in the Pascal language. The Std call calling convention pushes arguments from right to left and is used in Basic libraries and Windows API. </font></font>
• <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Alias: This is an alternate name that is used by the linker when your code is linked to other languages. You use an alias in case there is a function in the target language that has the same name as your function. </font></font>
• <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">(): The values inside the parenthesis are the parameters that the function or sub expects. Ceil expects one parameter, a double-type value. If the function expects multiple parameters, then commas will separate them. A parameter can be any of the FreeBasic data types or a composite type. Many of the run time functions require pointers to other data types or data structures. </font></font>
• <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ByVal: The byval (by value) keyword indicates that the value being passed to the function is a copy of the data, and not the actual data itself. This is to prevent accidentally changing the actual data within a function. You can also use ByRef(by reference) which passes the address of the data to the function, and any changes in the parameter are reflected in the actual data. ByVal is the default behavior in current versions of the compiler. </font></font>

• <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As [data type]: The As keyword after the parameter list indicates the return typeof the function. Subs do not have a return type so there isn’t an As clause after the parameter list. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Notice that the ceil function returns a double and not an integer, even though the conversion function rounds off the decimal portion. This is to prevent integer overflow for very large numbers. Even though ceil, and the other run time conversion functions return a double you can implicitly convert them to integers by simply assigning the return to an integer variable or using the Cast function. Be sure to use an integer data type with a large enough range for the result. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">To use Ceil in your program you would write myDouble = Ceil(aDouble) or myInt = </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Ceil(aDouble). All declaration statements follow the same pattern as Ceil. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">DLLs created with Visual Basic 6tm and below are COM objects and not standard DLLs. In order to use VB6 DLLs with FreeBasic you will need to create a COM interface to access the DLL functions. Creating a COM interface is a complicated topic and is beyond the scope of this book. </font></font>
</pre><h2 class="western">
	Runtime Conversion Functions 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 5.1 lists some of the more useful conversion routines contained within the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">run time library along with he syntax and some comments about the function. </font></font>
</pre>
	<table width="100%" cellpadding="4" cellspacing="0">
		<col width="85*">
		<col width="85*">
		<col width="85*">
		<tr valign="top">
			<td width="33%" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<p style="margin-top: 0.08in"><font size="3" style="font-size: 12pt"><i>Function</i></font></p>
			</td>
			<td width="33%" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<p style="margin-top: 0.08in"> <font size="3" style="font-size: 12pt"><i>Syntax
				</i></font>
				</p>
			</td>
			<td width="33%" style="border: 1px solid #000000; padding: 0.04in">
				<p style="margin-top: 0.08in"><font size="3" style="font-size: 12pt"><i>Comment
				</i></font>
				</p>
			</td>
		</tr>
		<tr valign="top">
			<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<p style="margin-top: 0.08in"><font size="3" style="font-size: 12pt"><i>Ceil
				</i></font>
				</p>
			</td>
			<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<p style="margin-top: 0.08in"><font size="3" style="font-size: 12pt"><i>B
				= Ceil(double-type expression) </i></font>
				</p>
			</td>
			<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<p style="margin-top: 0.08in"><font size="3" style="font-size: 12pt"><i>Ceil
				returns the nearest integer greater than expression. </i></font>
				</p>
			</td>
		</tr>
		<tr valign="top">
			<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<p style="margin-top: 0.08in"><font size="3" style="font-size: 12pt"><i>Floor
				</i></font>
				</p>
			</td>
			<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<p style="margin-top: 0.08in"><font size="3" style="font-size: 12pt"><i>B
				= Floor(double-type expression) </i></font>
				</p>
			</td>
			<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<p style="margin-top: 0.08in"><font size="3" style="font-size: 12pt"><i>Floor
				returns the nearest integer less than expression. </i></font>
				</p>
			</td>
		</tr>
		<tr valign="top">
			<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<p style="margin-top: 0.08in"><font size="3" style="font-size: 12pt"><i>Modf
				</i></font>
				</p>
			</td>
			<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<p style="margin-top: 0.08in"><font size="3" style="font-size: 12pt"><i>B
				= Modf(double-type expression, double-type pointer) </i></font>
				</p>
			</td>
			<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<p style="margin-top: 0.08in"><font size="3" style="font-size: 12pt"><i>Modf
				returns the fractions part of expression and the integer part of
				expression in the double-type pointer. The integer part of
				expression is rounded towards zero. </i></font>
				</p>
			</td>
		</tr>
	</table>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 4.1: Runtime Conversion Functions </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">It would require another book to examine all the functions in the run time library. The run time functions presented in this book were selected because of their usefulness and to supplement FreeBasic’s built-in functions. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Modf deserves special mention. A function can only return a single value, the value defined in the As clause after the parameter list. This does not mean however that you cannot return more than one value from a function. Any additional values a function returns must be returned through the parameter list. One way to do this is to use the Byref keyword on parameters. Any changes made to a byref parameter changes the actual data. However, you cannot use byref on external libraries, due to differences in </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">calling procedures, so pointers are used instead. There are two ways to pass pointer data to a function; by explicitly declaring a pointer data type which you will see in the chapter on pointers, or by using the Address Of operator which is explained here. </font></font>
</pre><h2 class="western">
	The Address Of Operator @ 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When the compiler creates a variable, it allocates a portion of memory equal to the size of the data type. For an integer it would allocate 4 bytes and for a double it would allocate 8 bytes. Each memory location has an address associated with it so that the CPU can move data into and out of the memory location. When the compiler allocates the memory, the operating system returns an address for the memory location so that the compiler can access that location. When you are working with variables you are actually working with an addressable memory location in the computer. You don't have to worry about the address since the compiler handles all those details for you; you can just use the variable in your program. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">However, when you need to call a function like Modf that requires a pointer to a variable, then you need to know the address of the variable so you can pass it to the function. Why can't you just use the variable name, since it is an alias for the memory location? The answer is in the declaration of Modf shown in listing 5.3. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">declare function modf cdecl alias &quot;modf&quot; (byval as double, byval as double ptr) as double </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 4.2: Modf Declaration </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Notice that the second parameter is defined as byval and the data type is a pointer(ptr) to a double-type variable. Remember that byval means “make a copy of the contents of the parameter and use it in the function.” If you were to simply use the variable name, you would be passing the contents of the memory location, whatever is in the variable,and not its address. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you use a regular variable in your program, you are working with the actual data in the memory location associated with the variable. That is, a variable = data. If you define myInt as an integer and set it equal to 5, when you print myInt to the screen you will see 5. The pointer data type is unique in that what it contains isn't data, that is a value like 134, rather it contains the address of a memory location. A pointer = memory address. If you were to print a pointer to the screen you would see a number that doesn't make much sense, since what you are looking at isn't the data in the memory location,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">but the address of the data in memory. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you first create a pointer, it doesn't point to anything. This is called a Null pointer. There are a number of ways to initialize the pointer, but one method is to use the Address Of operator. If you create a pointer variable such as myIntPtr you could initialize that pointer with code like myIntPtr = @myInt. The @ is the Address Of operator, and this code snippet sets myIntPtr to the address of myInt. In other words, an initialized pointer variable and the Address Of operator both return the same value, a memory address. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">We can use this concept in the Modf function. Rather than creating a pointer variable, we can create a double-type variable and then use this variable with the Address Of operator for the return parameter. Remember that you were able to use expressions with the built-in numeric conversion functions. Using the Address Of operator with a variable is an expression which will be evaluated and the result, the variable address, will be passed along to the function. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following short program illustrates this concept. </font></font>

</pre>
	<ol>
		<li/>
<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
		     <font face="Courier New, monospace">'Need to include the run
		time library </font>
		</p>
		<li/>
<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
		     <font face="Courier New, monospace">#include &quot;crt.bi&quot;
		</font>
		</p>
		<li/>
<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
		</p>
		<li/>
<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
		     <font face="Courier New, monospace">'Set up some variables </font>
		</p>
		<li/>
<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
		     <font face="Courier New, monospace">Dim As Double myDouble,
		FracPart, IntPart </font>
		</p>
		<li/>
<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
		</p>
		<li/>
<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
		     <font face="Courier New, monospace">'Set the value we want to
		convert </font>
		</p>
		<li/>
<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
		     <font face="Courier New, monospace">myDouble = 12.56 </font>
		</p>
		<li/>
<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
		     <font face="Courier New, monospace">'Call the function. Notice
		that we are using the address of </font>
		</p>
		<li/>
<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
		<font face="Courier New, monospace">'operator @ on IntPart. </font>
		</p>
		<li/>
<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
		<font face="Courier New, monospace">FracPart = modf(myDouble,
		@IntPart) </font>
		</p>
		<li/>
<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
		<font face="Courier New, monospace">'Get the result. </font>
		</p>
		<li/>
<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
		<font face="Courier New, monospace">Print &quot;myDouble =
		&quot;;myDouble </font>
		</p>
		<li/>
<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
		<font face="Courier New, monospace">Print &quot;Fractional
		part:&quot;;FracPart </font>
		</p>
		<li/>
<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
		<font face="Courier New, monospace">Print &quot;Integer
		part:&quot;;IntPart </font>
		</p>
		<li/>
<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
		</p>
		<li/>
<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
		<font face="Courier New, monospace">Sleep </font>
		</p>
		<li/>
<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
		<font face="Courier New, monospace">End </font>
		</p>
	</ol>
	<p style="margin-left: 0.15in; margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 4.3: addressof.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: In line 1 the crt.bi is included in this program so that all the supported functions will be available to the program. In line 5 all of the working variables are declared. In line 8, the variable to be operated on is set to a decimal value. The Modf function is called in line 11 using the Address Of operator to retrieve the integer portion of the return value. The fractional portion of the return value is loaded into the FracPart variable. Line 13 through 15 print out the values returned from the function. The program is closed in the usual way in lines 17 and 18. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In line 5 we dimension the variables we will use: myDouble is the value we want to convert, FracPart is the value returned by the function and IntPart is the return value that will be passed through the second parameter, the pointer. Notice in line 11 we are using the Address Of operator in conjunction with our regular double-type variable. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Here is the output of the program. </font></font></pre><p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">myDouble = 12.56 </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">Fractional part:
	0.560000000000001 </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">Integer part: 12 </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 4.1: addressof.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The return value of the function, .56, is the fractional part and the integer part 12,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">is the value returned through the parameter. The series of zeros ending in a 1 after the </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">.56 is the result of the precision conversion you will get with a double value. Remember in the previous sections it was mentioned that double and single data types are prone to rounding errors. Here you see why this is true. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Caution When you are dealing with a pointer parameter, you must be sure to pass the correct data type to the parameter. In the case of Modf, it is expecting a double-type pointer which is 8 bytes. If you pass the incorrect pointer type to a function, it may not do anything at all, or it may try to write to 8 bytes of memory. If the function tries to write to more memory than has been allocated you will see the infamous General Protection Fault message and your program will be shut down. Always use the proper pointer type with pointer parameters. General Protection Fault is a Windows term and is equivalent to a Segmentation Fault on Linux. </font></font>
</pre><h2 class="western">
	Testing the Runtime Conversion Functions 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As you did with the other conversion functions, you should test these functions with both positive and negative numbers to see how they behave. </font></font>

 </pre><p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">'Need to include the run time
	library </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	 <font face="Courier New, monospace">#include &quot;crt.bi&quot; </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	 
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">'Set up some variables </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Dim As Double myDouble = 12.56,
	myDouble2 = 12.56 </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	 
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">'Show the various conversion
	functions with </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">'positive and negative numbers. </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Print &quot;Ceil
	with&quot;;myDouble;&quot; returns &quot;;Ceil(myDouble) </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Print &quot;Ceil with
	&quot;;myDouble2;&quot; returns &quot;;Ceil(myDouble2) </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Print </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Print &quot;Floor
	with&quot;;myDouble;&quot; returns &quot;;Floor(myDouble) </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Print &quot;Floor with
	&quot;;myDouble2;&quot; returns &quot;;Floor(myDouble2) </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Print </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">'Wait for a key press </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Sleep </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">End </font>
	</p>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 4.4: crtfunc.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Since these are C run time functions, the crt.bi is included in line 2. Line 5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">shows the declaration of the working variables in the program, once again using the alternate Dim syntax. Lines 9 through 14 print out the return values of the functions with both positive and negative numbers. Lines 17 and 18 close the program. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 2 in the program includes the crt.bi which is required for using any of the run time functions. In line 5 the two working double-type variables are dimensioned and initialized. As you can see, calling the run time functions is exactly the same as calling any of the FreeBasic built-in functions. Running the program will produce the following </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">output. </font></font>
</pre><p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">Ceil with 12.56 returns 13 </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">Ceil with 12.56 </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">returns 12 </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">Floor with 12.56 returns 12 </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">Floor with 12.56 </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">returns 13 </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 4.2: crtfunc.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As you can see in the output, Ceil returns the nearest integer greater than the value. 13 is greater than 12 and -12 is less negative than -12.56. Floor does just the opposite; it returns the nearest integer less than the value. 12 is less than 12.56 and -13is more negative than -12.56. </font></font>
</pre><h2 class="western">
	A Look Ahead 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Normally when you use numbers in your program, you are going to do some sort of calculation with them. In the next chapter you will see FreeBasic's arithmetic operators,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">learn about operator precedence and explore the bits that make up a number. </font></font>

</pre><h2 class="western">
	Exercises 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1) What is the extension of files that normally contain function declarations for libraries? </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2) What is the difference between the Ceil() and Floor() functions in the C run time library? </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3) What compiler directive is used to add additional files before compilation? </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4) What is a common cause of a Segmentation Fault or General Protection Fault? </font></font>
</pre>
</div>
<div id="Mathematical Functions" dir="ltr" href="../fbeginnerm10.odt">
	<h1 class="western">Chapter 7 Mathematical Functions 
	</h1>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">FreeBasic has a number of mathematical functions which are listed in the following </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">table.</font></font>
 </pre>
	<table width="666" cellpadding="4" cellspacing="0" style="page-break-after: avoid">
		<col width="213">
		<col width="214">
		<col width="214">
		<tr valign="top">
			<td width="213" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function</font></font></pre>
			</td>
			<td width="214" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"> <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Syntax </font></font></pre>
			</td>
			<td width="214" style="border: 1px solid #000000; padding: 0.04in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Comments </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="213" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ABS (Absolute Value)</font></font></pre>
			</td>
			<td width="214" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"> <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Abs(expression) </font></font></pre>
			</td>
			<td width="214" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Returns the unsigned value of expression. This is an overloaded function so  expression can resolve to an integer, longint or double. </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="213" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ACOS (ArcCosine) </font></font></pre>
			</td>
			<td width="214" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Acos(expression) </font></font></pre>
			</td>
			<td width="214" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Returns the ArcCosine of a double-type expression in radians. Expression must bein the range of -1 to 1. </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="213" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ASIN (ArcSine) </font></font></pre>
			</td>
			<td width="214" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Asin(expression)</font></font></pre>
			</td>
			<td width="214" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"> <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Returns the ArcSine of a double-type expression in radians. Expression must bein the range of -1 to 1. </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="213" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ATAN2 (ArcTangent of Ratio) </font></font></pre>
			</td>
			<td width="214" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Atan2(expression V, expression H) </font></font></pre>
			</td>
			<td width="214" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Returns the ArcTangent of of ratio of double-type expression1 / expression2 in radians. Expression V is the vertical component and expression H is the horizontal component, where both expressions are double-type values. </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="213" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ATAN (ArcTangent)  </font></font></pre>
			</td>
			<td width="214" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B =Atan(expression) </font></font></pre>
			</td>
			<td width="214" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Returns the ArcTangent of a double-type expression in radians. Expression must be in the range of -Pi/2 to Pi/2. </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="213" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"></pre>
			</td>
			<td width="214" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"></pre>
			</td>
			<td width="214" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<p><br/>

				</p>
			</td>
		</tr>
		<tr valign="top">
			<td width="213" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"></pre>
			</td>
			<td width="214" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<p><br/>

				</p>
			</td>
			<td width="214" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<p><br/>

				</p>
			</td>
		</tr>
		<tr valign="top">
			<td width="213" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">COS (Cosine)</font></font></pre>
			</td>
			<td width="214" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"> <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Cos(expression)</font></font></pre>
			</td>
			<td width="214" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"> <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Returns the Cosine of a double-type expression in radians. Expression must bein the range of -1 to 1 and is the angle measured in radians. </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="213" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">EXP (E Exponent)</font></font></pre>
			</td>
			<td width="214" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"> <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Exp(expression)</font></font></pre>
			</td>
			<td width="214" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"> <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Returns e (approx 2.716) raised to the power of a double-type expression. </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="213" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">LOG (Logarithm)</font></font></pre>
			</td>
			<td width="214" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"> <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Log(expression) </font></font></pre>
			</td>
			<td width="214" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Returns the natural Logarithm (base e) ofa double-type expression. </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="213" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">SGN (Sign) </font></font></pre>
			</td>
			<td width="214" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Sgn(expression)</font></font></pre>
			</td>
			<td width="214" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"> <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Returns the sign of a double-type expression. If expression is greater than 0then Sgn returns a 1. If expression is 0, then Sgn returns 0. If expression is less than 0, then Sgn return -1. </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="213" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"></pre>
			</td>
			<td width="214" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<p><br/>

				</p>
			</td>
			<td width="214" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<p><br/>

				</p>
			</td>
		</tr>
		<tr valign="top">
			<td width="213" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">SIN (Sine)</font></font></pre>
			</td>
			<td width="214" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"> <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Sin(expression)</font></font></pre>
			</td>
			<td width="214" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"> <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Returns the Sine of a double-type expression in radians. Expression must bein the range -1 to 1. </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="213" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">SQR (Square Root)</font></font></pre>
			</td>
			<td width="214" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"> <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Sqr(expression) </font></font></pre>
			</td>
			<td width="214" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Returns the square root of a double-type expression. Expression must be greater than or equal to 0.</font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="213" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">TAN (Tangent)</font></font></pre>
			</td>
			<td width="214" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Tan(expression) </font></font></pre>
			</td>
			<td width="214" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<p style="margin-bottom: 0in"> <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Returns
				the Tangent of a double-type expression in radians. Expression is
				the angle measured in radians. </font></font>
				</p>
				<pre class="western"></pre>
			</td>
		</tr>
	</table>
	<p style="margin-top: 0.08in"><font size="3" style="font-size: 12pt"><i>Table
	3: </i></font>
	</p>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function Syntax Comments </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 7.1: Mathematical Functions </font></font>
</pre><h2 class="western">
	Trigonometric Functions 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">All of the trigonometric functions return the measured angle in radians not degrees. To convert degrees to radians you would use the formula radian = degree * PI /</font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">180. To convert radians to degrees you would use the formula degree = radian * 180 / PI.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">PI is the ratio of the circumference of a circle to its diameter and can be calculated using the Atn function with the formula PI = 4 * Atn(1.0). The following short program converts an angle in degrees to an angle in radians. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1Option Explicit </font></font>
 </pre><p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font color="#408080"><font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">'Calc
	the value of Pi </span></b></font></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent"><font color="#008000">Const</font><font color="#000000">
	Pi </font><font color="#666666">=</font><font color="#000000"> </font><font color="#666666">4</font><font color="#000000">
	</font><font color="#666666">*</font><font color="#000000"> Atn(</font><font color="#666666">1</font><font color="#000000">)
	</font></span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent"><font color="#008000">Dim</font><font color="#000000">
	</font><font color="#aa22ff">As</font><font color="#000000"> </font><font color="#b00040">Double</font><font color="#000000">
	deg, rad </font></span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font color="#408080"><font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">'Get
	the angle in degrees </span></b></font></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent"><font color="#000000">Input
	</font><font color="#ba2121">&quot;Enter an angle in degrees&quot;</font><font color="#000000">;deg
	</font></span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font color="#408080"><font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">'Calculate
	the radian </span></b></font></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent"><font color="#000000">rad
	</font><font color="#666666">=</font><font color="#000000"> deg </font><font color="#666666">*</font><font color="#000000">
	Pi </font><font color="#666666">/</font><font color="#000000"> </font><font color="#666666">180</font><font color="#000000">
	</font></span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font color="#408080"><font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">'Print
	out the values </span></b></font></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font color="#000000"><font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">Print
	</span></b></font></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent"><font color="#000000">Print
	</font><font color="#ba2121">&quot;Pi:&quot;</font><font color="#000000">;Pi
	</font></span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent"><font color="#000000">Print
	</font><font color="#ba2121">&quot;Degrees:&quot;</font><font color="#000000">;deg
	</font></span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent"><font color="#000000">Print
	</font><font color="#ba2121">&quot;Radians:&quot;</font><font color="#000000">;rad
	</font></span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font color="#000000"><font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">Sleep
	</span></b></font></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent"><font color="#008000">End</font><font color="#000000">
	</font></span></b></font></font>
	</p>
	<pre class="western">

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 7.1: degrad.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: In line 4 a symbolic constant is declared for PI using the Atn function. Line </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 declares the working variables. In line 9, the user inputs the degrees to convert to radians. Line 12 calculates the radian angle based on the conversion formula listed above. Lines 15 through 18 print out the various values. The program is then ended in the usual way. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Running the program will produce the following output. </font></font>
</pre><p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">Enter an angle in degrees? 90 </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">Pi: 3.14159265358979 </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">Degrees: 90 </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">Radians: 1.5707963267949 </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 7.1: Output of degrad.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">There are a number of on-line tutorials that you can access to brush up on your trig. A quick Google search on the term trigonometry brought up hundreds of sites that offer basic to advanced tutorials on the various trig functions that FreeBasic supports. Randy Keeling has written two basic tutorials on trigonometry in the Community Tutorials section of the FreeBasic wiki. At the time of this writing, the wiki was located at http://www.freebasic.net/wiki/wikka.php?wakka=FBWiki. </font></font>
</pre><h2 class="western">
	Absolute Value and the Sgn Function 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You would use the Abs function when you are interested in the absolute magnitude of a number. The absolute value of a number is the distance that number is from zero on </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">the real number line. 3 is three units from 0 so its absolute magnitude is 3. -3 is alsothree units from 0 so its absolute magnitude is also 3. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Sgn function, called the signum function in math, is related to the Abs function since you can express the absolute value of a number by using the Sgn function. Sgn returns -1 for a negative number, 0 for 0 and 1 for a positive number. To calculate the absolute value of a number you would use the formula |a| = a * Sgn(a), where the vertical lines indicate absolute value. If we replace a with -3 in the formula, you get |-3| =-3 * Sgn(-3), or |-3| = -3 * -1. Since multiplying a negative with a negative returns a positive, the result is |-3| = 3. Replacing a with 3, the formula would evaluate to |3| = 3 * </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1, or |3| = 3. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">One use of the Sgn function in programming is determining the relative positions of two points on the screen. If you have two points, A(5, 6,) and B(3, 4), where the first number is the row and the second number is the column, you can determine the relative position by moving the origin to point A and looking at the sign of point B. The origin (0,0) of the screen is located in the upper left corner. To move the origin to point A you need to subtract 5 from the row and 6 from the column of each point giving A(0, 0) and B(-2,-2). You can now use the Sgn function on the row and column components of B. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If Sgn(B.row) = -1, then the row is above A. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If Sgn(B.row) = 0, then the row is in the same row as A. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If Sgn(B.row) = 1 then the row is below A. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If Sgn(B.column) = -1 then the column is to the left of A. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If Sgn(B.column) = 0 then the column is in the same column as A. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If Sgn(B.column) = -1 then the column is to the right of A. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Since B is located at row -2 and column -2 after adjusting the origin, the Sgnfunction will return -1 for the row and -1 for the column. This puts point B above and to the left of of point A. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Logarithms </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Logarithms have a wide range of uses in mathematics, physics and biology. For example, the decay rate of radioactive particles is logarithmic in nature. Logarithms are away of expressing exponentiation. For the following formula Ab = x can be expressed as Log(x) = b where the base of the log is a. The two most commonly used logarithms are the natural log, which uses e (2.7182818284590452354...) as the base, and log base 10or the common log. The Log function in FreeBasic uses the natural log, but any log base can be expressed by the formula logarithm = Log(number) / Log(base)2. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">One property of logarithms is that they can be used to multiply or divide two numbers together. This was a common use of logarithms before the invention of calculators. The following program uses the logarithm method to multiply two numbers together. </font></font>
</pre><p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> </span>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Option Explicit </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Const base10 = Log(10) </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	 
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	 
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace">Dim As Double l1, l2, lt, al </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	 
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	 
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font color="#408080"><font face="Courier New, monospace">'Calculate
	the log of 2.5 for base 10 </font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font color="#000000"> </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace"><font color="#000000">l1 </font><font color="#666666">=</font><font color="#000000">
	Log(</font><font color="#666666">2.5</font><font color="#000000">) </font><font color="#666666">/</font><font color="#000000">
	base10 </font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font color="#000000"> </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font color="#408080"><font face="Courier New, monospace">'Calculate
	the log of 5.6 for base 10 </font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font color="#000000"> </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace"><font color="#000000">l2 </font><font color="#666666">=</font><font color="#000000">
	Log(</font><font color="#666666">5.6</font><font color="#000000">) </font><font color="#666666">/</font><font color="#000000">
	base10 </font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font color="#000000"> </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font color="#000000"> </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font color="#408080"><font face="Courier New, monospace">'Add the
	logarithms </font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font color="#000000"> </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace"><font color="#000000">lt </font><font color="#666666">=</font><font color="#000000">
	l1 </font><font color="#666666">+</font><font color="#000000"> l2 </font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font color="#000000"> </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font color="#000000"> </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font color="#408080"><font face="Courier New, monospace">'Get the
	antilog, which is our base (10) </font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font color="#000000"> </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font color="#408080"><font face="Courier New, monospace">'raised to
	the sum of the log values </font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font color="#000000"> </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace"><font color="#000000">al </font><font color="#666666">=</font><font color="#000000">
	</font><font color="#666666">10^</font><font color="#000000">lt </font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font color="#000000"> </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font color="#000000"> </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font color="#408080"><font face="Courier New, monospace">'Print
	results </font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font color="#000000"> </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace"><font color="#000000">Print </font><font color="#ba2121">&quot;2.5
	* 5.6 = &quot;</font><font color="#000000">;</font><font color="#666666">2.5</font><font color="#000000">
	</font><font color="#666666">*</font><font color="#000000"> </font><font color="#666666">5.6</font><font color="#000000">
	</font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font color="#000000"> </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace"><font color="#000000">Print </font><font color="#ba2121">&quot;Log
	method = &quot;</font><font color="#000000">;al </font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font color="#000000"> </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font color="#000000"> </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font color="#000000"><font face="Courier New, monospace">Sleep </font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font color="#000000"> </font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<font face="Courier New, monospace"><font color="#008000">End</font><font color="#000000">
	</font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<table width="498" cellpadding="2" cellspacing="0">
		<col width="50">
		<col width="440">
		<tr>
			<td width="50" style="border: none; padding: 0in">
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				 <font face="Courier New, monospace">1</font></p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				 <font face="Courier New, monospace">2</font></p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				 <font face="Courier New, monospace">3</font></p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				 <font face="Courier New, monospace">4</font></p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				 <font face="Courier New, monospace">5</font></p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				 <font face="Courier New, monospace">6</font></p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				 <font face="Courier New, monospace">7</font></p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				 <font face="Courier New, monospace">8</font></p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				 <font face="Courier New, monospace">9</font></p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">10</font></p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">11</font></p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">12</font></p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">13</font></p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">14</font></p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">15</font></p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">16</font></p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">17</font></p>
				<p style="border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">18</font></p>
			</td>
			<td width="440" style="border: none; padding: 0in">
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace"><font color="#008800"><b>Option</b></font>
				Explicit </font>
				</p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<br/>

				</p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace"><font color="#008800"><b>Const</b></font>
				base10 <font color="#333333">=</font> Log(<font color="#0000dd"><b>10</b></font>)
				</font>
				</p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace"><font color="#008800"><b>Dim</b></font>
				<font color="#000000"><b>As</b></font> <font color="#333399"><b>Double</b></font>
				l1, l2, lt, al </font>
				</p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">'Calculate the log of 2.5 for
				base 10 </font>
				</p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">l1 <font color="#333333">=</font>
				Log(<font color="#6600ee"><b>2.5</b></font>) <font color="#333333">/</font>
				base10 </font>
				</p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">'Calculate the log of 5.6 for
				base 10 </font>
				</p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">l2 <font color="#333333">=</font>
				Log(<font color="#6600ee"><b>5.6</b></font>) <font color="#333333">/</font>
				base10 </font>
				</p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">'Add the logarithms </font>
				</p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">lt <font color="#333333">=</font>
				l1 <font color="#333333">+</font> l2 </font>
				</p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">'Get the antilog, which is
				our base (10) </font>
				</p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">'raised to the sum of the log
				values </font>
				</p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">al <font color="#333333">=</font>
				<font color="#0000dd"><b>10</b></font><font color="#333333">^</font>lt
				</font>
				</p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">'Print results </font>
				</p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">Print <span style="background: #fff0f0">&quot;2.5
				* 5.6 = &quot;</span><font color="#ff0000"><span style="background: #ffaaaa">;</span></font><font color="#6600ee"><b>2.5</b></font>
				<font color="#333333">*</font> <font color="#6600ee"><b>5.6</b></font>
				</font>
				</p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">Print <span style="background: #fff0f0">&quot;Log
				method = &quot;</span><font color="#ff0000"><span style="background: #ffaaaa">;</span></font>al
				</font>
				</p>
				<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace">Sleep </font>
				</p>
				<p style="border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
				<font face="Courier New, monospace"><font color="#008800"><b>End</b></font>
				</font>
				</p>
			</td>
		</tr>
	</table>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1.00pt solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.2in; padding-right: 0in">
	<br/>

	</p>
	<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 7.2: log.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2For an explanation of the natural log and e see http://www.physics.uoguelph.ca/tutorials/LOG/logbase.html. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 3 defines a symbolic constant, base10, that will be the base of the logarithm calculations. Using a constant in this manner reduces the number of calculations the program must perform. Instead of using two Log(10) function calls, only one is used in the constant definition. Line 5 declares the working variables, l1 an l2which are the two Logarithms of the numbers 2.5 and 5.6 and the sum of the logs, lt. Al will be the antilog value. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Lines 8 and 10 calculate the base 10 log of the two numbers. In line 13 thelogs are added together. Line 17 calculates the antilog, which is the base, in this case 10,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">raised to the power of the sum of the logs. Line 20 prints the result using themultiplication operator, and line 21 prints the result using the log method. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The program is closed in the usual way in lines 23 and 24. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Running the program produces the following result. </font></font></pre><p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">2.5 * 5.6 = 14 </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">Log method = 14 </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 7.2: Output of log.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As you can see from the output, adding the logarithms of the two numbers andthen calculating the antilog of the sum produces the same result as multiplying the twonumbers. </font></font>
</pre><h2 class="western">
	The C Runtime Library Math Constants and Functions 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The C Runtime Library (CRT) has a number of math constants and functions thatyou can use in your programs. To use these functions you would add the line #Include </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Once “crt.bi” to your program. The following table lists the math constants available in </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">math.bi. </font></font>
</pre><h3 class="western">
	CRT Math Constants 
	</h3>
	<table width="665" cellpadding="4" cellspacing="0" style="page-break-after: avoid">
		<col width="135">
		<col width="190">
		<col width="314">
		<tr valign="top">
			<td width="135" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Constants </font></font></pre>
			</td>
			<td width="190" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Value </font></font></pre>
			</td>
			<td width="314" style="border: 1px solid #000000; padding: 0.04in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Comment </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="135" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"></pre>
			</td>
			<td width="190" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"></pre>
			</td>
			<td width="314" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="135" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">M_E </font></font></pre>
			</td>
			<td width="190" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2.71828182845904</font></font></pre>
			</td>
			<td width="314" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The base of natural logarithms. </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="135" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">M_LOG2E </font></font></pre>
			</td>
			<td width="190" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1.44269504088896</font></font></pre>
			</td>
			<td width="314" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The logarithm to base 2 of M_E. </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="135" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">M_LOG10E </font></font></pre>
			</td>
			<td width="190" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">0.434294481903252</font></font></pre>
			</td>
			<td width="314" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The logarithm to base 10 of M_E. </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="135" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">M_LN2 </font></font></pre>
			</td>
			<td width="190" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">0.693147180559945</font></font></pre>
			</td>
			<td width="314" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The natural logarithm of 2. </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="135" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">M_LN10 </font></font></pre>
			</td>
			<td width="190" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2.30258509299405</font></font></pre>
			</td>
			<td width="314" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The natural logarithm of 10. </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="135" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">M_PI </font></font></pre>
			</td>
			<td width="190" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3.14159265358979</font></font></pre>
			</td>
			<td width="314" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Pi, which is the ratio of a circle's circumference to its diameter.</font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="135" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">M_PI_2 </font></font></pre>
			</td>
			<td width="190" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1.5707963267949</font></font></pre>
			</td>
			<td width="314" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Pi divided by two. </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="135" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">M_PI_4 </font></font></pre>
			</td>
			<td width="190" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">0.785398163397448</font></font></pre>
			</td>
			<td width="314" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Pi divided by four. </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="135" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">M_1_PI </font></font></pre>
			</td>
			<td width="190" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">0.318309886183791</font></font></pre>
			</td>
			<td width="314" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The reciprocal of pi, that is 1/pi. </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="135" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">M_2_PI </font></font></pre>
			</td>
			<td width="190" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">0.636619772367581</font></font></pre>
			</td>
			<td width="314" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Two times the reciprocal of pi. </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="135" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">M_2_SQRTPI </font></font></pre>
			</td>
			<td width="190" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1.12837916709551</font></font></pre>
			</td>
			<td width="314" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Two times the reciprocal of the square root of pi. </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="135" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">M_SQRT2 </font></font></pre>
			</td>
			<td width="190" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1.4142135623731</font></font></pre>
			</td>
			<td width="314" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The square root of two. </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="135" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">M_SQRT1_2 </font></font></pre>
			</td>
			<td width="190" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">0.707106781186547</font></font></pre>
			</td>
			<td width="314" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western" style="text-align: left"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The reciprocal of the square root of two which is also the square root of 1/2.</font></font></pre>
			</td>
		</tr>
	</table>
	<p style="margin-top: 0.08in"><font size="3" style="font-size: 12pt"><i>Table
	4: </i></font>
	</p>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In the example programs the value of PI was calculated. However, as you can see,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">the value of PI is available in the CRT, so it is much more efficient to use the defined </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">value M_PI in your programs, rather than making the compiler perform a calculation forthe value. The same reasoning applies to the base 10 logarithm calculation that was usedin log.bas. Instead of calculating the base 10 log you can use the constant value M_LN10. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The various versions of the PI constants are commonly used values in calculations as are the versions of the square root of 2. The square root of 2, like PI, is an irrational number and is the length of the hypotenuse of a right triangle with sides that have a unit length of 1. The square root of 2 is related to PI with the formula sqrt(2)=2sin(PI/4). The following program displays both the calculated value of the square root of 2 and the CRT value for comparison. </font></font>

</pre><p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> <font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b>Option
	Explicit </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> </span>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> <font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b>#Include
	Once &quot;crt.bi&quot; </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> </span>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> <font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b>Dim
	As Double sqr2 </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> </span>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> <font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b>sqr2
	= 2 * Sin(M_PI/4) </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> </span>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> <font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b>Print
	&quot;Calculated Square root of 2:&quot;;sqr2 </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> <font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b>Print
	&quot;CRT value:&quot;; M_SQRT2 </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> </span>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> <font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b>Sleep
	</span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<span style="background: transparent"> <font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b>End
	</span></b></font></font>
	</p>
	<pre class="western">

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 7.3: sr2.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 3 includes the CRT declaration file, crt.bi, which will enable the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">program to use the math constants and functions. The #Include Once directive ensures </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">that the file is only included once in the program, even if other modules also include the file. Line 5 declares the working variable which will hold the result of the calculation in Line 7. Line 9 and 10 displays the calculated value as well as the CRT defined value for comparison. The program is closed in the usual way. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should see the following output. </font></font>
</pre><p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">Calculated Square root of 2:
	1.41421356237309 </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">CRT value: 1.4142135623731 </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 7.3: Output of sr2.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As you can see from the output, the calculated value has a slightly higher precision than the constant value, but the difference is too small to really matter in most cases. To save the compiler a calculation, and thereby speeding up your program, use the defined value in the CRT. </font></font>
</pre><h3 class="western">
	Selected CRT Math Functions 
	</h3>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">There are a number of math functions declared in the CRT. Table 8.3 list three of </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">the functions. </font></font>
</pre>
	<table width="100%" cellpadding="4" cellspacing="0" style="page-break-after: avoid">
		<col width="85*">
		<col width="85*">
		<col width="85*">
		<tr valign="top">
			<td width="33%" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function</font></font></pre>
			</td>
			<td width="33%" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"> <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Syntax </font></font></pre>
			</td>
			<td width="33%" style="border: 1px solid #000000; padding: 0.04in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Comment </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Hypot </font></font></pre>
			</td>
			<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Hypot(x as double, y as double) </font></font></pre>
			</td>
			<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Hypot returns the hypotenuse of sides x and y. </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Log10 </font></font></pre>
			</td>
			<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Log10(x as double)</font></font></pre>
			</td>
			<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"> <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Log10 returns the base 10log of x. </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Pow</font></font></pre>
			</td>
			<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"> <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Pow(base as double, power as double) </font></font></pre>
			</td>
			<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Pow returns base raised to power. </font></font></pre>
			</td>
		</tr>
		<tr valign="top">
			<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<pre class="western"></pre>
			</td>
			<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
				<p><br/>

				</p>
			</td>
			<td width="33%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
				<p><br/>

				</p>
			</td>
		</tr>
	</table>
	<p style="margin-top: 0.08in"><font size="3" style="font-size: 12pt"><i>Table
	5: </i></font>
	</p>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 7.3: Selected CRT Math Functions </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The log program in Listing 8.2 can be modified to use the CRT functions. </font></font>
</pre><p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">Option
	Explicit </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">#Include
	Once &quot;crt.bi&quot; </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">Dim
	As Double l1, l2, lt, al </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">'Calculate
	the log of 2.5 for base 10 </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">l1
	= Log10(2.5) </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">'Calculate
	the log of 5.6 for base 10 </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">l2
	= Log10(5.6) </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">'Add
	the logarithms </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">lt
	= l1 + l2 </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">'Get
	the antilog, which is our base (10) </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">'raised
	to the sum of the log values </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">al
	= Pow(10, lt) </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">'Print
	results </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">Print
	&quot;2.5 * 5.6 = &quot;;2.5 * 5.6 </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">Print
	&quot;Log method = &quot;;al </span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">Sleep
	</span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<font face="Courier New, serif"><font size="1" style="font-size: 8pt"><b><span style="background: transparent">End
	</span></b></font></font>
	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border-top: none; border-bottom: none; border-left: 1px solid #000000; border-right: 1px solid #000000; padding: 0in 0.02in; page-break-before: auto">
	<br/>

	</p>
	<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 7.4: log2.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 3 includes the crt.bi declaration file so that the runtime functions will </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">be available to the program. Line 5 declares the working variables as in the previous program. In lines 8 and 10, the previous calculation has been replaced with the CRT function log10. Line 13 adds the logarithms, which is the same as multiplying the two numbers, and saves the result in the variable lt. In line 17 the Pow function is used rather </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">than the exponentiation operator to calculate the antilog. Lines 20 and 21 print out the results for comparison. The program is closed in the usual way. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you will see that the output is the same as in the previous version. </font></font></pre><p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">2.5 * 5.6 = 14 </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<font face="Courier New, monospace">Log method = 14 </font>
	</p>
	<p style="margin-bottom: 0in; border: none; padding: 0in; background: #c0c0c0">
	<br/>

	</p>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 7.4: Output of log2.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Using the CRT functions can make your program a bit more simple, and a bit less error prone. Since FreeBasic uses the Microsoft runtime library the functions are stable and reliable, and many include optimizations that make the functions perform better than you could achieve by hand coding. </font></font>
</pre><h2 class="western">
	A Look Ahead 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In addition to the standard numeric variables, FreeBasic also has the pointer datatype, which is the subject of the next chapter. </font></font>

</pre>
</div>
<div id="Console Programming " dir="ltr" href="../fbeginnerm18.odt">
	<h1 class="western" style="page-break-before: always">Chapter 15
	Console Programming 
	</h1>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Console programming, or more generally text-based programming, is aprogramming style that uses text as the primary medium to display information to, andto interact with, the user. This is in contrast to GUI programming, where a graphical userinterface is used for display and interaction or a graphics-based program where graphicalobjects are used for display and interaction. Text-based programming has its roots in theearly days of computing, when computers did not have graphical displays or the graphicswere too primitive to be of use. Even today, in this era of photo-realistic graphics, text-based programming remain a vibrant area of application development. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">At first glance it may seem that text-based applications would be limited, howeverthis is not the case at all. Over the years everything from sophisticated word processorsand spreadsheets to games have been developed using only text. Text user interfaces, orTUIs have been developed that have all the functionality of modern graphical userinterfaces. Many of the most popular games in history, such as Zork, were writtenentirely in text. Text-based application are content oriented, and if conveying content iswhat you are trying to do, then a text-based application is well suited to the task. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If you are interested in text-based programming you should visit Ascii World located athttp://www.ascii-world.com. Ascii World is a site devoted entirely to text-basedprogramming, regardless of the programming language. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Console Screen </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The console can be viewed as a grid, where each row contains a certain numbercolumns. In FreeBasic you can specify how many rows and columns a console cancontain, providing the operating system supports the configuration. The basic consoleconfiguration is 25 rows by 80 columns. Consoles are row oriented, so you specify aposition on the grid using the row followed by the column Each grid location can containa single character. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The character set for the console under Windows®, is the Ascii character set. The </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Ascii character set contains 256 characters and includes all the numbers, letters and </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">punctuation you would expect, as well as some extended characters used in Europeanlanguages, and a set graphical characters that can used for drawing lines and boxes onthe screen. By using both text and the Ascii graphical characters in a console applicationyou can create quite sophisticated user interfaces completely in text. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Console Functions </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">FreeBasic has a number of console functions that enable you to position text onthe screen, set the foreground and background colors of the text, and to retrieveinformation from the console screen. You can also use the mouse in the console for added </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">functionality. The following table lists the console commands available in FreeBasic. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function Syntax Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Cls Cls mode Clears the screen. If mode is </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function Syntax Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">0 or omitted, entire screen </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">is cleared. If mode is 1 the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">graphics viewport is cleared.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If mode is 2, the text </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">viewport is cleared. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Color Color foreground,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">background </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Color </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sets the foreground and/orbackground color of printed </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">text. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Color can also be used to </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">return the current color </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">attributes, where the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">foreground color is the low-</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">word and the backgroundcolor is the high-word. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Csrlin B = Csrlin Returns the row that the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">cursor currently occupies. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Format B = Format (numeric,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">format_string) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Formats a numerical </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">expression according toformat_string. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Getmouse Getmouse col, row, wheel, </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">button </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Returns the current positionof the mouse cursor in row, </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">col, the current wheel state </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">and button state. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Locate Locate row, column, </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">cursor_state </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Positions the cursor on the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">row and column. If </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">cursor_state is 0, cursor is </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">hidden. If 1, cursor is shown. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Pos B = Pos Returns the current column </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">of the cursor. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">? </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print expression </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print expression, </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print expression; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">? expression </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">? expression, </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">? expression; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Prints expression to thescreen. Expression can betext, a string variable ornumeric variable. A comma </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">at the end of the print stringwill print a tab space withno carriage return. A semicolon </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">will not print acarriage return. If no commaor semi-colon, a carriagereturn is printed. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print Using Print Using format_string,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">expression1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print Using format_string,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">expression1, </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print Using format_string,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">expression1; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print expression to thescreen using a format string.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print Using has some knownbugs and should not beused. Use format instead. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function Syntax Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Screen B = Screen(row, col,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">color_flag) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Screen returns the ascii </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">character code at row and </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">column position if color_flagis 0. If color_flag is 1, Screenreturns the color attribute. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You can determine the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">background color with </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">background = attribute </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">shr 4 and the foregroundcolor with foreground = </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">attribute and &amp;hf. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Spc Spc columns Causes next print statementto skip number of columns. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Tab Tab column Sets column for next print </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">statement. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">View Print View Print first_row To </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">last_row </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sets printing area of screen. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Width Width columns, rows Sets the the number of </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">columns and rows of the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">console window. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 15.1: Console Commands </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Console Colors </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The default color scheme for the console is white text on a black background. Youcan change the color scheme by using the Color function to change either or both theforeground and background color of printed text. For the console, the color numbersrange from 0, black, to 15, bright white. The following list enumerates the color numbersthat can be used in the console. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">0: black </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1: blue </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2: green </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3: cyan </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4: red </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5: magenta </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6: yellow </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7: white </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8: gray </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9: bright blue </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10: bright green </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11: bright cyan </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12: bright red </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13: bright magenta </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14: bright yellow </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15: bright white </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The colors listed above may vary, depending on your graphics card and monitor,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">but they should approximate those listed. In addition to printing colored text, you canalso set the background of the entire console screen by setting the background colorusing the Color function, and then using Cls to clear the screen. When the screen iscleared, the background will be in the selected color. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Color is useful for enhancing the look of your application, but you should never rely oncolor alone to indicate critical information in your application. Approximately 15 millionpeople are color blind just in the United States. Depending on the level of colorblindness, an individual may miss critical information if it is displayed using color alone.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">It is good practice to identify critical information through the use of text manipulation,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">such as a pop-up box, so that the information won't be missed by a color blind user. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Each character position on the console screen stores the character value, alongwith the current color attributes which can be determined using the Screen function. Ifcolor_flag is 0, Screen will return the ascii code of the character at the selected row andcolumn. If color_flag is 1, Screen will return the color attribute. Colors are stored as bytevalues with the high 4 bits indicate the background color and the low 4 bits indicate theforeground color, the color of the text. You can determine the color attributes by usingthe following formulas. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Foreground = attribute And 15 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Background = attribute Shr 4 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following program illustrates how you might use these functions in a program. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer clr, ccode </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Set the color </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Color 15, 0 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Get the current color </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">clr = Color </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print foreground and background color numbers </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Current color setting:&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Foreground: &quot;;Loword(clr) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Background: &quot;;Hiword(clr) </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Get the current character position at 1, 1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">17 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ccode = Screen(1, 1) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">18 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Character code at 1,1 is&quot;;ccode;&quot; which is &quot;;Chr(ccode);&quot;.&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">19 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">20 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Get the color attributes at 1,1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">21 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">clr = Screen(1, 1, 1) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">22 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Foreground color at 1,1:&quot;;clr And 15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">23 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Background color at 1,1:&quot;;clr Shr 4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">24 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">25 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">26 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">27 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 15.1: color.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 3 dimensions the working variables, clr which contains the colorattribute of a text position and ccode which is the character code. Line 6 sets the currentcolor to bright white, 15, with a black background, 0. Line 9 stores the current clr settingin the variable clr. Lines 13 and 14 print the current color numbers to the screen usingthe Loword and Hiword macros. Line 17 stores the character code at row position 1,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">column position 1 in ccode. Line 18 prints both the character code and the correspondingcharacter to the screen. Line 21 retrieves the color attribute for the same position, andlines 22 and 23 print the color values using the formula listed above. The program isclosed in the usual way. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should see the following output. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Current color setting: </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Foreground: 15 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Background: 0 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Character code at 1,1 is 67 which is C. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Foreground color at 1,1: 15 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Background color at 1,1: 0 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 15.1: Output of color.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The display will be in bright white, with a black background. As you can see, youhave tremendous control over the appearance of console text and can easily determinethe attributes of the text. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Positioning Text </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You can position text anywhere on the console screen using the Locate statement.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Locate statement sets the text cursor position for subsequent printing of text. To </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">print to a certain location on the screen, you must first position the text cursor using thelocate statement, then follow that command with a print statement. You can turn the textcursor on and off by using the optional cursor flag of the locate statement. 1 turns thetext cursor on, and 0 turns the cursor off. This is useful if, for example, you are using themouse for console input. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Print command will update the current cursor position. You can obtain the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">current row setting by using the Csrlin function and the current column setting by usingthe Pos function. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Printing Text </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Print statement is used to print text to the screen. The location and color ofthe text is determined by the current cursor setting and the last color statement. Usingthe Print statement with a semi-colon after the print string will position the text cursor tothe end of the string. Using a comma after the print string will position the text cursor tothe next tab location. A Print statement without either a semi-colon or comma, will insert </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">a carriage return and/or line feed positioning the cursor at the beginning of the next line. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You can format the output of numeric text using the Print Using command,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">although this is a deprecated function and has some known, minor bugs. The function isavailable mainly for backward compatibility with older programs. For new programs, youshould use the Format function, which is covered in a separate chapter later in this book.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For details on the Print Using function see the FreeBasic documentation wiki4. The </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">function will not be covered in this book. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You have already seen the Spc and Tab functions in several of the exampleprograms. The Spc function will cause the next print position to skip a number of columnswhile the Tab function will put the text cursor at the next tab position. Both of thesefunctions are useful for printing tabular data to the screen. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Determining and Setting the Size of the Console </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You can determine the current console size, or set the number of rows and columns </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">of the console by using the Width function. To determine the current console size, use theWidth function without any parameters as shown in the following code snippet. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">MyInt = Width </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">columns = Loword(myInt) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">rows = Hiword(myInt) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The number of columns of the console is stored in the low word of the return </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">integer value while the number of rows is stored in the high word of the integer. To setthe console size, use the Width function with the number of desired columns and rows, as </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">illustrated in the following code snippet. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Width 80, 25 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">This will set the console to 80 columns by 25 rows. The standard consoleconfiguration is 80 columns by 25 rows, however, if you need a different size for your </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4At the time of this writing, the Print Using wiki page is loacted athttp://www.freebasic.net/wiki/wikka.php?wakka=KeyPgPrintusing. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">application you can use the Width function to check if the console is the appropriate sizeand then resize if necessary. Setting the console size will reset the cursor position to row1 and column 1, so you may need to issue a Locate statement to reset the cursor positionafter the change. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following program shows how to use the Width function to get the consile sizeinformation and reset the console. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">17 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">18 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">19 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">20 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">21 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">22 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">23 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">24 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">25 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">26 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">27 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">28 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer consize, rows, cols </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Get the current console size </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">consize = Width </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">rows = Hiword(consize) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">cols = Loword(consize) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Current Rows =&quot;;rows </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Current Columns =&quot;;cols </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Press any key...&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Cls </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Resize console if necessary </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If rows &gt; 25 Then </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Width 80, 25 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End If </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Get the new console size </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">consize = Width </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">rows = Hiword(consize) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">cols = Loword(consize) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;New Rows =&quot;;rows </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;New Columns =&quot;;cols </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 15.2: width.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 3 dimensions three variables, consize that will contain the Width </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">return value, rows which will contain the number of rows and cols which will contain the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">number of columns. Line 6 gets the current console size. Line 7 retrieves the number ofrows using the Hiword macro and line 8 retrieves the number of columns using theLoword macro. The current setting is printed to the screen in lines 9 and 10. The Sleepcommand is used in line 12 to pause the program and wait for a key press from the user.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 13 clears the screen. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Lines 16 through 18 check to see if the number of rows is greater than 15 and iftrue, then resets the console to 80 columns by 25 rows. Line 21 checks the new consolesize and the current rows and columns are retrieved in lines 22 and 23. The new values </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">are printed in lines 24 and 25. The program is then closed in the usual way. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should see output similar to the following. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Current Rows = 25 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Current Columns = 80 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Press any key... </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 15.2: Output a of width.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">New Rows = 25 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">New Columns = 80 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 15.3: Output b of width.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output a shows the console setting when the program starts, and Output b showsthe console setting after checking the console size. In this run the default setting was thedesired size, so the Width statement did not need to be executed. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Getting User Input </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If you need to interact with the user, then you will need to get user input. Thereare several ways to collect user input which are listed in the following table. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Function Syntax Comment </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Inkey B = Inkey Returns a key from thekeyboard buffer as a string.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If an extended key ispressed, the return stringcontains character 255 + </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">key character. Inkey doesnot wait for keyboard input. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Input Input variable_list </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Input “prompt”; variable_list </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Input “prompt”,variable_list </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Input will gather input forone or more variables listed </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">in variable_list. The </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">variables should be </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">separated with commas.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The type of variabledetermines how input willcollect the data. If the data </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">type of the variable is astring, Input will convert theinput data to a string. If thedata type of the variable is </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">numeric, Input will convertthe data to a number. If an </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">invalid numeric string isentered, Input will attempt </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">to convert as manycharacters as possible to anumber. If no characters can </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">be converted to a string,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Input will return 0. If a semicolon </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">is used with Input, aquestion mark will bedisplayed after the prompt.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If a comma is used, a </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">question mark will not beprinted. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Input() B = </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Input(number_of_characters) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Input() will return a stringcontaining number ofcharacters entered. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Getkey B = GetKey Returns the ascii code of the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">current key in the keyboardbuffer. Getkey will wait for akey. If an extended key ispressed, the first characteris skipped, character 255,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">and the second character is </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">returned. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line Input Line Input string_variable </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Line Input “prompt”;</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">string_variable </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B = Line Input “prompt”,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">string_variable </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line Input will return a lineof text from the keyboard.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">All characters up to, but notincluding the enter key areread. An optional promptcan be displayed with eithera question mark, using asemi-colon, or no questionmark when using a comma. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Winput() B = </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Winput(number_of_characters) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Wide string version ifInput(). </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Table 15.2: Input Functions </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Inkey </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Inkey is useful for polling the keyboard buffer in a loop and can be used in gamesor in text-based user interfaces since Inkey does not with for a key to be pressed. Thisallows you to process other events within your program, and then take action if a key hasbeen pressed. If the buffer is empty, Inkey will return an empty string. If a key is waitingin the buffer, Inkey will return a string that is either one or two character long. Keys canbe either the normal printable keys, such as A or 1, or an extended key such as the UpArrow or F1. Normal keys return 1 key code, while the extended keys return 2 key codes,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">with the first code being character 255. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following program will display the character and ascii code(s) of both normaland extended keys. </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As String key, char </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer i </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Do </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Check keyboard buffer </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">key = Inkey </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'If key has been pressed </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If Len(key) &gt; 0 Then</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Clear the last message </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Locate 1, 1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print Space(79); </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Reposition cursor </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">locate 1,1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print current key codes </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = 1 To Len(key)</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">char = Mid(key, i, 1) </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Character: &quot;;char; &quot; Code: &quot;;Asc(char); &quot; &quot;;</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End If </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep 10 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Loop Until key = Chr(27) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 15.3: inkey.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 3 dimensions two string variables, key which will be the return valuefrom Inkey and char which will be the individual characters. The integer variable i in line4 will be used in the For-Next to extract the individual characters fro the key variable.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 6 through 23 define a keyboard processing loop using. Line 8 checks for keyboardinput. Line 10 checks to see if the length of key is greater than zero, indicating that Inkeyreturned a key. Lines 12 through 15 clear the previous output line that may have beenprinted. Lines 17 through 20 extract each character from the key variable, loading theactual character into the variable char in line 18 and then printing the corresponding asciicode to the screen in line 19. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Sleep command is used in line 22 to allow the operating system to processother events. If you are using an extended loop such as this keyboard input loop, youshould always insert a Sleep # command in the loop to allow the operating system toprocess background tasks, otherwise your program may consume 100 percent of theoperating system's time. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 23 then checks to see if the escape key was pressed, which is ascii code 27,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">and then exits the loop if the key was pressed. The program is then closed using the end </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">statement. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">A sample output is shown below. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Character: Code: 255 Character: ; Code: 59 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 15.4: Output of inkey.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The output shows the codes when the F1 key is pressed. Once you know the keycodes, then you can build Const statements to trap for certain keys. For example, to trapfor the F1 key, you would create the Const statement shown in the code snippet below. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Const F1_key = Chr(255) &amp; Chr(59) </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You can then check the Inkey return to see if the key returned natches the F1 key. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If key = key_F1 Then </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Then do something </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End If </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You can set up any number of keys in this manner. The F1 key is usually used todisplay help content, and in your application you could display a help screen by executingthe help display code in the body of the If statement. If you are coding a game, you mightwant to use the arrow keys to move your character player around the screen, by settingup the arrow key constants and then adding a If-Then-Elseif ladder to process the arrowskeys. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Getkey </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Unlike Inkey, Getkey does wait for the user to press a key. If an extended key ispressed, Getkey will discard the first character and return the second character. Getkey isused in situations where you are not interested in the extended key set and you need topause the program to gather user input. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Input </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Input function is used to gather information from the user that will be loadedinto one or more variables. The data type of the variable determines how the user inputis processed. If the variable is a string, Input will process the information as a string; ifthe variable is a numeric data type, Input will try to convert the information to a number.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The variables must be separated using commas. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You can display a prompt string with Input by enclosing a literal string before thevariable list. If a semi-colon is used after prompt string, a question will be displayed afterthe prompt. If a comma is used after the prompt string, no question mark is printed. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If you are supplying multiple variables to Input, then the user will need to enter thevalues separated by either spaces or commas. The spaces and commas are not returned </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">by Input. If you need to process either spaces or commas, then you need to use LineInput rather than Input. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line Input </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line Input will return a single string up to but not including the enter key. That is,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line Input expects a single string variable, rather than multiple variables. Line Input willread both spaces and commas in the entered string. Like Input, you can use a semi-colonto display a question mark at the end of the prompt string. Unlike Input however, you canuse either a literal string or a string variable for the prompt. Line Input returns the userinput as a string and does not convert numeric strings to numbers. </font></font>
</pre><h2 class="western">
	Using the Mouse 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Another way to get user input is to use the mouse. The Getmouse function willreturn the current zero-based row and column of the mouse as well as the state of the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">buttons and mouse wheel. Since the rows and columns are zero-based, you will need toadd 1 to the values to map the return values to the screen </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The current state of the mouse wheel as an integer that starts at zero when theprogram starts and will return either a more positive number if the mouse wheel is turnedin a forward direction and a more negative number if the mouse wheel is turned in thereverse direction. Normally, you would store the mouse wheel value at program start,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">and then take an action based on the offset value returned by Getmouse. For example, toscroll some text, you may scroll up if the wheel number is moving in the positive directionand scroll down if the wheel number is moving in the negative direction. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You can also determine which buttons have been pressed by checking the buttonreturn value. Getmouse supports three buttons, left and right and a middle button, whichoften doubles as the mouse wheel. You can determine which button has been pressed byusing the following formulas. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Left button = button And 1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Right button = button And 2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Middle button = button And 4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Button is the value returned by the Getmouse function. Not only can you check forsingle button presses, but you can also check to see if both button have been pressed bychecking each button state simultaneously. There is no way to check for a double clicknatively however, so you will need to create your own timing code to determine if abutton has been double-clicked. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following program illustrates using the Getmouse functions. </font></font>

 
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>


 



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Mouse return values </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer mx, my, oldmx, oldmy, mwheel, mbuttons </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Turn off text cursor </font></font>






<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Locate ,,0 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Do</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Get mouse info</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Getmouse mx, my, mwheel, mbuttons</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Zero based so add 1</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">mx += 1</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">my += 1</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Check to see if we have new information</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If (mx &gt; 0) And (my &gt; 0) then</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Locate 1, 1</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print current row, column and wheel setting</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot;Row:&quot;;my;&quot; Col:&quot;;mx;&quot; W:&quot;;mwheel;&quot; BT:&quot;;</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Check for button press</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If mbuttons And 1 Then Print &quot;L&quot;;</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If mbuttons And 2 Then Print &quot;R&quot;;</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If mbuttons And 4 Then Print &quot;M&quot;;</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print &quot; &quot;</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Clear old cursor</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Locate oldmy, oldmx</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print chr(32);</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print new cursor</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Locate my, mx</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print Chr(15);</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Save the old values</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">oldmx = mx</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">oldmy = my</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End If</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep 10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Loop Until Inkey$&lt;&gt;&quot;&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Turn on cursor </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Locate ,, 1 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 15.4: con-mouse.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 4 creates the mouse parameter working variables. Mx and my arethe current column and row returned by the Getmouse function. Oldmx and oldmy arethe old column and row settings that are used to erase the mouse cursor character that isdisplayed on the screen. Mwheel is the current mouse wheel setting while mbuttons isthe current button state. Line 7 uses the Locate statement to turn off the text cursor. Line </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 through 35 are the mouse input loop that polls the mouse. Line 10 uses the Getmousefunction to return the current mouse state information. Since Getmouse returns the row </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">and column as a zero-based value, lines 12 and 13 add 1 to the value to map the returnvalue to the actual screen coordinates. Line 15 checks to see if the mouse is still within </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">the console screen. If the mouse is outside the console screen, Getmouse will return -1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">for the row and column values. Since the program added 1 to these values, if the mouse </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">is outside the console window, the mx and my values will be 0; that is, -1 + 1 = 0. Youshould always check to make sure the mouse is still inside the console window beforeinteracting with the mouse. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Lines 16 and 18 prints the current row, column and wheel settings to the consolescreen. Lines 20 through 22 check to see what mouse button, if any, has been pressedand prints the mouse button id to the screen. L is the left mouse button, R is the rightmouse button and M is the middle button. Lines 25 and 26 erase the old mouse location </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">indicator, an asterisk that will follow the mouse cursor on the screen. Lines 28 and 29 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">then print the asterisk at the new mouse location. Lines 31 and 32 save the current mxand my values in oldmx and oldmy, to use in the next loop iteration. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Do-Loop is exited in line 35 when any key is pressed. Line 27 turned the textcursor back on and the program is closed with the End statement in line 39. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should see something similar to the following. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Row: 2 Col: 4 W: 2 BT:L </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">¤ </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 15.5: Output of con-mouse.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If the mouse does not work in the console window, then you will need to turn offthe Quick Edit mode of the console. Right click the title bar and select Properties. UnderEdit Options, uncheck the QuickEdit mode. If a pop-up window appears, select SaveProperties for Future Windows with Same Title, then click the OK button. The mouseshould not work in the console window. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Creating a Text View Port </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You can create a text view port using the View Print statement. A text view portcan be thought of as a window -within-a-window, where all text operations occur. Youdefine a view by passing the beginning row and ending row to the View Print command.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Once the command has been issued, all subsequent text operations occur within the view </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">port. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The following program creates a 10 line view port and prints some text within theview, which can be scrolled using the mouse wheel. If the mouse does not work withinthe console window, you will need to turn off the QuickEdit mode as described above. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Option Explicit </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create paragraph </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim Shared As String * 80 myText(1 To 19) =&gt; { _ </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">&quot; Lorem ipsum dolor sit amet consectetuer id a ut magna Vestibulum.&quot;, _ </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">&quot;Id elit justo pretium commodo vitae convallis urna magnis mattis &quot;, _ </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">&quot;tempor. Duis vitae id semper euismod dolor wisi turpis leo dolor in. &quot;, _ </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">&quot;Neque non Vivamus ac eget nunc sagittis ut mauris at orci. Tincidunt &quot;, _ </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">&quot;ipsum habitasse accumsan leo iaculis et vitae congue vitae malesuada. &quot;, _ </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">&quot;Wisi sem Curabitur id ut ipsum adipiscing facilisi elit In id. Et urna.&quot;, _ </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">11 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">&quot; Lorem ipsum dolor sit amet consectetuer eleifend Suspendisse sem &quot;, _ </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">12 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">&quot;lacus iaculis. Wisi feugiat mus augue parturient et felis Pellentesque &quot;, _ </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">13 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">&quot;wisi et nec. Vitae metus senectus a dolor Nullam amet accumsan integue &quot;, _ </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">14 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">&quot;nonummy id. Sed justo in fames turpis justo platea ultrices est &quot;, _ </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">15 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">&quot;convallis vel. Interdum ut Morbi enim ut Vestibulum senectus lacinia&quot;, _ </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">16 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">&quot;Sed congue metus.&quot;, _ </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">17 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">&quot; Lorem ipsum dolor sit amet consectetuer lacinia molestie wisi&quot;, _ </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">18 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">&quot;semper pretium. Et gravida congue volutpat ac Maecenas elit Nunc &quot;, _ </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">19 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">&quot;orci Curabitur lobortis. Felis tincidunt nonummy vitae at ut et &quot;, _ </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">&quot;et montes pellentesque Donec. Vitae elit habitant nunc cursus &quot;, _ </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">21 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">&quot;ullamcorper risus sagittis tempus consectetuer velit. Est &quot;, _ </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">22 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">&quot;Vestibulum non id pulvinar Nam vitae metus id congue massa. &quot;, _ </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">23 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">&quot;Phasellus.&quot;} </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">24 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">25 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer idx = 1, mx, my, oldwheel, mwheel, delta </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">26 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer vtop = 10, vbot = 20 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">27 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">28 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sub PrintText(tidx As Integer)</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">29 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Dim As Integer i, tbot31 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Clear view port to black32 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Color , 033 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Cls34 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Calc text that will fit into view port35 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">tbot = tidx + 1036 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If tbot &gt; 19 Then tbot = 1937 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">For i = tidx To tbot38 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Print Rtrim(myText(i))</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">39 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Next </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End Sub </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">41 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">42 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Set the console size </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">43 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Width 80, 25 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">44 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Turn off text cursor </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">45 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Locate ,,0 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">46 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Clear screen to blue </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">47 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Color , 1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">48 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Cls </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">49 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Create view port </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">View Print vtop To vbot </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">51 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print the current text </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">52 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">PrintText idx </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">53 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Get the current wheel setting </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">54 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Getmouse mx, my, oldwheel </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">55 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">56 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">57 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">58 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">59 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">60 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">61 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">62 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">63 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">64 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">65 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">66 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">67 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">68 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">69 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">70 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">71 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">72 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">73 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">74 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">75 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">76 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Do </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Get mouse wheel info </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Getmouse mx, my, mwheel </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If mwheel &lt;&gt; oldwheel Then</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Get delta amount </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">delta = oldwheel mwheel </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Use delta amount to adjust text index </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">idx = idx + delta </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Make sure text isn't out of bouns </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If idx &gt; 19 Then idx = 19 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If idx &lt; 1 Then idx = 1 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Print text </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">PrintText idx </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Save the current mouse wheel value </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">oldwheel = mwheel</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End If</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sleep 10 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Loop Until Inkey&lt;&gt;&quot;&quot; </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">'Turn on text cursor </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Locate ,,1 </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">End </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Listing 15.5: view-print.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">	Analysis: Line 4 creates a single-dimension array that initialized to some randomtext. The text will be printed in the view port created later in the program. Line 25 and 26creates the working variables. Idx is the current line index into the myText array. Mx andmy are the mouse column and rows, which are not used in the program, but are neededfor the Getmouse function. Oldwheel and mwheel are the last and current wheel positionvariables. Delta is the difference between the old wheel position and the current wheelposition. Delta is used to calculate the offset for the idx variable. Line 26 dimensions twovariables, vtop and vbot which are the top and bottom of the view port. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 28 through 40 define the PrintText subroutine which will print the array text tothe view port. The tidx parameter, is the current value contained within the idx variable,</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">and points to the current line position in the text array. Line 29 creates two variables, iwhich is used in the following For-Next block and tbot which is used to calculate howmany rows of text to print. Line 32 and 33 clear the view port. Line 35 calculates thenumber of lines to display. Tidx contains the start line in the text array, and tbot containsthe end line in the text array. Line 36 checks to make sure that the end line containedwithin tbot does not point past the end of the array. Line 37 through 39 print the text tothe view port. Since the view port is 10 lines, the code prints a 10 line “window” from thearray to the view port. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 43 sets the width of the console, and lines 45 through 48 clear the mainconsole window to a blue color. At the point the view port has not be created so thesecommands apply to the console widow as a whole. Line 505 creates a view port that </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">starts at vtop and extends to vbot, inclusive. All text commands issued after the ViewPrint command will go now to the view port. Line 52 prints the initial 10 lines of text. Line54 gets the initial value of the mouse wheel, for use later to calculate the delta value. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 55 through 71 define the mouse input loop. Line 57 gets the current mousewheel value. Line 58 checks to see if the new value is different than the old value, and if </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">they are different, this means the mouse wheel has been moved. Line 60 calculates the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">delta, or changed value, between the old mouse wheel setting and the new mouse wheelsettings. Using this technique, you can calculate how to scroll the text, because the valuewill be either positive or negative depending on whether the mouse wheel is movedforward or backward. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Line 62 uses the delta value, to update the idx variable, which is the pointer to thecurrent top line in the text array. If delta is positive, idx will move toward the end of thearray, which means that the text will scroll up. If delta is negative, idx will move towardthe beginning of the array, so the text will scroll down. Line 64 and 65 make sure that idxdoes not point past the beginning and end of the array. The current text block is thenprinted in line 67. Line 69 then saves the current wheel value in the oldwheel variable, tobe used in the next delta calculation. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If a key pressed the loop is exited in line 72 and then program is closed with anEnd statement. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you should see output similar to that shown below. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Sed congue metus.</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Lorem ipsum dolor sit amet consectetuer lacinia molestie wisi </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">semper pretium. Et gravida congue volutpat ac Maecenas elit Nunc </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">orci Curabitur lobortis. Felis tincidunt nonummy vitae at ut et </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">et montes pellentesque Donec. Vitae elit habitant nunc cursus </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ullamcorper risus sagittis tempus consectetuer velit. Est </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Vestibulum non id pulvinar Nam vitae metus id congue massa. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Phasellus. </font></font>



<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Output 15.6: Output of view-print.bas </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When you run the program you will see a blue screen with a black view port in themiddle with some text. Scroll the mouse wheel, and the text will scroll. Move the mouse </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">wheel forward and the text will scroll down, move the mouse backward and the text will </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">scroll up. The text will stop scrolling when the beginning or the end of the text is reached.</font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">As you can see, using the view port command along with the Getmouse function is asimple way to add a great deal of functionality to your text-based programs. </font></font>
</pre><h2 class="western">
	A Look Ahead 
	</h2>
	<pre class="western">
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Now that you can create variables and gather input, you need to see how to buildcontrol structures to act on this data. In the next chapter you will see the various controlstructures that are available in FreeBasic. </font></font>

</pre>
</div>
<h1 class="western"></h1>
<h1 class="western"></h1>
<h1 class="western"></h1>
<h1 class="western"></h1>
<h1 class="western"></h1>
<h1 class="western"></h1>
<h1 class="western"></h1>
<h1 class="western"></h1>
<h1 class="western"></h1>
<h1 class="western"></h1>
<h1 class="western"></h1>
<h1 class="western"></h1>
<div id="GNU Free Documentation License" dir="ltr" href="../fbeginnerm20.odt">
	<h1 class="western" style="page-break-before: always">Appendix A:
	GNU Free Documentation License</h1>
	<pre class="western">
 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">GNU Free Documentation License Version 1.2, November 2002</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Copyright (C) 2000,2001,2002 Free Software Foundation, Inc.</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">51 Franklin St, Fifth Floor, Boston, MA 021101301 </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">USA</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Everyone is permitted to copy and distribute verbatim copies</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">of this license document, but changing it is not allowed. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">0. PREAMBLE </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The purpose of this License is to make a manual, textbook, or other functional and useful document &quot;free&quot; in the sense of freedom: to assure everyone the effective freedom to copy and redistribute it, with or without modifying it, either commercially or noncommercially. Secondarily, this License preserves for the author and publisher a way to get credit for their work, while not being considered responsible for modifications made by others. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">This License is a kind of &quot;copyleft&quot;, which means that derivative works of the document must themselves be free in the same sense. It complements the GNU General Public License, which is a copyleft license designed for free software. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">We have designed this License in order to use it for manuals for free software, because free software needs free documentation: a free program should come with manuals providing the same freedoms that the software does. But this License is not limited to software manuals; it can be used for any textual work, regardless of subject matter or whether it is published as a printed book. We recommend this License principally for works whose purpose is instruction or reference. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">1. APPLICABILITY AND DEFINITIONS </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">This License applies to any manual or other work, in any medium, that contains a notice placed by the copyright holder saying it can be distributed under the terms of this License. Such a notice grants a worldwide, </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">royaltyfree </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">license, unlimited in duration, to use that </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">work under the conditions stated herein. The &quot;Document&quot;, below, refers to any such manual or work. Any member of the public is a licensee, and is addressed as &quot;you&quot;. You accept the license if you copy, modify or distribute the work in a way requiring permission  under copyright law. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">A &quot;Modified Version&quot; of the Document means any work containing the Document or a portion of it, either copied verbatim, or with modifications and/or translated into another language. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">A &quot;Secondary Section&quot; is a named appendix or a frontmatter section of the Document that deals exclusively with the relationship of the publishers or authors of the Document to the Document's overall subject (or to related matters) and contains nothing that could fall directly within that overall subject. (Thus, if the Document is in part a textbook of mathematics, a Secondary Section may not explain any mathematics.) The relationship could be a matter of historical connection with the subject or with related matters, or of legal, commercial, philosophical, ethical or political position regarding them. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The &quot;Invariant Sections&quot; are certain Secondary Sections whose titles are designated, as being those of Invariant Sections, in the notice that says that the Document is released under this License. If a section does not fit the above definition of Secondary then it is not allowed to be designated as Invariant. The Document may contain zero Invariant Sections. If the Document does not identify any Invariant Sections then there are none. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The &quot;Cover Texts&quot; are certain short passages of text that are listed, as FrontCover Texts or BackCover Texts, in the notice that says that the Document is released under this License. A FrontCover Text may be at most 5 words, and a BackCover Text may be at most 25 words. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">A &quot;Transparent&quot; copy of the Document means a machine readable copy, represented in a format whose specification is available to the general public, that is suitable for revising the document straightforwardly with generic text editors or (for images composed of pixels) generic paint programs or (for drawings) some widely available drawing editor, and that is suitable for input to text formatters or for automatic translation to a variety of formats suitable for input to text formatters. A copy made in an otherwise Transparent file format whose markup, or absence of markup, has been arranged to thwart or discourage subsequent modification by readers is not Transparent. An image format is not Transparent if used for any substantial amount of text. A copy that is not &quot;Transparent&quot; is called &quot;Opaque&quot;. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Examples of suitable formats for Transparent copies include plain ASCII without markup, Texinfo input format, LaTeX input format, SGML or XML using a publicly available DTD, and standard conforming simple HTML, PostScript or PDF designed for human modification. Examples of transparent image formats include PNG, XCF and JPG. Opaque formats include proprietary formats that can be read and edited only by proprietary word processors, SGML or XML for which the DTD and/or processing tools are not generally available, and the machine generated HTML, PostScript or PDF produced by some word processors for output purposes only. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The &quot;Title Page&quot; means, for a printed book, the title page itself, plus such following pages as are needed to hold, legibly, the material this License requires to appear in the title page. For works in formats which do not have any title page as such, &quot;Title Page&quot; means the text near the most prominent appearance of the work's title, preceding the beginning of the body of the text. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">A section &quot;Entitled XYZ&quot; means a named subunit of the Document whose title either is precisely XYZ or contains XYZ in parentheses following text that translates XYZ in another language. (Here XYZ stands for a specific section name mentioned below, such as &quot;Acknowledgements&quot;, &quot;Dedications&quot;, &quot;Endorsements&quot;, or &quot;History&quot;.) To &quot;Preserve the Title&quot; of such a section when you modify the Document means that it remains a section &quot;Entitled XYZ&quot; according to this definition. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Document may include Warranty Disclaimers next to the notice which states that this License applies to the Document. These Warranty Disclaimers are considered to be included by reference in this License, but only as regards disclaiming warranties: any other implication that these Warranty Disclaimers may have is void and has no effect on the meaning of this License. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">2. VERBATIM COPYING </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You may copy and distribute the Document in any medium, either commercially or noncommercially, provided that this License, the copyright notices, and the license notice saying this License applies to the Document are reproduced in all copies, and that you add no other conditions whatsoever to those of this License. You may not use technical measures to obstruct or control the reading or further copying of the copies you make or distribute. However, you may accept compensation in exchange for copies. If you distribute a large enough number of copies you must also follow the conditions in section 3.  You may also lend copies, under the same conditions stated above, and </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">you may publicly display copies. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">3. COPYING IN QUANTITY </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If you publish printed copies (or copies in media that commonly have printed covers) of the Document, numbering more than 100, and the Document's license notice requires Cover Texts, you must enclose the copies in covers that carry, clearly and legibly, all these Cover Texts: FrontCover Texts on the front cover, and BackCover Texts on the back cover. Both covers must also clearly and legibly identify you as the publisher of these copies. The front cover must present the full title with all words of the title equally prominent and visible. You may add other material on the covers in addition. Copying with changes limited to the covers, as long as they preserve the title of the Document and satisfy these conditions, can be treated as verbatim copying in other respects. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If the required texts for either cover are too voluminous to fit legibly, you should put the first ones listed (as many as fit reasonably) on the actual cover, and continue the rest onto adjacent pages. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If you publish or distribute Opaque copies of the Document numbering more than 100, you must either include a machine readable Transparent copy along with each Opaque copy, or state in or with each Opaque copy a computernetwork location from which the general networkusing public has access to download using publicstandard network protocols a complete Transparent copy of the Document, free of added material. If you use the latter option, you must take reasonably prudent steps, when you begin distribution of Opaque copies in quantity, to ensure that this Transparent copy will remain thus accessible at the stated location until at least one year after the last time you distribute an Opaque copy (directly or through your agents or retailers) of that edition to the public. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">It is requested, but not required, that you contact the authors of the Document well before redistributing any large number of copies, to give them a chance to provide you with an updated version of the Document. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">4. MODIFICATIONS </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You may copy and distribute a Modified Version of the Document under the conditions of sections 2 and 3 above, provided that you release the Modified Version under precisely this License, with the Modified Version filling the role of the Document, thus licensing distribution and modification of the Modified Version to whoever possesses a copy </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">of it. In addition, you must do these things in the Modified Version: </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">A. Use in the Title Page (and on the covers, if any) a title distinct from that of the Document, and from those of previous versions (which should, if there were any, be listed in the History section of the Document). You may use the same title as a previous version if the original publisher of that version gives permission. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">B. List on the Title Page, as authors, one or more persons or entities responsible for authorship of the modifications in the Modified Version, together with at least five of the principal authors of the Document (all of its principal authors, if it has fewer than five), unless they release you from this requirement. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">C. State on the Title page the name of the publisher of the </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Modified Version, as the publisher. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">D. Preserve all the copyright notices of the Document. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">E. Add an appropriate copyright notice for your modifications adjacent to the other copyright notices. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">F. Include, immediately after the copyright notices, a license notice giving the public permission to use the Modified Version under the terms of this License, in the form shown in the Addendum below. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">G. Preserve in that license notice the full lists of Invariant Sections and required Cover Texts given in the Document's license notice. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">H. Include an unaltered copy of this License. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">I. Preserve the section Entitled &quot;History&quot;, Preserve its Title, and add to it an item stating at least the title, year, new authors, and publisher of the Modified Version as given on the Title Page. If there is no section Entitled &quot;History&quot; in the Document, create one stating the title, year, authors, and publisher of the Document as given on its Title Page, then add an item describing the Modified Version as stated in the previous sentence. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">J. Preserve the network location, if any, given in the Document for public access to a Transparent copy of the Document, and likewise the network locations given in the Document for previous versions it was based on. These may be placed in the &quot;History&quot; section. You may omit a network location for a work that was published at least four years before the Document itself, or if the original publisher of the version it refers to gives permission. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">K. For any section Entitled &quot;Acknowledgements&quot; or &quot;Dedications&quot;, Preserve the Title of the section, and preserve in the section all the substance and tone of each of the contributor acknowledgements and/or dedications given therein. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">L. Preserve all the Invariant Sections of the Document, unaltered in their text and in their titles. Section numbers or the equivalent are not considered part of the section titles. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">M. Delete any section Entitled &quot;Endorsements&quot;. Such a section may not be included in the Modified Version. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">N. Do not retitle an existing section to be Entitled &quot;Endorsements&quot; or to conflict in title with any Invariant Section. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">O. Preserve any Warranty Disclaimers. If the Modified Version includes new frontmatter sections or appendices that qualify as Secondary Sections and contain no material copied from the Document, you may at your option designate some or all of these sections as invariant. To do this, add their titles to the list of Invariant Sections in the Modified Version's license notice. These titles must be distinct from any other section titles. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You may add a section Entitled &quot;Endorsements&quot;, provided it contains nothing but endorsements of your Modified Version by various partiesfor example, statements of peer review or that the text has been approved by an organization as the authoritative definition of a standard. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You may add a passage of up to five words as a FrontCover Text, and a passage of up to 25 words as a BackCover Text, to the end of the list of Cover Texts in the Modified Version. Only one passage of FrontCover Text and one of BackCover Text may be added by (or through arrangements made by) any one entity. If the Document already includes a cover text for the same cover, previously added by you or by arrangement made by the same entity you are acting on behalf of, you may not add another; but you may replace the old one, on explicit permission from the previous publisher that added the old one. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The author(s) and publisher(s) of the Document do not by this License give permission to use their names for publicity for or to assert or imply endorsement of any Modified Version. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">5. COMBINING DOCUMENTS </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You may combine the Document with other documents released under this License, under the terms defined in section 4 above for modified versions, provided that you include in the combination all of the Invariant Sections of all of the original documents, unmodified, and list them all as Invariant Sections of your combined work in its license notice, and that you preserve all their Warranty Disclaimers. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The combined work need only contain one copy of this License, and multiple identical Invariant Sections may be replaced with a single copy. If there are multiple Invariant Sections with the same name but different contents, make the title of each such section unique by adding at the end of it, in parentheses, the name of the original author or publisher of that section if known, or else a unique number. Make the same adjustment to the section titles in the list of Invariant Sections in the license notice of the combined work. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">In the combination, you must combine any sections Entitled &quot;History&quot; in the various original documents, forming one section Entitled &quot;History&quot;; likewise combine any sections Entitled &quot;Acknowledgements&quot;, and any sections Entitled &quot;Dedications&quot;. You must delete all sections Entitled &quot;Endorsements&quot;. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">6. COLLECTIONS OF DOCUMENTS </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You may make a collection consisting of the Document and other documents released under this License, and replace the individual copies of this License in the various documents with a single copy that is included in the collection, provided that you follow the rules of this License for verbatim copying of each of the documents in all other respects. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You may extract a single document from such a collection, and distribute it individually under this License, provided you insert a copy of this License into the extracted document, and follow this License in all other respects regarding verbatim copying of that document. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">7. AGGREGATION WITH INDEPENDENT WORKS </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">A compilation of the Document or its derivatives with other separate and independent documents or works, in or on a volume of a storage or distribution medium, is called an &quot;aggregate&quot; if the copyright resulting from the compilation is not used to limit the legal rights of the compilation's users beyond what the individual works permit. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">When the Document is included in an aggregate, this License does not apply to the other works in the aggregate which are not themselves derivative works of the Document. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If the Cover Text requirement of section 3 is applicable to these copies of the Document, then if the Document is less than one half of the entire aggregate, the Document's Cover Texts may be placed on covers that bracket the Document within the aggregate, or the electronic equivalent of covers if the Document is in electronic form. Otherwise they must appear on printed covers that bracket the whole aggregate. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">8. TRANSLATION </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Translation is considered a kind of modification, so you may distribute translations of the Document under the terms of section 4. Replacing Invariant Sections with translations requires special permission from their copyright holders, but you may include translations of some or all Invariant Sections in addition to the original versions of these Invariant Sections. You may include a translation of this License, and all the license notices in the Document, and any Warranty Disclaimers, provided that you also include the original English version of this License and the original versions of those notices and disclaimers. In case of a disagreement between the translation and the original version of this License or a notice or disclaimer, the original version will prevail. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If a section in the Document is Entitled &quot;Acknowledgements&quot;, &quot;Dedications&quot;, or &quot;History&quot;, the requirement (section 4) to Preserve its Title (section 1) will typically require changing the actual title. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">9. TERMINATION </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">You may not copy, modify, sublicense, or distribute the Document except as expressly provided for under this License. Any other attempt to copy, modify, sublicense or distribute the Document is void, and will automatically terminate your rights under this License. However, parties who have received copies, or rights, from you under this License will not have their licenses terminated so long as such parties remain in full compliance. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">10. FUTURE REVISIONS OF THIS LICENSE </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">The Free Software Foundation may publish new, revised versions of the GNU Free Documentation License from time to time. Such new versions will be similar in spirit to the present version, but may differ in detail to address new problems or concerns. See http://www.gnu.org/copyleft/. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Each version of the License is given a distinguishing version number. If the Document specifies that a particular numbered version of this License &quot;or any later version&quot; applies to it, you have the option of following the terms and conditions either of that specified version or of any later version that has been published (not as a draft) by the Free Software Foundation. If the Document does not specify a version number of this License, you may choose any version ever published (not as a draft) by the Free Software Foundation. </font></font>

<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">ADDENDUM: How to use this License for your documents </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">To use this License in a document you have written, include a copy of the License in the document and put the following copyright and license notices just after the title page:</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Copyright (c) YEAR YOUR NAME. </font></font>
<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">Permission is granted to copy, distribute and/or modify this document under the terms of the GNU Free Documentation License, Version 1.2 or any later version published by the Free Software Foundation; with no Invariant Sections, no FrontCover Texts, and no BackCover Texts. A copy of the license is included in the section entitled &quot;GNU Free Documentation License&quot;. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If you have Invariant Sections, FrontCover Texts and BackCover Texts, replace the &quot;with...Texts.&quot; line with this:</font></font>


 <font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">with the Invariant Sections being LIST THEIR TITLES, with the FrontCover Texts being LIST, and with the BackCover Texts being LIST. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If you have Invariant Sections without Cover Texts, or some other combination of the three, merge those two alternatives to suit the situation. </font></font>


<font face="DejaVu Sans, sans-serif"><font size="2" style="font-size: 11pt">If your document contains nontrivial examples of program code, we recommend releasing these examples in parallel under your choice of free software license, such as the GNU General Public License, to permit their use in free software. </font></font>


</pre>
</div>
<div id="sdfootnote1">
	<pre class="western"><font face="DejaVu Sans, sans-serif"><font size="1"><a class="sdfootnotesym" name="sdfootnote1sym" href="#sdfootnote1anc">1</a>See WhatIs.com Definitions: http://whatis.techtarget.com/sDefinition/0,290660,sid9_gci211714,00.html </font></font></pre>
</div>
<div title="footer">
	<p class="list-western" style="margin-top: 0.2in"><sdfield type=PAGE subtype=RANDOM format=PAGE>275</sdfield></p>
</div>
</body>
</html>